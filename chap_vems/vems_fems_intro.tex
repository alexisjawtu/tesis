\begin{chapter}[Virtual Elements]{Virtual Elements}

The vems are customarly defined in terms of a given problem.

It is our intention to propose a Virtual Elements Method (VEM) scheme
as a generalization of $H(\text{div})$--conforming Finite Elements
in meshes consisting of polyhedra of arbitrary kind.
We deal with tetrahedra, triangular prisms and pyramids and, in the presence of
the latter, our VEM scheme is put in the framework of non-polynomial Finite Elements.\\[5pt]
\section{primera}
Let be given an open \emph{non--convex} domain $\Omega\subseteq\mathbb{R}^3$ with
Lipschitz--continuous boundary
consisting of planar faces and define $V:=H(\mbox{div},\Omega)$ and $Q:=L^2(\Omega)$.
Let us consider the following continuous problem.\\[5pt]
With 
\begin{IEEEeqnarray*}{rClCrCl}
	a(\bv,\bw) & = & \forma{v}{w} &\quad\mbox{and}\quad& b(\bv,q) & = & \formb{v}{q}
\end{IEEEeqnarray*}
find $\bu\in V$ and $p\in Q$ such that for every $\bv\in V$ and every $q\in Q$
\begin{equation}\label{mixedContinuous}
  \makebox[0pt]{
    \begin{minipage}{\linewidth}
  	  \begin{IEEEeqnarray*}{rCCCl}
  		a(\bu,\bv) &+ &b(\bv,p) & = & 0\\[5pt]
  				   &- &b(\bu,q) & = & (f,q).
  	  \end{IEEEeqnarray*}
    \end{minipage}}
  \tag{MC}
\end{equation}
We start with a polihedral triangulation $\Th$ of $\Omega$ to define the 
virtual spaces $V_h$ and $Q_h$ as discretizations of $V$ and $Q$ respectively.\\[5pt]
For $E\in\Th$ the local space of vector fields will be
\begin{IEEEeqnarray*}{rCl}
  V_h(E)&=&\Big\{\bv\in H(\mbox{div},E)\cap H(\textbf{curl},E)\,:\,\\
  \yesnumber\label{vhE}
  &&\qquad \bv\cdot\bn|_f\in \mathcal P_0(f) \,\,\mbox{for all face $f$ of }E, \\
  && \qquad\dv\bv\in \mathcal P_0(E) \mbox{ and } \curl\bv = 0 \Big\}
\end{IEEEeqnarray*}
and the  global space $V_h$ will consist of functions defined piecewise with the former
local spaces:
\begin{IEEEeqnarray*}{ccrCl}
V_h&=&V_h(\Th)&:=&\Big\{\bv\in H(\dv,\Omega): \bv|_E\in V_h(E), \mbox{for all element }
E\in\Th\Big\}.
\end{IEEEeqnarray*}
\noindent{\color{blue}\#\#\#\#\#\#\# poner algo de por qu'e se pone
la condicion del curl: para que sea el gradiente de alguien (Nicaise)}. 
The scalar discrete space we will consider is
\begin{IEEEeqnarray}{rCl}
  Q_h & = & \mathcal{P}_0(\Th)
\end{IEEEeqnarray}
meaning the functions that are constant on each element of $\Th$. As expected,
with $V_h$ we consider the $H(\dv,\Omega)$ norm, 
$\|\bv\|^2_{V_h} = \|\bv\|^2_{L^2(\Omega)} + \|\dv\bv\|^2_{L^2(\Omega)}$,
and with $Q_h$ we consider the $L^2(\Omega)$ norm.

The condition in the definitions of these spaces suffice to construct an interpolation
operator, which is a key object both in Finite Elements as in Virtual Elements.
Let us take the degrees of freedom
\begin{IEEEeqnarray}{rCl}\label{dofs}
  \iint_f \bv\cdot\bn\,dS & \qquad\mbox{ for all face $f$ of } & \Th.
\end{IEEEeqnarray}
With \emph{faces of $\Th$} we mean the family of all faces forming the boundary
of the elements, with the unit normals consistently taken in the case of
neighbour elements.
\begin{lemma}\label{unisolvence} Given a polyhedron $E\in\Th$, the degrees
  of freedom~(\ref{dofs}) corresponding to the faces of $E$ are unisolvent
  in $V_h(E)$.
\end{lemma}
\begin{proof} \emph{Existence.} Let $n_{f,E}$ be the number of faces of $E$ and
take real numbers $\{\alpha_i\}_{i=1}^{n_{f,E}}$. Let $g$ the  piecewise constant
function on $\partial E$ satisfying, for all $i$, %face $f$ of $E$
\[
  \int\limits_{f_i} g = \alpha_i
\]
and let $d$ be the constant function in $E$ such that
\[
 \int\limits_E d\,d\textbf{x} = \sum \alpha_i.
\]
Then we consider the auxiliary problem of seeking a solution of
\begin{IEEEeqnarray}{rClrCl}
  \label{aux_prob}
  \Delta \phi & = & d \quad \mbox{in $E$,} \qquad & 
  \frac{\partial \phi}{\partial \bn}& = &g \quad \mbox{on }\partial E.
\end{IEEEeqnarray}
By definition we obtain the compatibility condition
\begin{IEEEeqnarray*}{rCl}
  \int\limits_E d\,d\textbf{x}& = & \int\limits_{\partial E} g\,d\gamma    
\end{IEEEeqnarray*}
so the solution $\phi$ to the problem~(\ref{aux_prob}) exists. Now
we take $\bu:=\nabla \phi$ and  it holds immediately that $\dv\bu$ is constant in $E$,
$\bu\cdot\bn$ is constant on each face of $\partial E$ and $\curl\bu = 0$. So
$\bu$ lies in $V_h(E)$ and also for all $1\leqslant i\leqslant n_{f,E}$ $\int_{f_i} \bu\cdot\bn\,d\gamma = \alpha_i$.\\[4pt]
\emph{Uniqueness.} Suppose that $\bv\in V_h(E)$ has vanishing
degrees of freedom. Condition $\curl\bv=0$ implies
$\bv=\nabla\phi$ for certain $\phi$. Now, since $\dv\bv$ is constant on $E$, the
relation
\begin{IEEEeqnarray*}{rCl}
   0 & = & \int\limits_{\partial P}\bv\cdot\bn\,d\gamma 
\end{IEEEeqnarray*} %& = & \int\limits_P\dv\bv\,d\textbf{x}
imply $\dv\bv=0$ by Green Theorem. Then, the potential $\phi$ satisfies
\begin{IEEEeqnarray*}{rClrCl}
  \Delta \phi & = & 0 \quad \mbox{in $E$,} \qquad & 
  \frac{\partial \phi}{\partial \bn}& = &0 \quad \mbox{on }\partial E
\end{IEEEeqnarray*}
which means it is a constant, and it follows $\bv=0$.
\end{proof}
With this Lemma already {\color{red}demonstrated} we are able to consider
an $H(\text{div})$--like local interpolation operator well defined.
\begin{corollary} \label{interpolant}
  For every $\bv\in H^1(E)^3$ there exists a $V_h(E)$--interpolant $I(\bv)$
  defined as the unique element in $V_h(E)$ such that for every face $f$ of $E$
    \begin{IEEEeqnarray*}{rCl}
      \int\limits_f I(\bv)\cdot\bn\,d\gamma & = & \int\limits_f \bv\cdot\bn\,d\gamma.       
    \end{IEEEeqnarray*}
\end{corollary}
\begin{lemma} \label{p0_projection} Consider the projection $P_0$ onto the constants on $E$. It holds
\begin{IEEEeqnarray*}{rCl}
  \dv I(\bv) & = & P_0\,\dv\bv.
\end{IEEEeqnarray*}
\end{lemma}
\begin{proposition}\label{vem_equal_fem}
Recall the space $D_k$ introduced in~(\ref{dk}).\\
If $E$ is a right prism, then
\begin{IEEEeqnarray}{rCl}\label{d1p1}
  V_{\textit{h}}(E) & = & D_1(x,y)\otimes P_1(z)\mbox{,}
\end{IEEEeqnarray}
with $x,y,z$ being the variables in a cartesian system of coordinates in which
the $z$--axis is orthogonal to the planes containing the triangular faces of $E$.\\
If $E$ is a tetrahedron, then
\begin{IEEEeqnarray}{rCl}\label{p03}
  V_{\textit{h}}(E) & = & P_0^3(\bx) + P_0\bx\mbox{,}
\end{IEEEeqnarray}
with $\bx = (x,y,z)$ being the vector of variables in a cartesian system of coordinates.
\end{proposition}
\begin{proof}
  In the case of a prism $E$, the space $D_1(x,y)\otimes P_1(z)$ can be written as
  \[
    \{\bv \in P_1(E)\,:\, \bv=(a+\gamma x,b+\gamma y,c+d z),
        a,b,c,d,\gamma\in\mathbb{R})\}
  \]
  and then it is inmediately seen that it has the same dimension five
  as $V_{\textit{h}}(E)$. Finally, recalling that the $\dv$ and $\curl$ operators
  can be computed in the chosen local variables, given $\bv\in D_1(x,y)\otimes P_1(z)$
  we can compute $\bv|_{f}\cdot\bn_f$ on each face of $E$, $\dv\bv$ and $\curl\bv$
  to verify explicitly that the space on the right side of~(\ref{d1p1}) fulfills the 
  definition of $V_h(E)$ given in~(\ref{vhE}).
  Exactlty the same argument works for the case of a tetrahedron $E$, in which we
  deal with two vectorial spaces of dimension four that are such that 
  every element in
  \[
    P_0^3(\bx) + P_0\bx=\{\bv \in P_1(E)\,:\,
    \bv=(a+\gamma x,b+\gamma y,c+\gamma z,
    a,b,c,\gamma\in\mathbb{R})\}
  \]
  fulfills the conditions defining $V_{\textit{h}}(E)$.
\end{proof}
\begin{remark}
  By Proposition~\ref{vem_equal_fem} the spaces $V_h(E)$ conicide with the
  lowest order $H(\dv)$--conforming local Finite Element spaces
  introduced in~(\ref{prismaticSpace})
  for the prismatic case and in~(\ref{tetrahedralSpace}) for the tetrahedral case.
\end{remark}
\begin{lemma}
  The definition of the lowest order $H(\dv)$ Finite Elements on
  right prisms or tetrahedra is independent of
the choice of the cartesian axes (as long as the $z$-axis is
perpendicular to the trianguar faces in case of prisms).
\end{lemma}
\begin{proof}
  This can be prooved by hand. Let us proove the case of a Prism $E$. Let $(x,y,z)$ and $(x',y',z')$ be two cartesian coordinate systems satisfying the required properties. Then we can write
  \begin{IEEEeqnarray*}{rCl}
    x & = & p+\alpha x'-\beta  y' \\
    y & = & q+\beta x' -\alpha y' \\
    z & = & r+z'
  \end{IEEEeqnarray*}
for $\alpha$ and $\beta$ satisfying $\alpha^2+\beta^2 = 1$.
Let 
$\bv$ be an element in $V_{\textit{h}}(E)$. So
\begin{IEEEeqnarray*}{rCl}
\bv(x,y,z) & = & (a+\gamma x,b+\gamma y,c+d z)^{\scriptstyle t}\\
&=&\left((a+\gamma p) + \gamma(\alpha x' - \beta y'),
         (b+\gamma q) + \gamma(\beta x'+\alpha y'),
         (c+dr)+dz'\right)^{\scriptstyle t}.
\end{IEEEeqnarray*}
Then, the components of $\bv$ in the new coordinate versors are
\begin{IEEEeqnarray*}{rCcCl}
  \bv\cdot(\alpha,\beta,0)^{\scriptstyle t} & = &
   (\alpha a + \beta b + \gamma(\alpha p + \beta q )) +\gamma x' & =: & a' + \gamma x' \\
  \bv\cdot(-\beta,\alpha,0)^{\scriptstyle t} & = &
   (-\beta a + \alpha b + \gamma(-\beta p + \alpha q )) +\gamma y' & =: & b' + \gamma y' \\
  \bv\cdot(0,0,1)^{\scriptstyle t} & = &
   (c+dr)+d z' & =: & c' + dz'.
\end{IEEEeqnarray*}
Is follows that, in the $x'y'z'$ system,
\[
  \bv(x',y',z') = (a' + \gamma x', b' + \gamma y', c' + dz')^{\scriptstyle t}
  \in D_1(x',y')\otimes P_1(z').
\]
\end{proof}
%\paragraph{discretized forms} % (fold)
%\label{par:discretized_forms}
%\[
%\noindent{\color{blue}\#\#\#\#\#\#\# \mbox{Â¿hace falta?}} 
%  a(\bv,\bw)=\sum_{E\in\mathcal T_h}a^E(\bv,\bw), \qquad
%  b(\bv,q)=\sum_{E\in\mathcal T_h}b^E(\bv,q).
%\]
Next, together with the finite dimensional spaces already defined,
discretized version of the bilinear forms.\\
The evaluation of the form $b(\cdot,\cdot)$ in $(\bv,q)\in V_h\times Q_h$ can
be computed using the degrees of freedom~(\ref{dofs}) applied to $\bv$. For if $q\in Q_h$, then
\[
  b(\bv,q)=\int_\Omega q\,\dv\bv = \sum_{E\in\mathcal T_h}
  \int_Eq\,\dv\bv = \sum_{E\in\mathcal T_h}\int_{\partial E}q \bv\cdot\bn.
\]
so in the case of the form $b_h(\bv,q)$ we put simply
\[
  b_h(\bv,q) = b(\bv,q) =
  \sum_{E\in\mathcal T_h}b^E(\bv,q)\mbox{,}
\]
where $b^E(\bv,q) = \int_Eq\,\dv\bv\,d\textbf{x}$.
For the bilinear form $a(,)$, we can decompose it as
\[
  a(\bv,\bw)=\sum_{E\in\mathcal T_h}\int_E\bv\cdot\bw\,d\bx
\]
but this is not computable from the 
degres of freedom. The following construction
is done in order to get a calculable discrete form and
also we will introduce a term for the
stability.\\[4pt]
For each element $E\in\mathcal{T}_{\textit{h}}$, let the space $W(E)$
be defined by
\begin{IEEEeqnarray*}{rCl}
  W(E) & = & \left\{ \bw\in V_h(E):  \bw = \nabla  q_2,
\mbox{ for some }  q_2\in P_2(E)\right\}\\[5pt]
       & = & V_h(E)\cap\nabla {P}_2(E)\mbox{,}
\end{IEEEeqnarray*}
and with these we consider $W(\mathcal{T}_{\textit{h}}) = \{{\bw} : {\bw}|_{E} \in W(E)
\mbox{ for each }E\in\mathcal{\textit{h}}\}$. Integrating arbitrary elements
in~(\ref{d1p1}) and~(\ref{p03}) yields the following result.
\begin{lemma} When $E\in\mathcal{T}_{\textit{h}}$ is a tetrahedron or 
a prism, then $W(E) = V_{\textit{h}}(E)$.  
\end{lemma}
Again, observe that if $\bv\in V_h(E)$ and $\hat\bu\in\hat V(E)$, $a^E(\hat\bu,\bv)$ can be 
computed using the degrees of freedom of $\bv$, because it holds
\begin{IEEEeqnarray*}{rCCCl}
a^E(\hat\bu,\bv) &:=& \int_E\hat\bu\cdot\bv &=& \int_E\nabla \hat q_2\cdot\bv\\
                 &=&-\int_E\hat q_2 \dv\bv &+& \int_{\partial E}\hat q_2\bv\cdot\bn.
\end{IEEEeqnarray*}
This means we can consider an auxiliary projection  operator $\pi^E$
from $H(\dv,E)$ onto $W(E)$ defined by
\begin{IEEEeqnarray}{rCl}\label{projection}
  a^E(\bv-\pi^E\bv,\bw) = 0 &\qquad& \mbox{for all }\bw\in W(E)
\end{IEEEeqnarray}
fully computable in terms of the degrees of freedom of $\bv$.

We need the following last object to complete the discretization of $a(\cdot,\cdot)$.
Thanks to Lemma~\ref{unisolvence} we can consider a basis $B=\{\bv_{i,E}\}$
of $V_h(E)$ dual to the functionals~(\ref{dofs}), that is, for every
$1\leqslant i,j\leqslant n_{f,E}$
\begin{IEEEeqnarray}{rCl}
  \iint_{f_j} \bv_{i,E}\cdot\bn_j\,dS & = & \delta_{i,j}.
\end{IEEEeqnarray}
What we are considering is the inner product
$\mathcal \langle(\bv)_B,(\bw)_B\rangle$ of the coordinates
of the fields $\bv,\bw\in V_h(E)$ with respect 
to this local dual basis $B$.

Finally, the local discrete form $a_h^E$ is stated in the following definition.
\begin{defi} Given an element $E\in\Th$, for $\bv$ and $\bw$ in $V_{\textit{h}}(E)$
\begin{IEEEeqnarray}{rCl}\label{discreteLocal_a}
  a^E_{\textit{h}}(\bv,\bw) &:=& a^E(\pi^E\bv,\pi^E\bw) + 
  h_E^{-1}\langle(\bv-\pi^E\bv)_B,(\bw-\pi^E\bw)_B\rangle
\end{IEEEeqnarray}  
where $h_E$ is the diameter of $E$.
\end{defi}
The discrete global form $a_h$ is defined by the following equation.
\[
  a_h(\bv,\bw) = \sum_{E\in \mathcal T_h} a_h^E(\bv|_E,\bw|_E),
    \quad\mbox{ for } \bv \mbox{ and } \bw \in V_h.
\]

One fact to note
about the projection $\pi^E$ in~(\ref{projection}) is that, by
Remark~\ref{vem_equal_fem},
it coincides with the identity $I:W(E)\to W(E)$ whenever the element $E\in\Th$
is a Prism or a Tetrahedron so that, immediately, we have the following
property.
\begin{remark}\label{ah_equal_a} If $E$ is a tetrahedron or a prism, then
  $a_h^E(\bv,\bw)=a^E(\bv,\bw)$ for all $\bv,\bw \in V_h(E)$.
\end{remark}
Now we state a key result concerning the stability of the
discrete form $a^E_{\textit{h}}$ and which explains the form of the
term $h_E^{-1}\langle\,\cdot\,,\cdot\,\rangle$ in~(\ref{discreteLocal_a}).
\\{\color{blue}\#\#\#\#\#\#\#\# prop 3.2...}
Proposition 3.2 (OJO; PONER ref) yields the next corollary.
\begin{corollary}\label{equivalence} For all $\bv\in V_h(E)$ and all pyramidal
$E\in\mathcal T_h$ it holds
\begin{IEEEeqnarray*}{rCcCl}
  c_E\,a^E(\bv,\bv) & \leqslant & h_E^{-1}\langle(\bv)_B,(\bv)_B\rangle & \leqslant
  & C_E\,a^E(\bv,\bv)
\end{IEEEeqnarray*}
where $c_E$ and $C_E$ depend only on the shape regularity of $E$.
\end{corollary}

\section{discrete problem. well posedness. local estimates?}
The discrete problem in the Finite--Virtual Element scheme is stated as follows.
\begin{problem}
To find $\bu_h\in V_h$ and $p_h\in Q_h$ such that
$\forall \bv\in V_h \qquad \forall q\in Q_h $
\begin{equation}\label{mixedDiscrete}
  \makebox[0pt]{
    \begin{minipage}{\linewidth}
      \begin{IEEEeqnarray*}{rCCCl}
        a_h(\bu_h,\bv) & + & b(\bv,p_h) & = & 0 \\[5pt]
                       & - & b(\bu_h,q) & = & (f,q)
      \end{IEEEeqnarray*}
    \end{minipage}}
  \tag{MD}
\end{equation}
\end{problem}
In what follows we will be concerned in proving existence
and uniqueness for Problem~(\ref{mixedDiscrete}). It will be done
showing coercivity for one of the bilinear forms and a
discrete version of the $\inf$--$\sup$ condition for the other.
\begin{lemma} For all $E\in\Th$, all $\bu\in W(E)$ and all $\bv\in V_h(E)$
\begin{IEEEeqnarray}{rCcCl} 
a_h^E(\bu,\bv) & = & a^E(\bu,\bv)       & &\label{L1}\\
c_E\,a^E(\bv,\bv)      & \leqslant & a_h^E(\bv,\bv) & \leqslant & C_E\,a^E(\bv,\bv)\label{L2}
\end{IEEEeqnarray}
with $c_E = C_E = 1$ when $E$ is tetrahedral or prismatic and $c_E,C_E$ depending
only on the shape regularity of $E$ when $E$ is pyramidal.
\end{lemma}
\begin{proof} The relation $\hat\bu=\hat\pi^E\bu$, condition~(\ref{projection})
and the symmetry of $a^E$ imply
\[
  a_h^E(\hat\bu,\bv)=a^E(\hat\pi^E\hat\bu,\hat\pi^E\bv)=a^E(\hat\pi^E\hat\bu,\bv)=a^E(\hat\bu,\bv)
\]
which proves~(\ref{L1}).
To prove~(\ref{L2}), if $E$ is not a Pyramid this property is already a consequence
of~(\ref{ah_equal_a}). In the case of a Pyramid, firstly a simple computation yields
\begin{IEEEeqnarray}{rCcCl}
  \label{comput}
  a^E(\bv,\bv)&=&a^E(\bv-\hat\pi^E\bv,\bv-\hat\pi^E\bv)&+&a^E(\hat\pi^E\bv,\hat\pi^E\bv).
\end{IEEEeqnarray}
Corollary~\ref{equivalence} and~(\ref{comput}) give
\begin{IEEEeqnarray*}{rCl}
a_h^E(\bv,\bv) &\leqslant& a^E(\hat\pi\bv,\hat\pi\bv) + C_E\,a^E(\bv-\hat\pi\bv,\bv-\hat\pi\bv) \\[5pt]
               &\leqslant& \max\{1,C_E\}\,a^E(\bv,\bv).
\end{IEEEeqnarray*}
In a similar manner, it holds
\[
  a_h^E(\bv,\bv)\geqslant \min{1,c_E}\,a^E(\bv,\bv).
\]
\end{proof}
If we consider the following kernel
\begin{IEEEeqnarray*}{rCl}
  \mathcal K_h & = & \{\bv_h\in V_h: b(\bv_h,q)=0\,\,
                        \mbox{for all } q\in Q_h\} \\[4pt]
               & = & V_{\textit{h}}\cap\ker\dv
\end{IEEEeqnarray*}
then the previuos Lemma implies the following Proposition.
\begin{proposition}
  $a_h$ is coercive over $\mathcal K_h$ and the coercivity constant
  depends only on the shape regularity of the pyramids of the mesh.
\end{proposition}
\begin{proposition} \label{cont} The local discrete bilinear form $a_h^E$ is continuous en $L^2(E)$, that is,
\[
a_h^E(\bu,\bv)\le C \|\bu\|_{L^2(E)}\|\bv\|_{L^2(E)}, \qquad \forall \bu,\bv\in V_h(E),
\]
where $C$ equals $1$ when $E$ is a right prism or tetrahedron, and depends only on the aspect ratio of $E$ in the case of pyramids.
\end{proposition}
\begin{proof}
When $E$ is a prism or tetrahedron, $a_h^E(\bu,\bv)=a^E(\bu,\bv)$ for $\bu$ and $\bv$ in $V_h(E)$, and the result is clear from the definition of $a^E$. When $E$ is a pyramid, we observe that $a_h^E$ is symmetric and coercive in $L^2(E)$ because of \eqref{L2}, and then it defines an inner product. Hence, from Cauchy-Schwarz inequality and again \eqref{L2} we have
\begin{multline*}
\left|a_h^E(\bu,\bv)\right|\le a_h^E(\bu,\bu)^\frac12 a_h^E(\bv,\bv)^\frac12 \le\\ C_E a^E(\bu,\bu)^\frac12 a^E(\bv,\bv)^\frac12 \le C_E\|\bu\|_{L^2(E)}\|\bv\|_{L^2(E)}.
\end{multline*}
The constant $C_E$ depends on the aspect ratio of $E$. This concludes the proof.
\end{proof}
{\color{blue}\#\#\#\#\#\#\#\# continue here, ver mi cuaderno amarillo.}
\begin{lemma} \label{lemma_inf_sup_bh} There exists a constant
$\beta^*>0$ depending only on $\Omega$
such that for all $q^*\in Q_h$ there exists $\bw_h^*\in V_h$ such
that
\[
\dv\bw_h^*=q^*, \qquad \beta^*\|\bw_h^*\|_{Q}\leqslant\|q^*\|_{Q}
\]
\end{lemma}
\begin{proof} Start considering the infinite dimensional version
of the statement. There is, in fact, a constant $\beta^*$ depending only on
$\Omega$ such that
for every $q^*\in Q_h \subseteq Q$ there exists 
$\bw^*\in H^1_0(\Omega)^3$ with $\dv\bw^*=q*$ such that
\begin{IEEEeqnarray}{rCl} \label{bound_w}
  \beta^*\|\bw^*\|_{H^1(\Omega)} & \leqslant &
  \|q^*\|_{Q}.
\end{IEEEeqnarray}
Now, for each $q^*\in Q_h$ take $\bw_h^*:=I\bw^*$, the $V_h$-interpolant of $\bw^*$, as was
already defined in Corollary~\ref{interpolant}. As a consequence of~(\ref{vem_equal_fem})
and because we are considering the exact same degrees of freedom, this
interpolation operator coincides, in the lowest order case, with the
$H(\dv)$--conforming operators~(\ref{sub:definition_of_the_h_div_element_on_prisms})
on prisms and~(\ref{sub:definition_of_the_h_div_element_on_tetrahedra}) on tetrahedra,
respectively.
In {\color{blue}\#\#\#\#\#\#\#\# poner qu'e lugar es} we obtained
the stability estimates~({\color{blue}\#\#\#\#\#\#\#\# referencia estimate.})
and~({\color{blue}\#\#\#\#\#\#\#\# ref estimate.}) for the finite elements, which
we repeat here for clarity. If $E$ is a prism or a tetrahedron, then


{\color{blue}\#\#\#\#\#\#\#\# stability fems}



Using this and the estimate {\color{blue}\#\#\#\#\#\#\#\# (????)}
for virtual elements on pyramids and~(\ref{bound_w}) we get
\[
  \|\bw_I^*\|_{Q}\leqslant
  (1+C\textit{h})\|\bw^*\|_{H^1(\Omega)}
  \leqslant\frac{1+Ch}{\beta^*}\|q\|_{Q}.
\]
Besides, since $q\in Q_h$, by~(\ref{p0_projection}) we have
\[
  \dv\bw_I^*=P_0\,\dv\bw^*=P_0\,q^*=q^*.
\]
\end{proof}
Now, we can prove the discrete inf-sup condition. 
\begin{theorem}[Discrete $\inf-\sup$ condition for $b_h$] \label{inf_sup_b_h}
There exists $\beta > 0$ such that for all $q^*\in Q_h$ 
\begin{IEEEeqnarray*}{rCl}
  \sup_{0\ne\bv\in V_h} \frac{b_h(\bv,q^*)}{\|\bv\|_{V_h}} &\geqslant& \beta\|q^*\|_{Q_h}.
\end{IEEEeqnarray*}
\end{theorem}
\begin{proof} By Lemma~\ref{lemma_inf_sup_bh} for $q^*\in Q_h$
there exists $\bw_h^*\in V_h$ such that $\dv\bw_h^*=q^*$ and
$\beta^*\|\bw_h^*\|_{L^2(\Omega)}\leqslant\|q^*\|_{Q_h}$ (the constant $\beta^*$
is independent of $q^*$). Then
\begin{IEEEeqnarray*}{rcCcl}
  \|\bw_h^*\|_{V_h}^2 \, & \, = \, & \, \|\bw_h^*\|_{L^2(\Omega)}^2 + \|q^*\|_{Q_h}^2 
    \, & \,\leqslant\, & \, \left(\frac1{(\beta^*)^2}+1\right) \|q^*\|_{Q_h}^2
\end{IEEEeqnarray*}
and
\begin{IEEEeqnarray*}{rcCcl}
\sup_{0\ne\bv\in V_h} \frac{b_h(\bv,q^*)}{\|\bv\|_{V_h}}
      \,&\,\geqslant\,&\,
\frac{b_h(\bw_h^*,q^*)}{\|\bw_h^*\|_{V_h}}
      \,&\,\geqslant\,&\,
\frac1{\sqrt{\dfrac1{(\beta^*)^2}+1}}\,\|q^*\|_{Q_h}.
\end{IEEEeqnarray*}
\end{proof}

\input{./chap_vems/approximationEstimateVems}

\input{./chap_vems/spaceWE}
\end{chapter}
