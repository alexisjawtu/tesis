\begin{chapter}[vems--fems]{vems--fems}
It is our intention to propose a Virtual Elements Method (VEM) scheme
as a generalization of $H(\text{div})$--conforming Finite Elements
in meshes consisting of polyhedra of arbitrary kind.
We deal with tetrahedra, triangular prisms and pyramids and, in the presence of
the latter, our VEM scheme is put in the framework of non-polynomial Finite Elements.\\[5pt]
Let be given an open \emph{non--convex} domain $\Omega\subseteq\mathbb{R}^3$ with
Lipschitz--continuous boundary
consisting of planar faces and define $V:=H(\mbox{div},\Omega)$ and $Q:=L^2(\Omega)$.
Let us consider the following continuous problem.\\[5pt]
With 
\begin{IEEEeqnarray*}{rClCrCl}
	a(\bv,\bw) & = & \forma{v}{w} &\quad\mbox{and}\quad& b(\bv,q) & = & \formb{v}{q}
\end{IEEEeqnarray*}
find $\bu\in V$ and $p\in Q$ such that for every $\bv\in V$ and every $q\in Q$
\begin{equation}\label{mixedContinuous}
  \makebox[0pt]{
    \begin{minipage}{\linewidth}
  	  \begin{IEEEeqnarray*}{rCl}
  		a(\bu,\bv) + b(\bv,p) & = & 0\\[5pt]
  				   - b(\bu,q) & = & (f,q).
  	  \end{IEEEeqnarray*}
    \end{minipage}}
  \tag{MC}
\end{equation}
We start with a polihedral triangulation $\Th$ of $\Omega$ to define the 
virtual spaces $V_h$ and $Q_h$ as discretizations of $V$ and $Q$ respectively.\\[5pt]
For $E\in\Th$ the local space of vector fields will be
\begin{eqnarray*}
  V_h(E)&=&\Big\{\bv\in H(\mbox{div},E)\cap H(\textbf{curl},E)\,:\,\\
  &&\qquad \bv\cdot\bn|_f\in \mathcal P_0(f) \,\,\mbox{for all face $f$ of }E, \\
  && \qquad\dv\bv\in \mathcal P_0(E) \mbox{ and } \curl\bv = 0 \Big\}
\end{eqnarray*}
and the  global space $V_h$ will consist of functions defined piecewise with the former
local spaces:
\begin{IEEEeqnarray*}{ccrCl}
V_h&=&V_h(\Th)&:=&\Big\{\bv\in H(\dv,\Omega): \bv|_E\in V_h(E), \mbox{for all element }
E\in\Th\Big\}
\end{IEEEeqnarray*}
The scalar discrete space we will consider is
\begin{IEEEeqnarray}{rCl}
  Q_h & = & \mathcal{P}_0(\Th)
\end{IEEEeqnarray}
meaning the functions that constant on each element of $\Th$.

The condition in the definitions of these spaces suffice to construct an interpolation
operator, which is a key object both in Finite Elements as in Virtual Elements.
Let us take the degrees of freedom
\begin{IEEEeqnarray}{rCl}\label{dofs}
  \int\limits_f \bv\cdot\bn\,d\gamma & \qquad\mbox{ for all face $f$ of } & \Th.
\end{IEEEeqnarray}
With \emph{faces of $\Th$} we mean the family of all faces forming the boundary
consistently in the case of neighbour elements.
\begin{lemma} Given a polyhedron $E\in\Th$, the degrees of freedom~(\ref{dofs}) corresponding to the faces of $E$ are unisolvent in $V_h(E)$.
\end{lemma}
\begin{proof} \emph{Existence.} Let $n_{f,E}$ the number of faces of $E$ and
take real numbers $\{\alpha_i\}_{i=1}^{n_{f,E}}$. Let $g$ the  piecewise constant
function on $\partial E$ satisfying, for all $i$, %face $f$ of $E$
\[
  \int\limits_{f_i} g = \alpha_i
\]
and let $d$ be the constant function in $E$ such that
\[
 \int\limits_E d\,d\textbf{x} = \sum \alpha_i.
\]
Then we consider the auxiliary problem of seeking a solution of
\begin{IEEEeqnarray}{rClrCl}
  \label{aux_prob}
  \Delta \phi & = & d \quad \mbox{in $E$,} \qquad & 
  \frac{\partial \phi}{\partial \bn}& = &g \quad \mbox{on }\partial E.
\end{IEEEeqnarray}
{\color{red}By definition we obtain the compatibility condition}
\begin{IEEEeqnarray*}{rCl}
  \int\limits_E d\,d\textbf{x}& = & \int\limits_{\partial E} g\,d\gamma    
\end{IEEEeqnarray*}
so the solution $\phi$ to the problem~(\ref{aux_prob}) exists. Now
we take $\bu:=\nabla \phi$ and  it holds immediately $\dv\bu$ is constant in $E$,
$\bu\cdot\bn$ is constant on each face of $\partial E$ and $\curl\bu = 0$. So
$\bu$ lies in $V_h(E)$ and also for all $1\leqslant i\leqslant n_{f,E}$ $\int_{f_i} \bu\cdot\bn\,d\gamma = \alpha_i$.\\[4pt]
\emph{Uniqueness.} Suppose that $\bv\in V_h(E)$ has vanishing
degrees of freedom. Condition $\curl\bv=0$ implies
$\bv=\nabla\phi$ for certain $\phi$. Now, since $\dv\bv$ is constant on $E$, the
relations 
\begin{IEEEeqnarray*}{rCl}
   0 & = & \int\limits_{\partial P}\bv\cdot\bn\,d\gamma 
\end{IEEEeqnarray*} %& = & \int\limits_P\dv\bv\,d\textbf{x}
imply $\dv\bv=0$ by Green Theorem. Then, the potential $\phi$ satisfies
\begin{IEEEeqnarray*}{rClrCl}
  \Delta \phi & = & 0 \quad \mbox{in $E$,} \qquad & 
  \frac{\partial \phi}{\partial \bn}& = &0 \quad \mbox{on }\partial E
\end{IEEEeqnarray*}
{\color{red} which means it is a constant}, and it follows $\bv=0$.
\end{proof}
With this Lemma already {\color{red}proven} we are able to consider
an $H(\text{div})$--like local interpolation operator well defined.
\begin{corollary}
  For every $\bv\in H^1(E)^3$ there exists a $V_h(E)$--interpolant $\bv_I$
  defined as the unique element in $V_h(E)$ such that for every face $f$ of $E$
    \begin{IEEEeqnarray*}{rCl}
      \int\limits_f \bv_I\cdot\bn\,d\gamma & = & \int\limits_f \bv\cdot\bn\,d\gamma       
    \end{IEEEeqnarray*}
\end{corollary}
\begin{lemma} Consider the projection $P_0$ onto the constants on $E$. It holds
\begin{IEEEeqnarray*}{rCl}
  \dv\bv_I & = & P_0\,\dv\bv.
\end{IEEEeqnarray*}
\end{lemma}
By an inspection of the Finite Elements defined in Chapter~\ref{chap_prelim}
we obtain immediately the following
\begin{remark} If $E$ is a tetrahedron or a prism, then $V_h(E) = RT_0(E)$
(cfr.~(\ref{sub:definition_of_the_h_div_element_on_prisms})
and~(\ref{sub:definition_of_the_h_div_element_on_tetrahedra}) both
in the lower case).
\end{remark}
\noindent{\color{blue}\#\#\#\#\#\#\# desde ac\'a est\'a sin controlar} 
\begin{theorem}
The solutions $\bu$ and $p$ of problem ~(\ref{mixedContinuous}) satisfy
\[
p\in H^1(\Omega)
\] 
and for each $\ell$
\[
\bu=\bu_r + \bu_s
\]
with $\bu_r\in H^1(\Omega)$ and
\[
\bu_s\cdot \xi_i\in V^{1,2}_{\beta,\delta}(\Lambda_\ell), \quad i=1,2, \qquad \bu_s\cdot\xi_3\in V^{1,2}_{\beta,0}(\Lambda_\ell)
\]
where $\xi_i$, $i=1,2,3$, are the directions of three concurrent edges of $\Lambda_\ell$ with $\xi_3$ being the direction of the singular edge if it exists in $\Omega_\ell$, and $\beta,\delta\ge0$ satisfying $\beta>\frac12-\lambda_v^{(\ell)}$ and $\delta>1-\lambda_e^{(\ell)}$, $v$ and $e$ being the singular vertex and edge, respectively, {\color{red}mas lindo}if they exist.
\end{theorem} 
\paragraph{decomposition} % (fold)
\label{par:decomposition_}
\[
  a(\bv,\bw)=\sum_{E\in\mathcal T_h}a^E(\bv,\bw), \qquad
  b(\bv,q)=\sum_{E\in\mathcal T_h}b^E(\bv,q).
\]
% paragraph decomposition (end)
The evaluation of the form $b(\cdot,\cdot)$ in $(\bv,q)\in V_h\times Q_h$ can
be computed using the degrees of freedom~(\ref{dofs}) applied to $\bv$. For if $q\in Q_h$, then
\[
  b(\bv,q)=\int_\Omega q\,\dv\bv = \sum_{E\in\mathcal T_h}
  \int_Eq\,\dv\bv = \sum_{E\in\mathcal T_h}\int_{\partial E}q \bv\cdot\bn.
\]
The common bilinear form no sirve. In order to stabilize the oper. we add
a term "el pi en Rn con las coordenadas" 
\end{chapter}