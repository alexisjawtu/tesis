\chapter{Interpolation}
\begin{table}[h!]
\centering
\caption{Notation}
\label{edgeFacesNotationTable}
    \begin{IEEEeqnarraybox}
    [\IEEEeqnarraystrutmode
     \IEEEeqnarraystrutsizeadd{0pt}{0pt}]{v/c/v/c/v/c/v/c/v}
        \IEEEeqnarrayrulerow\\
        \IEEEeqnarrayseprow[3pt]\\
        &\hfill\raisebox{22pt}[0pt][0pt]{}\hfill
                            & & ***
                            & & ***
                            & & *** &\\
        \IEEEeqnarrayrulerow\\
        \IEEEeqnarrayseprow[3pt]\\
        &\hfill\raisebox{30pt}[0pt][0pt]{***}\hfill& &
            \begin{IEEEeqnarraybox}{c}
            ***\\***
            \end{IEEEeqnarraybox}
        &&&&
            \begin{IEEEeqnarraybox}{c}
                ***\\***
            \end{IEEEeqnarraybox}
        &\\
        \IEEEeqnarrayseprow[3pt]\\
        \IEEEeqnarrayrulerow
    \end{IEEEeqnarraybox}
\end{table}
\begin{IEEEeqnarray*}{rClCrClCrCl}
  \hat f_1 & \subseteq &  \{\hat x_1 = 0      \} & \qquad & \hat \be_1& = & \{(\hat x_1,0,0)^t\,:\,0\leqslant\hat x_1\leqslant 1\}  &\quad& \hat \be_6& = & \{(1,0,\hat x_3)^t\,:\,0\leqslant\hat x_3\leqslant 1\} \\[4pt]
  \hat f_2 & \subseteq &  \{\hat x_2 = 0      \} & \qquad & \hat \be_2& = & \{(0,\hat x_2,0)^t\,:\,0\leqslant\hat x_2\leqslant 1\}  &\quad& \hat \be_7& = & \{(0,1,\hat x_3)^t\,:\,0\leqslant\hat x_3\leqslant 1\} \\[4pt]
  \hat f_3 & \subseteq &  \{\hat x_3 = 0      \} & \qquad & \hat \be_3& = & \{(0,0,\hat x_3)^t\,:\,0\leqslant\hat x_3\leqslant 1\}  &\quad& \hat \be_8& = & \{(\hat x_1,1-\hat x_1,1)^t\,:\,0\leqslant\hat x_1\leqslant 1\} \\[4pt]
  \hat f_4 & \subseteq &  \{\hat x_3 = 1      \} & \qquad & \hat \be_4& = & \{(\hat x_1,0,1)^t\,:\,0\leqslant\hat x_1\leqslant 1\}  &\quad& \hat \be_9& = & \{(\hat x_1,1-\hat x_1,0)^t\,:\,0\leqslant\hat x_1\leqslant 1\} \\[4pt]
  \hat f_5 & \subseteq &  \{\hat x_1+\hat x_2 = 1\}  & \qquad & \hat \be_5& = & \{(0,\hat x_2,1)^t\,:\,0\leqslant\hat x_2\leqslant 1\}  &     &           &           &
\end{IEEEeqnarray*}
\input{./chap_interpolation/stability_edge_ref_prism}
\section{Stability of the generalized Raviart-Thomas element in $\hat{E}$} % (fold)
The exposition in this section will be there $H(\mbox{div})$--conforming analogue
of the exposition in the previous section.\\
\noindent In the next three Lemmas $\hat\bu$ is an element
in $H(\mbox{div},\hat{E})$ and we will assume there is
a positive $\delta$ such that $\hat\bu$ belongs to $H^{1/2+\delta}(\hat{E})^3$.
$\hat\br_k$ will be, for the whole section, the $k$--th order face 
interpolation operator on the reference
Prism determined by the element of
\emph{Definition}~(\ref{defi_h_div_conforme}).
\label{stability_of_rt_element_in_hat_k}
\begin{lemma}\label{lemmaRT3zero}
$(\rku)_3$ is linearly and univocally determined by $\hat{u}_3$.
\end{lemma}
\begin{proof}
By the unisolvence of the Finite Element~(\ref{defi_h_div_conforme})
$(\rku)_3$ is determined by the following linear equations.
\begin{IEEEeqnarray}{rCrl}
\label{rku_3_1}
\rho_{f_j,q}\,(\rku) & = & \rho_{f_j,q}\,(\hat{\bu})
  &\quad\mbox{for $j$ = 3, 4 and }q\in\mathcal{P}_{\hat{f}} \\
\label{rku_3_2}
\rho_{\br}\,(\rku) & = & \rho_{\br}\,(\hat{\bu})
  &\quad\mbox{for }\br\in\mathcal{P}_{\hat{E}}\mbox{ with }r_1 = r_2 = 0.
\end{IEEEeqnarray}
We have $\nicefrac{k(k+1)^2}{2}$ equations, which is the 
number of independent coefficients in $(\rku)_3$.
Now set $u_3 = 0$, which makes the right hand side of all the equations in~(\ref{rku_3_1})
and~(\ref{rku_3_2}) equal to zero.
Take $\hat f$ to be either $\hat{f}_3$ or $\hat{f}_4$. Put $q = (\rku)_3|_{\hat{f}}$ in~(\ref{rku_3_1}).
It yields
\begin{IEEEeqnarray*}{rCl}
  \int\limits_{\hat{E}} ((\rku)_3)^2\,d\bx & = & 0
\end{IEEEeqnarray*}
so there is a polinomial $\hat{q}_3\in(\mathcal{P}_{\hat{E}})_3$ such that
$(\rku)_3 \xyz = \hat{x}_3(\hat{x}_3-1)\,\hat{q}_3\xyz$
and the Lemma will follow once we apply the degrees of freedom~(\ref{rku_3_2})
with $\br$ set equal to $(0,0,\hat{q}_3)^t$. 
\end{proof}
{\color{blue}\#\#\#\#\#\#\#\# CONTINUE HERE.}
\begin{lemma}\label{lemma_u1_u2} If $\hat\bu\xyz = (0,0, \hat{u}_3\xyz)^t$,
then $\rku\xyz = (0,0,\hat{\xi}_3\xyz)$ for some $\hat{\xi}_3\in
P_{k-1}(\hat{f}_3)\otimes P_k(\hat{x}_3)$.
\end{lemma}
\begin{proof}
In a completely analogous way as was done in Section~(\ref{sub:defEdgeElement})
we can derive the following expressions for a 
$\rku = (\hat{p}_1, \hat{p}_2, \hat{p}_3)^t \in  P_{\hat{E}}$: 
\begin{IEEEeqnarray*}{rCl}
  \hat{p}_1\xyz & = & \hat{q}_1\xyz + \hat{x}_1\,\hat{h}\xyz\\
  \label{exprPrt}\yesnumber
  \hat{p}_2\xyz & = & \hat{q}_2\xyz + \hat{x}_2\,\hat{h}\xyz\\
  \hat{p}_3\xyz & = & \hat{q}_3\xyz
\end{IEEEeqnarray*}
for unique $\hat{q}_1, \hat{q}_2 \in \mathcal{P}_{k-1}(\hat{f}_3)
\otimes\mathcal{P}_{k-1}(\hat{x}_3)$,
$\hat{q}_3 \in \mathcal{P}_{k-1}(\hat{f}_3)\otimes\mathcal{P}_{k}(\hat{x}_3)$,
and
$\hat{h} \in \tilde{\mathcal{P}}_{k-1}(\hat{f}_3)\otimes\mathcal{P}_{k-1}(\hat{x}_3)$.
Take an arbitrary $\hat{q}\in\mathcal{P}_{k-1}(\hat f_1)\otimes\mathcal P_{k-1}(\hat z)$.
Continuing with the technique developed for Section
the trick
  will be to apply Green's Theorem to the field
  $(\hat{p}_1, \hat{p}_2, 0)^t$
  . By the surface degrees of freedom~(\ref{momentos2hdiv})
  and the volume degrees of freedom~(\ref{momentos3hdiv}) we have
  \begin{IEEEeqnarray*}{rCl}
    \int\limits_{\hat{E}} \text{div}(\hat{p}_1, \hat{p}_2, 0)^t\,\hat{q}\,d\hat{\textbf{x}}&=&
    \int\limits_{\partial\hat{E}} (\hat{p}_1, \hat{p}_2, 0)^t\cdot\boldsymbol{\hat\nu}\,\hat{q}\,d\gamma
    - \int\limits_{\hat{E}} (\hat{p}_1, \hat{p}_2, 0)^t\cdot\nabla \hat{q}\,d\hat{\textbf{x}}\\[5pt]
    & = &
    \int\limits_{{\color{red}\hat{f}}x+y=1} (\hat{u}_1 + \hat{u}_2) \hat{q}_{|_{{\color{red}\hat f x+y} = 1}}\,d\gamma
    - \int\limits_{{\color{red}\hat{f}}x=0} \hat{u}_1 \hat{q}_{|_{{\color{red}\hat f x=0}}}\,d\gamma\\[5pt]
    &&\,- \int\limits_{{\color{red}\hat{f}}y=0} \hat{u}_2 \hat{q}_{|_{{\color{red}\hat f y=0}}}\,d\gamma
    - \int\limits_{\hat{E}} \hat{u}_1\partial_{\hat x}\hat{q} 
      + \hat{u}_2 \partial_{\hat y}\hat{q}\,d\hat{\textbf{x}}\,=\,0.
  \end{IEEEeqnarray*}
  And since $\text{div}(\hat{p}_1, \hat{p}_2, 0)^t$ also belongs to
  $\pp{k-1}{k-1}$, we just proved it vanishes on all $\hat{E}$.\\[3pt]
  In a similar way as done in Lemma~(\ref{lemma_PIu2_k_in_N}), eq.~(\ref{h_is_zero}),
  we get to prove $h \equiv 0$ in expression~(\ref{exprPrt}). It means we may
  assume
  \begin{IEEEeqnarray*}{rCl}
    \hat{p}_1, \hat{p}_2 & \in & \mathcal{P}_{k-1}(\hat{f}_1)\otimes\mathcal{P}_{k-1}(\hat{z}).
  \end{IEEEeqnarray*}
  Now it is convenient to use again the degrees of freedom on the faces normal to $(-1, 0, 0)$ and $(0, -1, 0)$.
  The conditions
  \begin{IEEEeqnarray*}{rCl}
      \int\limits_{\hat f_1} \hat{p}_1\hat q\,d\hat\gamma & = & 0\qquad\mbox{for all }\hat{q}\in\mathcal{P}_{k-1}(\hat f_1)
  \end{IEEEeqnarray*}
  \begin{IEEEeqnarray*}{rCl}
      \int\limits_{\hat f_2} \hat{p}_2\hat q\,d\hat\gamma & = & 0\qquad\mbox{for all }\hat{q}\in\mathcal{P}_{k-1}(\hat f_2)
  \end{IEEEeqnarray*}
  imply that $\hat{x}_i$ divides $\hat{p}_i$ for both $i=1,2$. In other words, 
  there are $\phi$ and $\psi$ in $\pp{k-2}{k-1}$ such that
  \begin{IEEEeqnarray*}{rCl}
    \hat{p}_1 & = & \hat{x}\,\phi\\
    \hat{p}_2 & = & \hat{y}\,\psi.
  \end{IEEEeqnarray*}
  But finally, if we evaluate the degrees of freedom~(\ref{momentos3hdiv}),
  $\hat{p}_1 = (\hat{\br}_k\hat{\bu})_1$ and 
  $\hat{p}_2 = (\hat{\br}_k\hat{\bu})_2$ can be no other that
  constantly null over all $\hat{E}$. 
\end{proof}
\begin{lemma} Let $\hat{\bu}$ be in $P_{\hat E}$.\\[5pt]


\begin{itemize}
  \item []
  \item [(a)]\label{piu2_k_in_N} If $\hat\bu(\hat x_1,\hat x_2,\hat x_3) = (0, \hat u_2(\hat y,\hat z), 0)^t$,
  then $\wku\xyz = (0, \hat\xi_2(y,z) ,0)^t$ for some 
  $\hat\xi_2 \in P_{k-1}(\hat{x}_2) \otimes P_k(\hat{x}_3)$.
  \item [(b)]\label{piu1_k_in_N} If $\hat\bu(\hat x_1,\hat x_2,\hat x_3) = (\hat u_1(\hat x,\hat z), 0, 0)^t$
  then $\wku\xyz = (\hat\xi_1(x,z), 0 ,0)^t$ for some
    $\hat\xi_1\in P_{k-1}(\hat{x}_1) \otimes P_k(\hat{x}_3)$.
\end{itemize}




If $\hat{\bu}(\hat x_1,\hat x_2,\hat x_3) = (0, \hat u_2(\hat x_1,\hat x_3), 0)$,
then 
$\hat{\br}_k \hat{\bu}(\hat x_1,\hat x_2,\hat x_3) =
(0, \hat{r}_2(\hat x_1, \hat x_3), 0)$ for certain $\hat r_2\in (P_{\hat E})_2$.\\[3pt]
If $\hat{\bu}(\hat x_1,\hat x_2,\hat x_3) = (u_1(\hat x_2,\hat x_3), 0, 0)$,
then $\br_k \hat{\bu}(\hat x_1,\hat x_2,\hat x_3) =
(\hat{r}_1(\hat x_2,\hat x_3), 0, 0)$ for certain $\hat r_1\in (P_{\hat E})_1$.
\end{lemma}
\begin{proof} Let us prove the first one of the two claims. The second one 
  has an entirely analogous proof. By Lemma~(\ref{lemmaRT3zero}) we get
  $(\hat{\br}_k\hat{\boldsymbol{u}})_3 = 0$.
  The nullity of $\dv\hat{\bu}$ and the commutative
  diagram property~(\ref{lema_pi_star_rot_u}) give us %$\dv((\hat{\br}_k\hat{\bu})_1,(\hat{\br}_k\hat{\bu})_2, 0) = 0$.
  $\dv\hat{\br}_k\hat{\bu} = 0$.
  This last fact, together with the result of the evaluation of the 
  degrees of freedom~(\ref{momentos2hdiv})
  on the face $\hat f_1 \subseteq \{x_1=0\}$
  and~(\ref{momentos3hdiv}) over $\hat E$, implies, as we have seen in
  Lemma~(\ref{lemma_u1_u2}), that $(\hat{\br}_k\hat{\boldsymbol{u}})_1 = 0$.
  And if look again at 
  $\dv\hat{\br}_k\hat{\bu} = {\partial\hat{\br}_k\hat{\bu}}/{\partial\hat x_2} = 0$
  we have that $(\hat{\br}_k\hat{\boldsymbol{u}})_2$ does not depend on $\hat x_2$.
\end{proof}
\noindent It is time to state and prove the Theorem that was the purpose of this section.
\begin{theorem}\label{thm_stab_div}
If $\hat{\br}_k$ is the  
interpolation operator determined by the Finite Element of degree $k$ in
definition~(\ref{defi_h_div_conforme}), then
for all $\hat{\bu} \in W^{1,1}(\hat{E})$
\begin{IEEEeqnarray}{rCl}
\label{teoremaDiv_1} \norm{(\hat{\br}_k\hat{\bu})_1}_{L^{\infty}(\hat{E})} & 
    \lesssim & \|\hat{u}_1\|_{W^{1,1}(\hat{E})} + 
    \|\emph{div}(\hat{u}_1, \hat{u}_2, 0)\|_{L^{1}(\hat{E})} \\ 
\label{teoremaDiv_2} \norm{(\hat{\br}_k\hat{\bu})_2}_{L^{\infty}(\hat{E})} & 
    \lesssim & \|\hat{u}_2\|_{W^{1,1}(\hat{E})} + 
    \|\emph{div}(\hat{u}_1, \hat{u}_2, 0)\|_{L^{1}(\hat{E})} \\ 
\label{teoremaDiv_3} \norm{(\hat{\br}_k\hat{\bu})_3}_{L^{\infty}(\hat{E})} & 
    \lesssim & \|\hat{u}_3\|_{W^{1,1}(\hat{E})}.
\end{IEEEeqnarray}
\end{theorem}
\begin{proof} 
According to expression~(\ref{face_interp_explicit}) \dots

{\color{blue}\#\#\#\#\#\#\#\# HERE. Tal vez me convenga ocuparme primero
del teorema correspondiente para H(curl) porque hay muchas cosas
que ac'a ser'an 'como dijimos en el caso H(curl) ... etc ...'}
The proof is based on the last three Lemmas.
Given $\hat{\bu} \in W^{1,1}(\hat{E})$ let
$\hat{\bv} = (u_1, u_2 - u_2(x,0,z), 0)$. Then $(\pi \textbf{v})_1 = (\pi \textbf{u})_1$.
\\[5pt]
The DOF's.\\[5pt]
Some of them vanish or depend exclusively on $u_1$. The others:
Let $f$ be the face contained in $\{x+y = 1\}$. Take $q\in\mathcal{Q}_{k-1,k-1,k-1}$.
\begin{IEEEeqnarray*}{rCl}
    \int\limits_{f} \pi\textbf{v}\cdot\boldsymbol{\nu}\,q\,d\gamma &=&
    \int\limits_{f} (v_1 + v_2)\,q\,d\gamma.
\end{IEEEeqnarray*}
Observe that the restriction of $q$ to $f$ belongs to $\mathcal{P}_{k-1}(x)\otimes
\mathcal{P}_{k-1}(z)$. Now
\begin{IEEEeqnarray*}{rCl}
    \int\limits_{\hat{E}} \text{div} (u_1,u_2,0) \,q\,d\textbf{x} &=&
    \int\limits_{\hat{E}} \text{div}\,\textbf{v} \,q\,d\textbf{x}\\
    & = & -\int\limits_{\hat{E}} (u_1, v_2, 0)^t\cdot\nabla q\,d{\textbf{x}} + 
            \int\limits_{\partial_{\hat{E}}} (u_1, v_2, 0)^t\cdot\boldsymbol{\nu}\,q\,d\gamma\\
    & = & -\int\limits_{\hat{E}} u_1\partial_xq \,d{\textbf{x}} - \int\limits_{f_1}u_1\,q\,d\gamma
        + \int\limits_{f} (v_1 + v_2)\,q\,d\gamma,
\end{IEEEeqnarray*}
where $f_1$ is the face contained in the plane $x = 0$. So we have
\begin{IEEEeqnarray*}{rCl}
    \int\limits_{f} (v_1 + v_2)\,q\,d\gamma & = & \int\limits_{\hat{E}} \text{div} (u_1,u_2,0)
    \,q\,d\textbf{x} + \int\limits_{\hat{E}} u_1\partial_xq \,d{\textbf{x}} +
    \int\limits_{f_1}u_1\,q\,d\gamma.
\end{IEEEeqnarray*}
For the volume degrees of freedom~(\ref{momentos3hdiv}) take $q_2 \in P_{k-2}(x,y) \otimes P_{k-1}(z)$. Since
\begin{IEEEeqnarray*}{rCl}
    v_2(x,y,z) & = &\int\limits_0^{y} \partial_y u_2(x,t,z) \,dt,
\end{IEEEeqnarray*}
we may do
\begin{IEEEeqnarray*}{rCl}
    \int\limits_{\hat{E}} v_2\,q_2  & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-x}
    \int\limits_0^{y}
      \partial_y u_2(x,t,z) \,dt \,q_2 (x,y,z)\,dy\,dx\,dz\\
        & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-x}\int\limits_0^{y}
                \partial_y u_2(x,t,z) \,q_2 (x,y,z)\,dt\,dy\,dx\,dz\\
        & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-x}\int\limits_t^{1-x}
                \partial_y u_2(x,t,z) \,q_2 (x,y,z)\,dy\,dt\,dx\,dz\\
        & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-x}\partial_y u_2(x,t,z)
                \int\limits_t^{1-x}\,q_2 (x,y,z)\,dy\,dt\,dx\,dz\\
        & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-x}\partial_y u_2(x,t,z)\,\phi (x,t,z)\,dt\,dx\,dz\\
& = &\int\limits_{\hat{E}} (\partial_xu_1 + \partial_y u_2)\,\phi\,d{\textbf{x}}
    - \int\limits_{\hat{E}} \partial_xu_1\,\phi\,d{\textbf{x}}
\end{IEEEeqnarray*}
(for some $\phi \in \mathcal{P}_{k-1}(x,y)\otimes\mathcal{P}_{k-1}(z)$), as we wanted. 
\end{proof}
Theorems~(\ref{thm_stab_edge}) and~(\ref{thm_stab_div}) show that the interpolations
determined by the Finite Elements~(\ref{edgeelement}) and~(\ref{defi_h_div_conforme})
are anisotropically stable, in the sense that the image of a field $\hat\bu$ under
the linear operator depends not only continously on $\hat\bu$, but also with a
\emph{componentwise} bound, with perhaps and additional curl or divergence term, respectively.

% section stability_of_rt_element_in_hat_k (end)