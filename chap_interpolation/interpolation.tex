\chapter{Interpolation}
\begin{table}[h!]
\centering
\caption{Notation}
\label{edgeFacesNotationTable}
    \begin{IEEEeqnarraybox}
    [\IEEEeqnarraystrutmode
     \IEEEeqnarraystrutsizeadd{0pt}{0pt}]{v/c/v/c/v/c/v/c/v}
        \IEEEeqnarrayrulerow\\
        \IEEEeqnarrayseprow[3pt]\\
        &\hfill\raisebox{22pt}[0pt][0pt]{}\hfill
                            & & ***
                            & & ***
                            & & *** &\\
        \IEEEeqnarrayrulerow\\
        \IEEEeqnarrayseprow[3pt]\\
        &\hfill\raisebox{30pt}[0pt][0pt]{***}\hfill& &
            \begin{IEEEeqnarraybox}{c}
            ***\\***
            \end{IEEEeqnarraybox}
        &&&&
            \begin{IEEEeqnarraybox}{c}
                ***\\***
            \end{IEEEeqnarraybox}
        &\\
        \IEEEeqnarrayseprow[3pt]\\
        \IEEEeqnarrayrulerow
    \end{IEEEeqnarraybox}
\end{table}
\begin{IEEEeqnarray*}{rClCrClCrCl}
  \hat f_1 & \subseteq &  \{\hat x_1 = 0      \} & \qquad & \hat \be_1& = & \{(\hat x_1,0,0)^t\,:\,0\leqslant\hat x_1\leqslant 1\}  &\quad& \hat \be_6& = & \{(1,0,\hat x_3)^t\,:\,0\leqslant\hat x_3\leqslant 1\} \\[4pt]
  \hat f_2 & \subseteq &  \{\hat x_2 = 0      \} & \qquad & \hat \be_2& = & \{(0,\hat x_2,0)^t\,:\,0\leqslant\hat x_2\leqslant 1\}  &\quad& \hat \be_7& = & \{(0,1,\hat x_3)^t\,:\,0\leqslant\hat x_3\leqslant 1\} \\[4pt]
  \hat f_3 & \subseteq &  \{\hat x_3 = 0      \} & \qquad & \hat \be_3& = & \{(0,0,\hat x_3)^t\,:\,0\leqslant\hat x_3\leqslant 1\}  &\quad& \hat \be_8& = & \{(\hat x_1,1-\hat x_1,1)^t\,:\,0\leqslant\hat x_1\leqslant 1\} \\[4pt]
  \hat f_4 & \subseteq &  \{\hat x_3 = 1      \} & \qquad & \hat \be_4& = & \{(\hat x_1,0,1)^t\,:\,0\leqslant\hat x_1\leqslant 1\}  &\quad& \hat \be_9& = & \{(\hat x_1,1-\hat x_1,0)^t\,:\,0\leqslant\hat x_1\leqslant 1\} \\[4pt]
  \hat f_5 & \subseteq &  \{\hat x_1+\hat x_2 = 1\}  & \qquad & \hat \be_5& = & \{(0,\hat x_2,1)^t\,:\,0\leqslant\hat x_2\leqslant 1\}  &     &           &           &
\end{IEEEeqnarray*}
\input{./chap_interpolation/stability_edge_ref_prism}
\section{Stability of the generalized Raviart-Thomas element in $\hat{E}$} % (fold)
\label{stability_of_rt_element_in_hat_k}
We are writing the following three Lemmas which state some special
behavior of the interpolation operator, mostly related to the preservation of
null components of the fields, and whose proofs consist in a smart use of the
degrees of freedom and the very definition of the operator. The author and his
advisor think these Lemmas, although just with technical purpose, exhibit
nice properties of the interpolators. 
\begin{lemma}\label{lemmaRT3zero}
Let $\hat\bu\in$ {\color{red}dominio.} Then 
$(\hat{\boldsymbol{r}}_k\hat{\bu})_3$.
is linearly and univocally 
determined by $\hat{u}_3$.
\end{lemma}
\begin{proof}
\noindent{\color{blue}\#\#\#\#\#\#\# de aqui a la sgte marca, chequear si las expresiones
~(\ref{exprPrt}) son correctas 
  From the definition of the discrete space, and the notation involved, it follows that for each
  $\textbf{p} = (p_1, p_2, p_3) \in  P_{\hat{E}}$ there are unique $q_1, q_2 \in 
    \mathcal{P}_{k-1}(x,y)\otimes\mathcal{P}_{k-1}(z)$, $q_3 \in \mathcal{P}_{k-1}(x,y)\otimes\mathcal{P}_{k}(z)$, and
    $h \in \tilde{\mathcal{P}}_{k-1}(x,y)\otimes\mathcal{P}_{k-1}(z)$ such that
    \begin{IEEEeqnarray*}{rCl}
                                    p_1(x, y, z) & = & q_1(x, y, z) + x\,h(x, y, z)\\
        \label{exprPrt} \yesnumber  p_2(x, y, z) & = & q_2(x, y, z) + y\,h(x, y, z)\\
                                    p_3(x, y, z) & = & q_3(x, y, z)
    \end{IEEEeqnarray*} 
}
\noindent{\color{blue}\#\#\#\#\#\#\# }\\[5pt]
Take $\hat{\bu}$ with $\hat{u}_3 = 0$. Take $\hat f$ to be either the face of $\hat E$ with $\hat{z} = 0$ or 
the one with $\hat{z} = 1$. If $\hat{q}\in\mathcal{P}_{k-1}(\hat f)$, then
\begin{IEEEeqnarray*}{rCl}
  \int\limits_{\hat{f}}(\hat{\boldsymbol{r}}_k\hat{\bu})_3\,\hat q\,d\gamma = 0.
\end{IEEEeqnarray*}
But $(\hat{\boldsymbol{r}}_k\hat{\bu})_3|_{\hat f}$ belongs to
$\mathcal{P}_{k-1}(\hat f)$ (by expression~(\ref{exprPrt})), so
there is a polinomial $\hat\psi\in\mathcal{P}_{k-1}(\hat f)\otimes\mathcal{P}_{k-2}(\hat{z})$ such that
\begin{IEEEeqnarray*}{rCl}
  (\hat{\boldsymbol{r}}_k\hat{\bu})_3&=&\hat{z}(\hat{z}-1)\,\hat\psi,
\end{IEEEeqnarray*}
\noindent{\color{blue}\#\#\#\#\#\#\# la sgte oracion hay que aclararla con la cuenta?} 
and the Lemma will follow once we apply the degrees of freedom~(\ref{momentos4hdiv}). 
\end{proof}
\begin{lemma}\label{lemma_u1_u2} If $\hat\bu\in P_{\hat E}$ is such that $\hat{u}_1 = 0$
and $\hat{u}_2 = 0$, then $(\hat{\boldsymbol{r}}_k\hat{\bu})_1 = 0$
and $(\hat{\boldsymbol{r}}_k\hat{\textbf{\emph{u}}})_2 = 0$.
\end{lemma}
\begin{proof} We use again the expression~(\ref{exprPrt}) for $\hat{\boldsymbol{r}}_k\hat{\bu} =
  (\hat{p}_1, \hat{p}_2, \hat{p}_3) \in  P_{\hat{E}}$. Take an arbitrary
  $\hat{q}\in\mathcal{P}_{k-1}(\hat f_1)\otimes\mathcal P_{k-1}(\hat z)$, the trick
  will be to apply Green's Theorem to the field
  $(\hat{p}_1, \hat{p}_2, 0)^t$
  . By the surface degrees of freedom~(\ref{momentos2hdiv})
  and the volume degrees of freedom~(\ref{momentos3hdiv}) we have
  \begin{IEEEeqnarray*}{rCl}
    \int\limits_{\hat{E}} \text{div}(\hat{p}_1, \hat{p}_2, 0)^t\,\hat{q}\,d\hat{\textbf{x}}&=&
    \int\limits_{\partial\hat{E}} (\hat{p}_1, \hat{p}_2, 0)^t\cdot\boldsymbol{\hat\nu}\,\hat{q}\,d\gamma
    - \int\limits_{\hat{E}} (\hat{p}_1, \hat{p}_2, 0)^t\cdot\nabla \hat{q}\,d\hat{\textbf{x}}\\[5pt]
    & = &
    \int\limits_{{\color{red}\hat{f}}x+y=1} (\hat{u}_1 + \hat{u}_2) \hat{q}_{|_{{\color{red}\hat f x+y} = 1}}\,d\gamma
    - \int\limits_{{\color{red}\hat{f}}x=0} \hat{u}_1 \hat{q}_{|_{{\color{red}\hat f x=0}}}\,d\gamma\\[5pt]
    &&\,- \int\limits_{{\color{red}\hat{f}}y=0} \hat{u}_2 \hat{q}_{|_{{\color{red}\hat f y=0}}}\,d\gamma
    - \int\limits_{\hat{E}} \hat{u}_1\partial_{\hat x}\hat{q} 
      + \hat{u}_2 \partial_{\hat y}\hat{q}\,d\hat{\textbf{x}}\,=\,0.
  \end{IEEEeqnarray*}
  And since $\text{div}(\hat{p}_1, \hat{p}_2, 0)^t$ also belongs to
  $\pp{k-1}{k-1}$, we just proved it vanishes on all $\hat{E}$.\\[3pt]
  In a similar way as done in Lemma~(\ref{lemma_PIu2_k_in_N}), eq.~(\ref{h_is_zero}),
  we get to prove $h \equiv 0$ in expression~(\ref{exprPrt}). It means we may
  assume
  \begin{IEEEeqnarray*}{rCl}
    \hat{p}_1, \hat{p}_2 & \in & \mathcal{P}_{k-1}(\hat{f}_1)\otimes\mathcal{P}_{k-1}(\hat{z}).
  \end{IEEEeqnarray*}
  Now it is convenient to use again the degrees of freedom on the faces normal to $(-1, 0, 0)$ and $(0, -1, 0)$.
  The conditions
  \begin{IEEEeqnarray*}{rCl}
      \int\limits_{\hat f_1} \hat{p}_1\hat q\,d\hat\gamma & = & 0\qquad\mbox{for all }\hat{q}\in\mathcal{P}_{k-1}(\hat f_1)
  \end{IEEEeqnarray*}
  \begin{IEEEeqnarray*}{rCl}
      \int\limits_{\hat f_2} \hat{p}_2\hat q\,d\hat\gamma & = & 0\qquad\mbox{for all }\hat{q}\in\mathcal{P}_{k-1}(\hat f_2)
  \end{IEEEeqnarray*}
  imply that $\hat{x}_i$ divides $\hat{p}_i$ for both $i=1,2$. In other words, 
  there are $\phi$ and $\psi$ in $\pp{k-2}{k-1}$ such that
  \begin{IEEEeqnarray*}{rCl}
    \hat{p}_1 & = & \hat{x}\,\phi\\
    \hat{p}_2 & = & \hat{y}\,\psi.
  \end{IEEEeqnarray*}
  But finally, if we evaluate the degrees of freedom~(\ref{momentos3hdiv}),
  $\hat{p}_1 = (\hat{\boldsymbol{r}}_k\hat{\bu})_1$ and 
  $\hat{p}_2 = (\hat{\boldsymbol{r}}_k\hat{\bu})_2$ can be no other that
  constantly null over all $\hat{E}$. 
\end{proof}
\begin{lemma} Let $\hat{\bu}$ be in $P_{\hat E}$.\\[5pt]
If $\hat{\bu}(\hat x_1,\hat x_2,\hat x_3) = (0, \hat u_2(\hat x_1,\hat x_3), 0)$,
then 
$\hat{\boldsymbol{r}}_k \hat{\bu}(\hat x_1,\hat x_2,\hat x_3) =
(0, \hat{r}_2(\hat x_1, \hat x_3), 0)$ for certain $\hat r_2\in (P_{\hat E})_2$.\\[3pt]
If $\hat{\bu}(\hat x_1,\hat x_2,\hat x_3) = (u_1(\hat x_2,\hat x_3), 0, 0)$,
then $\boldsymbol{r}_k \hat{\bu}(\hat x_1,\hat x_2,\hat x_3) =
(\hat{r}_1(\hat x_2,\hat x_3), 0, 0)$ for certain $\hat r_1\in (P_{\hat E})_1$.
\end{lemma}
\begin{proof} Let us prove the first one of the two claims. The second one 
  has an entirely analogous proof. By Lemma~(\ref{lemmaRT3zero}) we get
  $(\hat{\boldsymbol{r}}_k\hat{\boldsymbol{u}})_3 = 0$.
  The nullity of $\dv\hat{\bu}$ and the commutative
  diagram property~(\ref{lema_pi_star_rot_u}) give us %$\dv((\hat{\boldsymbol{r}}_k\hat{\bu})_1,(\hat{\boldsymbol{r}}_k\hat{\bu})_2, 0) = 0$.
  $\dv\hat{\boldsymbol{r}}_k\hat{\bu} = 0$.
  This last fact, together with the result of the evaluation of the 
  degrees of freedom~(\ref{momentos2hdiv})
  on the face $\hat f_1 \subseteq \{x_1=0\}$
  and~(\ref{momentos3hdiv}) over $\hat E$, implies, as we have seen in
  Lemma~(\ref{lemma_u1_u2}), that $(\hat{\boldsymbol{r}}_k\hat{\boldsymbol{u}})_1 = 0$.
  And if look again at 
  $\dv\hat{\boldsymbol{r}}_k\hat{\bu} = {\partial\hat{\boldsymbol{r}}_k\hat{\bu}}/{\partial\hat x_2} = 0$
  we have that $(\hat{\boldsymbol{r}}_k\hat{\boldsymbol{u}})_2$ does not depend on $\hat x_2$.
\end{proof}
\noindent It is time to state and prove the Theorem that was the purpose of this section.
\begin{theorem}\label{thm_stab_div}
If $\hat{\boldsymbol{r}}_k$ is the  
interpolation operator determined by the Finite Element of degree $k$ in
definition~(\ref{defi_h_div_conforme}), then
for all $\hat{\bu} \in W^{1,1}(\hat{E})$
\begin{IEEEeqnarray}{rCl}
\label{teoremaDiv_1} \norm{(\hat{\boldsymbol{r}}_k\hat{\bu})_1}_{L^{\infty}(\hat{E})} & 
    \lesssim & \|\hat{u}_1\|_{W^{1,1}(\hat{E})} + 
    \|\emph{div}(\hat{u}_1, \hat{u}_2, 0)\|_{L^{1}(\hat{E})} \\ 
\label{teoremaDiv_2} \norm{(\hat{\boldsymbol{r}}_k\hat{\bu})_2}_{L^{\infty}(\hat{E})} & 
    \lesssim & \|\hat{u}_2\|_{W^{1,1}(\hat{E})} + 
    \|\emph{div}(\hat{u}_1, \hat{u}_2, 0)\|_{L^{1}(\hat{E})} \\ 
\label{teoremaDiv_3} \norm{(\hat{\boldsymbol{r}}_k\hat{\bu})_3}_{L^{\infty}(\hat{E})} & 
    \lesssim & \|\hat{u}_3\|_{W^{1,1}(\hat{E})}.
\end{IEEEeqnarray}
\end{theorem}
\begin{proof} 
According to expression~(\ref{face_interp_explicit}) \dots

{\color{blue}\#\#\#\#\#\#\#\# HERE. Tal vez me convenga ocuparme primero
del teorema correspondiente para H(curl) porque hay muchas cosas
que ac'a ser'an 'como dijimos en el caso H(curl) ... etc ...'}
The proof is based on the last three Lemmas.
Given $\hat{\bu} \in W^{1,1}(\hat{E})$ let
$\hat{\bv} = (u_1, u_2 - u_2(x,0,z), 0)$. Then $(\pi \textbf{v})_1 = (\pi \textbf{u})_1$.
\\[5pt]
The DOF's.\\[5pt]
Some of them vanish or depend exclusively on $u_1$. The others:
Let $f$ be the face contained in $\{x+y = 1\}$. Take $q\in\mathcal{Q}_{k-1,k-1,k-1}$.
\begin{IEEEeqnarray*}{rCl}
    \int\limits_{f} \pi\textbf{v}\cdot\boldsymbol{\nu}\,q\,d\gamma &=&
    \int\limits_{f} (v_1 + v_2)\,q\,d\gamma.
\end{IEEEeqnarray*}
Observe that the restriction of $q$ to $f$ belongs to $\mathcal{P}_{k-1}(x)\otimes
\mathcal{P}_{k-1}(z)$. Now
\begin{IEEEeqnarray*}{rCl}
    \int\limits_{\hat{E}} \text{div} (u_1,u_2,0) \,q\,d\textbf{x} &=&
    \int\limits_{\hat{E}} \text{div}\,\textbf{v} \,q\,d\textbf{x}\\
    & = & -\int\limits_{\hat{E}} (u_1, v_2, 0)^t\cdot\nabla q\,d{\textbf{x}} + 
            \int\limits_{\partial_{\hat{E}}} (u_1, v_2, 0)^t\cdot\boldsymbol{\nu}\,q\,d\gamma\\
    & = & -\int\limits_{\hat{E}} u_1\partial_xq \,d{\textbf{x}} - \int\limits_{f_1}u_1\,q\,d\gamma
        + \int\limits_{f} (v_1 + v_2)\,q\,d\gamma,
\end{IEEEeqnarray*}
where $f_1$ is the face contained in the plane $x = 0$. So we have
\begin{IEEEeqnarray*}{rCl}
    \int\limits_{f} (v_1 + v_2)\,q\,d\gamma & = & \int\limits_{\hat{E}} \text{div} (u_1,u_2,0)
    \,q\,d\textbf{x} + \int\limits_{\hat{E}} u_1\partial_xq \,d{\textbf{x}} +
    \int\limits_{f_1}u_1\,q\,d\gamma.
\end{IEEEeqnarray*}
For the volume degrees of freedom~(\ref{momentos3hdiv}) take $q_2 \in P_{k-2}(x,y) \otimes P_{k-1}(z)$. Since
\begin{IEEEeqnarray*}{rCl}
    v_2(x,y,z) & = &\int\limits_0^{y} \partial_y u_2(x,t,z) \,dt,
\end{IEEEeqnarray*}
we may do
\begin{IEEEeqnarray*}{rCl}
    \int\limits_{\hat{E}} v_2\,q_2  & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-x}
    \int\limits_0^{y}
      \partial_y u_2(x,t,z) \,dt \,q_2 (x,y,z)\,dy\,dx\,dz\\
        & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-x}\int\limits_0^{y}
                \partial_y u_2(x,t,z) \,q_2 (x,y,z)\,dt\,dy\,dx\,dz\\
        & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-x}\int\limits_t^{1-x}
                \partial_y u_2(x,t,z) \,q_2 (x,y,z)\,dy\,dt\,dx\,dz\\
        & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-x}\partial_y u_2(x,t,z)
                \int\limits_t^{1-x}\,q_2 (x,y,z)\,dy\,dt\,dx\,dz\\
        & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-x}\partial_y u_2(x,t,z)\,\phi (x,t,z)\,dt\,dx\,dz\\
& = &\int\limits_{\hat{E}} (\partial_xu_1 + \partial_y u_2)\,\phi\,d{\textbf{x}}
    - \int\limits_{\hat{E}} \partial_xu_1\,\phi\,d{\textbf{x}}
\end{IEEEeqnarray*}
(for some $\phi \in \mathcal{P}_{k-1}(x,y)\otimes\mathcal{P}_{k-1}(z)$), as we wanted. 
\end{proof}
Theorems~(\ref{thm_stab_edge}) and~(\ref{thm_stab_div}) show that the interpolations
determined by the Finite Elements~(\ref{edgeelement}) and~(\ref{defi_h_div_conforme})
are anisotropically stable, in the sense that the image of a field $\hat\bu$ under
the linear operator depends not only continously on $\hat\bu$, but also with a
\emph{componentwise} bound, with perhaps and additional curl or divergence term, respectively.

% section stability_of_rt_element_in_hat_k (end)