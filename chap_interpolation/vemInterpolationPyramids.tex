\section{Local Interpolation Estimates for Pyramidal Virtual Elements}
\begin{lemma}\label{auxlabel6}
If $E$ is a pyramidal element, $\bu$ is an element of $W^{1,p}(E)$ with 
$1\leqslant p\leqslant 2$
and $(I\bu)$ is its low order $H(\text{div})$ interpolant defined in Corollary~\ref{interpolant},
then
\begin{equation}\label{estab2}
\|(I\bu)\|_{L^p(E)}\leqslant C\left(\|\bu\|_{L^p(E)}+ h|\bu|_{W^{1,p}(E)}\right)
\end{equation}
with $h$ being the diameter of $E$ and the constant $C$ depending only on the shape regularity of $E$.
\end{lemma}
\begin{proof} Denote by $f_j$, $1\leqslant j\leqslant 5$ the faces of $E$
and by 
$\{\bv_i\}_{i=1}^5$ the basis of $V_h(E)$ which is dual to the degrees of freedom
\eqref{dofs}. 
%We note that 
%\begin{equation}\label{estab2:eq1}
%(I\bu)=\sum_{i=1}^5 \left(\int_{f_i}\bu\cdot \bn\right)\bv_i
%\end{equation}
We start with the estimate of the $L^2$-norm of any $\bv_i$. Pick 
$1\leqslant i\leqslant 5$. We saw in the proof of 
Lemm~\ref{unisolvence} that $\bv_i=\nabla \psi$ where $\psi$ is the solution of
the auxiliary problem
\begin{IEEEeqnarray*}{rCl}
\Delta\psi&=&\tfrac{1}{|E|}\qquad\mbox{in }E\\
\tfrac{\partial\psi}{\partial\bn}&=&g\qquad\mbox{on }\partial E
\end{IEEEeqnarray*}
where $g$ was defined as
\begin{IEEEeqnarray}{rCl}
\label{auxlabel7}
g|_{f_j}& = &
  \left\{
    \begin{array}{cl}
        \frac1{|f_i|}&\mbox{if }i=j\\
                    0&\mbox{if }i\ne j
    \end{array}\right..
\end{IEEEeqnarray}
Fix a solution requiring that $\int_E\psi\,d\bx = 0$.
Integration by parts gives
\begin{eqnarray*}
\|\nabla\psi\|_{L^2(E)}^2 &=& -\tfrac{1}{|E|}\int_E\psi\,d\bx + \iint_{\partial E}g\psi\,dS\\
&\leqslant & 
|E|^{-\nicefrac12}\|\psi\|_{L^2(E)} + \|g\|_{L^2(\partial E)}\|\psi\|_{L^2(\partial E)}.
\end{eqnarray*}
Using Poincare's and traces inequalities we have, for a positive constant $C$
depending only on the aspect ratio of $E$, 
\begin{equation}\label{estab2:eq2}
\|\nabla\psi\|_{L^2(E)}^2\leqslant  C\left(h_E|E|^{-\nicefrac12} + h_E^{\nicefrac12} \|g\|_{L^2(\partial E)}\right) \|\nabla\psi\|_{L^2(E)}.
\end{equation}
But, by~(\ref{auxlabel7}), it holds $\|g\|_{L^2(\partial E)}\leqslant Ch_E^{-1}$
and so from \eqref{estab2:eq2} we obtain
\begin{equation}\label{estab2:eq3}
\|\bv_i\|_{L^2(E)}=\|\nabla\psi\|_{L^2(E)}\leqslant Ch_E^{-{\nicefrac12}}.
\end{equation}
Now, for $1\leqslant p\leqslant 2$, using H\"older's inequality we have
\begin{eqnarray*}
\|(I\bu)\|_{L^p(E)}
&\leqslant& |E|^{{\nicefrac1p}-{\nicefrac12}}\|(I\bu)\|_{L^2(E)}\\
&\leqslant& |E|^{{\nicefrac1p}-{\nicefrac12}} \sum_{i=1}^5 
  \left|\iint_{f_i}\bu\cdot\bn\,dS\right|\|\bv_i\|_{L^2(E)}.
\end{eqnarray*}
By using \eqref{estab2:eq3} and traces inequalities %and taking into account the shape-regularity of $E$
we obtain
\begin{eqnarray*}
\|(I\bu)\|_{L^p(E)} &\leqslant& C |E|^{{\nicefrac1p}-{\nicefrac12}} 
  h_E^{-{\nicefrac1p}}\left(\|\bu\|_{L^p(E)}+h_E\|\nabla\bu\|_{L^p(E)}\right)|\partial E|^{1-{\nicefrac1p}} \|\bv_i\|_{L^2(E)}\\
&\leqslant& C h_E^{3\left({\nicefrac1p}-{\nicefrac12}\right)}\,h_E^{-{\nicefrac1p}}\,
  h_E^{2\left(1-{\nicefrac1p}\right)}\,h_E^{-{\nicefrac12}}
    \left(\|\bu\|_{L^p(E)} + h_E\|\nabla\bu\|_{L^p(E)}\right)\\
& = & C \left(\|\bu\|_{L^p(E)} + h_E\|\nabla\bu\|_{L^p(E)}\right).
\end{eqnarray*}


%\sum_{i=1}^5 \left|\int_{f_i}\bu\cdot\bn\right|\|\bv_i\|_{L^2(E)}\\&\leqslant& \sum_{i=1}^5 |f_i|^{\nicefrac12}\|\bu\|_{L^2(f_i)}\|\bv_i\|_{L^2(E)}\\ &\le& C|f_i|^\frac12\left(h_e^{-\frac12}\|\bu\|_{L^2(E)}+h_E^\frac12\|\nabla\bu\|_{L^2(E)}\right)\|\bv_i\|_{L^2(E)}\\ &\le& C\left(\|\bu\|_{L^2(E)}+h_E\|\nabla\bu\|_{L^2(E)}\right)

\end{proof}

\begin{proposition}\label{propErrorInterpolacionPiramidesTetraedros}
Let $E$ be a pyramid satisfying the shape-regularity property with constant $\sigma$.
Then there exists a constant $C$ depending only on $\sigma$ such that 
for all $\bu\in H^1(E)$
\[
\|\bu-(I\bu)\|_{L^2(E)}\leqslant C h_E|\bu|_{H^1(E)}.
\]
\end{proposition}
\begin{proof} Let $\Qbb\bu$ be the $L^2(E)$ projection of $\bu$ onto the 
constant fields. Then we have
\[
\bu-(I\bu) = (\bu - \Qbb\bu) + I(\Qbb\bu-\bu)
\]
and using the previous Lemma and a clasical estimate for the $L^2(E)$ projection
error we have
\begin{eqnarray*}
  \|\bu-(I\bu)\|_{L^2(E)} &\leqslant& \|\bu - \Qbb\bu\|_{L^2(E)} + 
    \|I(\bu-\Qbb\bu)\|_{L^2(E)}\\ 
  &\leqslant& \|\bu - \Qbb\bu\|_{L^2(E)}\\
  &&\, + \, C \left(\|\bu-\Qbb\bu\|_{L^2(E)} + 
  h_E\|\nabla(\bu-\Qbb\bu)\|_{L^2(E)}\right)\\ 
  & = & C\left(\|\bu-\Qbb\bu\|_{L^2(E)} + h_E\|\nabla\bu\|_{L^2(E)}\right)\\
  & \leqslant & C h_E \|\nabla\bu\|_{L^2(E)}
\end{eqnarray*}
as we wanted to prove.
\end{proof} 
By repeating the last step of the previous proof we can derive the following Proposition
whose utility will be apparent in Chapter~\ref{auxLabel100}.
\begin{proposition}\label{propupi}
Let $E$ be a pyramid satisfying a shape regularity property with constant 
$\sigma$, and $\bu\in H^1(E)$. 
There is a field $\bw_{\bu}\in W(E)$ such that
\[
  \|\bu-\bw_{\bu}\|_{L^2(E)} \leqslant C h_E |\bu|_{H^1(E)}.
\]
\end{proposition}
\begin{proof}
Take $\bw_{\bu}$
as the $L^2(E)$ projection of $\bu$ onto the space of constants fields.
\end{proof}
\begin{remark}
  We could replicate the results obtained for prisms at low order. We are not
  applying pyramidal finite element interpolation, though.
\end{remark}