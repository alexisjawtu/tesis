\section{Prismatic Finite Elements} % (fold)
\label{sec:prismatic_finite_elements}
\subsection{Stability of curl--conforming Finite Element on Prisms}
\label{stab_edge_prism}
\input{./chap_interpolation/stability_edge_ref_prism}
\input{./chap_interpolation/stability_edge_tilde_prism}
\subsection{Stability of divergence--conforming Finite Elements on Prisms} % (fold)
The exposition in this section will be the $H(\mbox{div})$--conforming analogue
of the exposition in the previous section.\\
\noindent In present subsection $\hat\bu$ will be an element
of $W^{1,1}(\hat E)$ in which elements have well defined
normal traces over the faces of $\hat{E}$, another possibility
being, as mentioned in~\cite{monk}, Lemma $5.15$, page $120$, to assume
there is
a positive $\delta$ such that $\hat\bu$ belongs to
$H^{1/2+\delta}(\hat{E})^3$.
$\hat\br_k$ will be, for the whole subsection, the $k$--th order face 
interpolation operator on the reference
Prism determined by the element of
\emph{Definition}~\ref{defi_h_div_conforme}.
\label{stability_of_rt_element_in_hat_k}
\begin{lemma}\label{lemmaRT3zero}
$(\rku)_3$ is linearly and univocally determined by $\hat{u}_3$.
\end{lemma}
\begin{proof}
By the unisolvence of the Finite Element~(\ref{defi_h_div_conforme})
$(\rku)_3$ is determined by the following linear equations.
\begin{IEEEeqnarray}{rCrl}
\label{rku_3_1}
\rho_{f_j,q}\,(\rku) & = & \rho_{f_j,q}\,(\hat{\bu})
  &\quad\mbox{for $j$ = 3, 4 and }q\in\mathcal{P}_{\hat{f}_j} \\
\label{rku_3_2}
\rho_{\br}\,(\rku) & = & \rho_{\br}\,(\hat{\bu})
  &\quad\mbox{for }\br\in\mathcal{P}_{\hat{E}}\mbox{ with }r_1 = r_2 = 0.
\end{IEEEeqnarray}
We have $\nicefrac{k(k+1)^2}{2}$ equations, which is the 
number of independent coefficients in $(\rku)_3$.
Now set $u_3 = 0$, which makes the right hand side of all the equations in~(\ref{rku_3_1})
and~(\ref{rku_3_2}) equal to zero.
Take $\hat f$ to be either $\hat{f}_3$ or $\hat{f}_4$. Put $q = (\rku)_3|_{\hat{f}}$ in~(\ref{rku_3_1}).
It yields
\begin{IEEEeqnarray*}{rCl}
  \int\limits_{\hat{f}} ((\rku)_3)^2\,d\hat{\gamma} & = & 0
\end{IEEEeqnarray*}
so there is a polinomial $\hat{q}_3\in(\mathcal{P}_{\hat{E}})_3$ such that
$(\rku)_3 \xyz = \hat{x}_3(\hat{x}_3-1)\,\hat{q}_3\xyz$
and the Lemma will follow once we apply the degrees of freedom~(\ref{rku_3_2})
with $\br$ set equal to $(0,0,\hat{q}_3)^t$. 
\end{proof}
\begin{lemma}\label{lemma_u1_u2} If $\hat\bu\xyz = (0,0, \hat{u}_3\xyz)^t$,
then $\rku\xyz = (0,0,\hat{\xi}_3\xyz)$ for some $\hat{\xi}_3\in
P_{k-1}(\hat{f}_3)\otimes P_k(\hat{x}_3)$.
\end{lemma}
\begin{proof}
In a completely analogous way as was done in Section~\ref{sub:defEdgeElement}
we can derive the following expressions for 
$\rku = (\hat{p}_1, \hat{p}_2, \hat{p}_3)^t \in  P_{\hat{E}}$: 
\begin{IEEEeqnarray*}{rCl}
  \hat{p}_1\xyz & = & \hat{q}_1\xyz + \hat{x}_1\,\hat{h}\xyz\\
  \label{exprPrt}\yesnumber
  \hat{p}_2\xyz & = & \hat{q}_2\xyz + \hat{x}_2\,\hat{h}\xyz\\
  \hat{p}_3\xyz & = & \hat{q}_3\xyz
\end{IEEEeqnarray*}
for unique $\hat{q}_1, \hat{q}_2 \in \mathcal{P}_{k-1}(\hat{f}_3)
\otimes\mathcal{P}_{k-1}(\hat{x}_3)$,
$\hat{q}_3 \in \mathcal{P}_{k-1}(\hat{f}_3)\otimes\mathcal{P}_{k}(\hat{x}_3)$,
and
$\hat{h} \in \tilde{\mathcal{P}}_{k-1}(\hat{f}_3)\otimes\mathcal{P}_{k-1}(\hat{x}_3)$.
Take an arbitrary $\hat{q}\in\mathcal{P}_{k-1}(\hat f_1)\otimes\mathcal P_{k-1}(\hat z)$.
Continuing with the technique developed for Section~\ref{stab_edge_prism}, 
the trick will be to apply Green's Theorem to the field
$(\hat{p}_1, \hat{p}_2, 0)^t$ and the scalar $\hat{q}$. By the surface degrees of
freedom~(\ref{momentos2hdiv}) and the volume degrees of freedom~(\ref{momentos3hdiv}) we have
  \begin{IEEEeqnarray*}{rClCl}
    \int\limits_{\hat{E}} \mbox{div}(\hat{p}_1, \hat{p}_2, 0)^t\,\hat{q}\,d\hat{\bx}&=&
    \int\limits_{\partial\hat{E}} (\hat{p}_1, \hat{p}_2, 0)^t\cdot\boldsymbol{\hat\nu}\,\hat{q}\,d\hat{\gamma}
    - \int\limits_{\hat{E}} (\hat{p}_1, \hat{p}_2, 0)^t\cdot\nabla \hat{q}\,d\hat{\bx}&&\\[5pt]
    & = &
    \int\limits_{\hat{f}_5} (\hat{u}_1 + \hat{u}_2)
    \hat{q}_{|_{\hat{f}_5 = 1}}\,d\hat{\gamma}
    - \int\limits_{\hat{f}_1} \hat{u}_1 \hat{q}_{|_{\hat{f}_1}}\,d\hat{\gamma}&&\\[5pt]
    &&\,- \int\limits_{\hat{f}_2} \hat{u}_2 \hat{q}_{|_{\hat{f}_2}}\,d\hat{\gamma}
    - \int\limits_{\hat{E}} \hat{u}_1
    \frac{\partial\hat{q}}{\partial{\hat{x}_1}} 
      + \hat{u}_2\frac{\partial\hat{q}}{\partial{\hat{x}_2}}\,d\hat{\bx} & = & 0.
  \end{IEEEeqnarray*}
  And since $\mbox{div}(\hat{p}_1, \hat{p}_2, 0)^t$ also belongs to
  $\pp{k-1}{k-1}$, we just established it vanishes on all $\hat{E}$.\\[3pt]
  In a similar way as done in Lemma~\ref{lemma_PIu2_k_in_N}, eq.~(\ref{h_is_zero}),
  we get to prove $\hat{h} \equiv 0$ in expression~(\ref{exprPrt}). It means we may
  assume that $\hat{p}_1$ and $\hat{p}_2$ belong to 
  $\mathcal{P}_{k-1}(\hat{f}_3)\otimes\mathcal{P}_{k-1}(\hat{x}_3)$.
  Now it is convenient to use again the degrees of freedom on the
  faces normal to $(-1, 0, 0)^t$ and $(0, -1, 0)^t$.
  The conditions
  \begin{IEEEeqnarray*}{rCCCl}
    \rho_{\hat f_1\,\hat q}(\rku) & = & \int\limits_{\hat f_1} \hat{p}_1\hat q\,d\hat\gamma
    & = & 0\qquad\mbox{for all }\hat{q}\in\mathcal{P}_{k-1}(\hat f_1)\\
    \rho_{\hat f_2\,\hat q}(\rku) & = & \int\limits_{\hat f_2} \hat{p}_2\hat q\,d\hat\gamma
    & = & 0\qquad\mbox{for all }\hat{q}\in\mathcal{P}_{k-1}(\hat f_2)
  \end{IEEEeqnarray*}
  ensure that $\hat{x}_i$ divides $\hat{p}_i$ for both $i=1,2$.
%  In other words, there are $\phi$ and $\psi$ in $\pp{k-2}{k-1}$ such that
%  \begin{IEEEeqnarray*}{rCl}
%    \hat{p}_1 & = & \hat{x}\,\phi\\
%    \hat{p}_2 & = & \hat{y}\,\psi.
%  \end{IEEEeqnarray*}
But finally, if we evaluate the degrees of freedom~(\ref{momentos3hdiv}),
we see that  $\hat{p}_1 = (\rku)_1$ and 
$\hat{p}_2 = (\rku)_2$ can be no other that
constantly null over all $\hat{E}$. 
\end{proof}
\begin{lemma}
\begin{itemize}
  \item []
  \item [(a)]\label{piu2_k_in_N} If $\hat\bu(\hat x_1,\hat x_2,\hat x_3) =
  (0, \hat{u}_2(\hat x_1,\hat x_3), 0)^t$,
  then $\rku\xyz = (0, \hat\xi_2(\hat x_1, \hat x_3) ,0)^t$ for some 
  $\hat\xi_2 \in P_{k-1}(\hat{x}_2) \otimes P_k(\hat{x}_3)$.
  \item [(b)]\label{piu1_k_in_N} If $\hat\bu(\hat x_1,\hat x_2,\hat x_3) = 
  (\hat{u}_1(\hat x_2,\hat x_3), 0, 0)^t$
  then $\rku\xyz = (\hat\xi_1(\hat x_2,\hat x_3), 0 ,0)^t$ for some
    $\hat\xi_1\in P_{k-1}(\hat{x}_1) \otimes P_k(\hat{x}_3)$.
\end{itemize}
\end{lemma}
\begin{proof} Let us prove the first one of the two claims. The second one 
  has an entirely analogous proof. By Lemma~\ref{lemmaRT3zero} we get
  $(\rku)_3 = 0$.
  The nullity of $\dv\hat{\bu}$ and the commutative
  diagram property~(\ref{lema_pi_star_rot_u}) give us
  $\dv\rku = 0$.
  This last fact, together with the result of the evaluation of the 
  degrees of freedom~(\ref{momentos2hdiv})
  on the face $\hat f_1 \subseteq \{x_1=0\}$
  and~(\ref{momentos3hdiv}) over $\hat E$, implies, as we have seen in
  Lemma~\ref{lemma_u1_u2}, that $(\rku)_1 = 0$.
  And if look again at 
  $\dv\rku = {\partial\rku}/{\partial\hat x_2} = 0$
  we have that $(\rku)_2$ does not depend on $\hat x_2$.
\end{proof}
\noindent It is time to state and prove the Theorem that was the purpose of this section.
\begin{theorem}\label{thm_stab_div} Given $\hat{\bu} \in W^{1,1}(\hat{E})$
\begin{IEEEeqnarray}{rCl}
\label{teoremaDiv_1} \norm{(\rku)_1}_{L^{\infty}(\hat{E})} & 
    \lesssim & \|\hat{u}_1\|_{W^{1,1}(\hat{E})} + 
    \|\emph{div}(\hat{u}_1, \hat{u}_2, 0)\|_{L^{1}(\hat{E})} \\ 
\label{teoremaDiv_2} \norm{(\rku)_2}_{L^{\infty}(\hat{E})} & 
    \lesssim & \|\hat{u}_2\|_{W^{1,1}(\hat{E})} + 
    \|\emph{div}(\hat{u}_1, \hat{u}_2, 0)\|_{L^{1}(\hat{E})} \\ 
\label{teoremaDiv_3} \norm{(\rku)_3}_{L^{\infty}(\hat{E})} & 
    \lesssim & \|\hat{u}_3\|_{W^{1,1}(\hat{E})}
\end{IEEEeqnarray}
where the constants in the inequalities depend olny on $\hat{E}$.
\end{theorem}
\begin{proof}[Proof of Theorem~\ref{thm_stab_div}] The proof is based on the
last three Lemmas. By Remark~\ref{density_wpcurl} we can state the estimate for
a smooth field $\hat{\bu}$ and then finish the proof with a density argument.\\[4pt]
Take again $\omega$ as the closure of $\hat{E}$ and 
$\hat\bu\in\mathcal{C}^\infty(\omega)^3$. Let
us prove the first inequality. Set
$\hat{\bv} = (\hat{u}_1, \hat{u}_2 - \hat{u}_2(\hat{x}_1,0,\hat{x}_3), 0)$.
Then $(\hat{\br}_k\bv)_1 = (\rku)_1$.
By evaluating the degrees of freedom to $\hat{\bv}$ we observe
that some of them vanish or depend exclusively on $\hat{u}_1$ in the way
we need them to depend on $\hat{u}_1$. As for the others,
pick first 
$\hat{q}_0 \in \mathcal{P}_{\hat{f}_5} = 
P_{k-1}(\hat{x}_1)\otimes P_{k-1}(\hat{x}_3)$
and extend it as the same polynomial  
$\hat{q}$ to $Q_{k-1,k-1,k-1}$.
\begin{IEEEeqnarray*}{rCl}
  \rho_{\hat{f}_5,\,\hat{q}_0} (\hat{\bv})
  & = & \int\limits_{\hat{f}_5} \hat{u}_1\,\hat{q}_0\,d\hat{\gamma} + 
  \sqrt{2}\iint\limits_{[0,1]^2} \hat{q}_0(\hat{x}_1,\hat{x}_3)
  \int_0^{1-\hat{x}_1}\frac{\partial \hat{v}_2}{\partial\hat{x}_2}
    (\hat{x}_1,\hat{t},\hat{x}_3)\,d\hat{t}d\hat{x}_1d\hat{x}_3\\[5pt]    
  & = & \int\limits_{\hat{f}_5} \hat{u}_1\,\hat{q}_0\,d\hat{\gamma} + 
  \sqrt{2}\int\limits_{\hat{E}} \hat{q}\frac{\partial \hat{v}_2}{\partial\hat{x}_2}\,d\hat{\bx}\\[5pt]    
  & = & \int\limits_{\hat{f}_5} \hat{u}_1\,\hat{q}_0\,d\hat{\gamma} + 
  \sqrt{2}\int\limits_{\hat{E}} \hat{q}\,\{\,\mbox{div} (\hat{u}_1,\hat{u}_2,0)^t -
    \frac{\partial \hat{u}_1}{\partial\hat{x}_1}\,\}\,d\hat{\bx}.
\end{IEEEeqnarray*}
For the volume degrees of freedom~(\ref{momentos3hdiv}) take $\hat{q}_2
\in P_{k-2}(\hat{f}_3) \otimes P_{k-1}(\hat{x}_3)$. Write 
$\hat{v}_2\xyz = \int_0^{\hat{x}_2} 
\nicefrac{\partial\hat{u}_2}{\partial\hat{x}_2}(\hat{x}_1,\hat{t},\hat{x}_3)\,d\hat{t}$ and do
{\color{brown}\#\#\#\#\#\#\#\# partir este array para pasar de p'agina.}
\begin{IEEEeqnarray*}{rCl}
  \int\limits_{\hat{E}} \hat{v}_2\,\hat{q}_2 
  & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-\hat{x}_1}
  \int\limits_0^{\hat{x}_2}
    \frac{\partial \hat{u}_2}{\partial \hat{x}_2} 
    (\hat{x}_1,\hat{t},\hat{x}_3)\,d\hat{t}\,\hat{q}_2\xyz\,d\hat{x}_2\,d\hat{x}_1\,d\hat{x}_3\\
  & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-\hat{x}_1}\int\limits_0^{\hat{x}_2}
        \frac{\partial\hat{u}_2}{\partial\hat{x}_2}(\hat{x}_1,\hat{t},\hat{x}_3)
        \,\hat{q}_2 \xyz\,d\hat{t}\,d\hat{x}_2\,d\hat{x}_1\,d\hat{x}_3\\
  & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-\hat{x}_1}\int\limits_{\hat{t}}^{1-\hat{x}_1}
        \frac{\partial\hat{u}_2}{\partial\hat{x}_2}(\hat{x}_1,\hat{t},\hat{x}_3)\,\hat{q}_2\xyz\,
        d\hat{x}_2\,d\hat{t}\,d\hat{x}_1\,d\hat{x}_3\\
  & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-\hat{x}_1}
        \frac{\partial \hat{u}_2}{\partial \hat{x}_2}(\hat{x}_1,\hat{t},\hat{x}_3)
        \int\limits_{\hat{t}}^{1-\hat{x}_1}\,\hat{q}_2\xyz\,d\hat{x}_2\,d\hat{t}\,d\hat{x}_1\,d\hat{x}_3\\
  & = &\int\limits_0^1\int\limits_0^1\int\limits_0^{1-\hat{x}_1}
  \frac{\partial\hat{u}_2}{\partial\hat{x}_2}(\hat{x}_1,\hat{t},\hat{x}_3)\,
       \hat{\phi} (\hat{x}_1,\hat{t},\hat{x}_3)\,d\hat{t}\,d\hat{x}_1\,d\hat{x}_3\\
& = &\int\limits_{\hat{E}} \mbox{div} (\hat{u}_1,\hat{u}_2,0)^t\,\hat{\phi}\,d\hat{\bx}
    - \int\limits_{\hat{E}}\frac{\partial\hat{u}_1}{\partial\hat{x}_1}\,\hat{\phi}\,d\hat{\bx}
\end{IEEEeqnarray*}
(for some $\hat{\phi} \in  P_{k-1}(\hat{f}_3)\otimes P_{k-1}(\hat{x}_3)$),
which is what we needed. The inequality~(\ref{teoremaDiv_2}) is proved in the same way.
For inequality~(\ref{teoremaDiv_3})
\begin{IEEEeqnarray*}{rCl}
  (\rku)_3 & = & (\hat{\br}_k(0,0,\hat{u}_3)^t)_3\\
  & = & \sum_{i=3,4\,\hat{\bq}\,\in\,{\color{red}\mathcal{B}_{\hat f_i}}}
  \int\limits_{\hat f_i} \hat{u}_3 \hat{q}_3\,d\hat{\gamma} \,(\hat{\bv}_{\hat{f}_i,\hat{\bq}})_3
    +\sum_{\hat{\br}\,\in\,{\color{red}\mathcal{B}_{\hat E}}}
  \int\limits_{\hat E} \hat{u}_3 \hat{r}_3\,d\hat{\bx}\,(\hat{\bv}_{\hat{\br}})_3.
\end{IEEEeqnarray*}
Then, by standard result for traces in Sobolev spaces,
\begin{IEEEeqnarray*}{rCl}
  \|(\rku)_3\|_{L^\infty(\hat{E})} 
  & \leqslant & c(\hat{E}) \left\{
   \sum_{i=3,4}
     \int\limits_{\hat f_i} |\hat{u}_3|\,d\hat{\gamma}
   + \int\limits_{\hat E} |\hat{u}_3|\,d\hat{\bx}
  \right\}\\
  &\leqslant& c(\hat{E}) (\|\hat{u}_3|_{\partial\hat{E}}\|_{L^1(\partial\hat{E})} + 
    \|\hat{u}_3\|_{L^1(\hat{E})})\\
  &\leqslant& c(\hat{E}) \|\hat{u}_3\|_{W^{1,1}(\hat{E})}
\end{IEEEeqnarray*}
\end{proof}
Theorems~\ref{thm_stab_edge} and~\ref{thm_stab_div} show that the interpolations
determined by the Finite Elements~(\ref{edgeelement}) and~(\ref{defi_h_div_conforme})
are anisotropically stable, in the sense that the image of a field $\hat\bu$ under
the linear operator depends not only continously on $\hat\bu$, but also with a
\emph{componentwise} bound, with perhaps and additional
curl or divergence term, respectively.\\

\noindent Consider again the element $\tilde{E}$ defined in~(\ref{tilde_prism}).
\begin{theorem} \label{thmStabilityKtildeRT}
There is $C > 0$, independent of $h_1$, $h_2$ and $h_3$, s.t. for all $p \geqslant 1$ and 
  $\tilde{\bu}\in W^{1,p}(\tilde{E})$
  \begin{IEEEeqnarray*}{rCl}
    \left\| \rkutilde \right\|_{L^p(\tilde{E})}
    & \leqslant & C \left( \left\| \tilde{\bu} \right\|_{L^p(\tilde{E})}
    + \sum_{i=1}^3 h_i \left\| \frac{\partial\tilde{\bu}}{\partial\tilde{x}_i} \right\|_{L^p(\tilde{E})}
    + \max\{h_1,h_2\}\left\|{\dv}(\tilde{u}_1, \tilde{u}_2, 0) \,\right\|_{L^p(\tilde{E})}\right).
  \end{IEEEeqnarray*}
\end{theorem}

\noindent{\color{BrickRed}\#\#\#\#\#\#\# continue here. Ver si en aadl hacen
estabilidad fisica (creo que si). ver c'omo est'a en lombardi hcurl tetra.} 

\begin{remark}
{\color{red}esto va en el cap. de approx tal vez, decidir, porque esta dos veces
esto mismo.}  When it comes to estimate in terms of the data $f$ we
  will assume $h_3 \geqslant C\max\{h_1,h_2\}$ to be able to do
  \begin{IEEEeqnarray*}{rCl}
    \left\| \rkutilde \right\|_{L^p(\tilde{E})}
    & \leqslant & C \left( \left\| \tilde{\bu} \right\|_{L^p(\tilde{E})}
    + \sum_{i=1}^3 h_i \left\| \frac{\partial\tilde{\bu}}{\partial\tilde{x}_i} \right\|_{L^p(\tilde{E})}
    + \max\{h_1,h_2\}\left\|{\dv}\hat\bu\right\|_{L^p(\tilde{E})}
    + \max\{h_1,h_2\}\left\|\frac{\partial\hat u_3}{\partial\hat x_3}\right\|_{L^p(\tilde{E})}\right).\\[5pt]
    &\leqslant& C \left( \left\| \tilde{\bu} \right\|_{L^p(\tilde{E})}
    + \sum_{i=1}^3 h_i \left\| \frac{\partial\tilde{\bu}}{\partial\tilde{x}_i} \right\|_{L^p(\tilde{E})}
    + \max\{h_1,h_2\}\left\|{\dv}\hat\bu\right\|_{L^p(\tilde{E})}\right).
  \end{IEEEeqnarray*}
  this is not a restriction since we needed the prisms to be 
  elongated exactly along the direction paralell to the cuadrilateral faces.
\end{remark}
\begin{proof}
Pick $p\geqslant 1$. If we pull 
$\tilde{\bu}$ back to $\hat{E}$ we get the relation
\begin{IEEEeqnarray}{rCl}\label{pull1}
  \hat{\bu}(\hat{\bx}) & = & (det\,DF)DF^{-1}\tilde{\bu}(F\hat{\bx})
\end{IEEEeqnarray}
\begin{IEEEeqnarray}{rCl}
  D\hat{\bu}(\hat{\bx}) & = & \diag{h_2\,h_3}{h_1\,h_3}{h_1\,h_2}\cdot
  D\tilde{\bu}(F\hat{\bx})\cdot\diag{h_1}{h_2}{h_3}
\end{IEEEeqnarray}
and by~(\ref{push-forward})
\begin{IEEEeqnarray}{rCl}\label{pull2}
  (\det DF)DF^{-1}\rkutilde(F(\hat{\bx})) & = & \rku(\hat{\bx}).
\end{IEEEeqnarray}
With~(\ref{pull1})~(\ref{pull2}) and 
stability inequality~(\ref{teoremaDiv_1}) 
plus H\"older's inequality we obtain 
\begin{IEEEeqnarray*}{rCl}
  \|(\rkutilde)_1\|_{L^{\infty}(\tilde{E})} & = &
  (h_2\,h_3)^{-1}
  \|(\rku)_1\|_{L^{\infty}(\hat{E})}\\[7pt]
  &\leqslant&(h_2\,h_3)^{-1}\left(\|\hat{u}_1\|_{W^{1,1}(\hat{E})}
  +\|\dvg(\hat{u}_1,\hat{u}_2,0)^t\|_{L^{1}(\hat{E})}\right)\\[7pt]
  &=& 
  (h_2\,h_3)^{-1}
  \left(
    \int\limits_{\hat{E}}\left|\hat{u}_1\right|\,d\hat{\bx}
    +\sum_{i=1}^3\int\limits_{\hat{E}}\left|\frac{\partial\hat{u}_1}{\partial\hat{x}_i}\right|\,d\hat{\bx}
    +\int\limits_{\hat{E}}\left|\frac{\partial\hat{u}_1}{\partial\hat{x}_1} + \frac{\partial\hat{u}_2}{\partial\hat{x}_2}\right|
    \,d\hat{\bx}
  \right)\\[7pt]
  &=&(\det DF)^{-1}\left(
  \int\limits_{\tilde{E}}|\tilde{u}_1|\,d\tilde{\bx}
  +\sum_{i=1}^3h_i\int\limits_{\tilde{E}}|\frac{\partial\tilde{u}_1}{\partial\tilde{x}_i}|\,d\tilde{\textbf{x}}
  +h_1\int\limits_{\tilde{E}}|\frac{\partial\tilde{u}_1}{\partial\tilde{x}_1} + \frac{\partial\tilde{u}_2}{\partial\tilde{x}_2}|
  \,d\tilde{\textbf{x}}\right)\\[7pt]
  &=&(2|\tilde{E}|)^{-1}\left(
  \|\tilde{u}_1\|_{L^1(\tilde{E})}
  +\sum_{i=1}^3h_i\|\frac{\partial\tilde{u}_1}{\partial\tilde{x}_i}\|_{L^1(\tilde{E})}
  +h_1\|\dvg(\tilde{u}_1,\tilde{u}_2,0)\|_{L^1(\tilde{E})}\right)\\[7pt]
  &\leqslant&(2|\tilde{E}|^{\nicefrac{1}{p}})^{-1}\left(
  \|\tilde{u}_1\|_{L^p(\tilde{E})}
  +\sum_{i=1}^3h_i\|\frac{\partial\tilde{u}_1}{\partial\tilde{x}_i}\|_{L^p(\tilde{E})}
  +h_1\|\dvg(\tilde{u}_1,\tilde{u}_2,0)\|_{L^p(\tilde{E})}\right).
\end{IEEEeqnarray*}
Now
\begin{IEEEeqnarray*}{rCl}
  \|(\rkutilde)_1\|_{L^{p}(\tilde{E})}
  &\leqslant&
  |\tilde{E}|^{1/p}\|(\tilde{\br}_k\tilde{\boldsymbol{u}})_1\|_{L^{\infty}(\tilde{E})}\\
  &\lesssim&\|\tilde{u}_1\|_{L^p(\tilde{E})}
  +\sum_{i=1}^3h_i\|\frac{\partial\tilde{u}_1}{\partial\tilde{x}_i}\|_{L^p(\tilde{E})}
  +h_1\|\dvg(\tilde{u}_1,\tilde{u}_2,0)\|_{L^p(\tilde{E})},
\end{IEEEeqnarray*}
and again, the symmetric inequality holds for component $2$. For component $3$,
stability inequality~(\ref{teoremaDiv_3}) gives us
\begin{IEEEeqnarray*}{rCl}
  \|(\rkutilde)_3\|_{L^{\infty}(\tilde{E})} & = &({h_1h_2})^{-1}
  \|(\rku)_3\|_{L^{\infty}(\hat{E})}\\[6pt]
  &\leqslant&{C}({h_1h_2})^{-1}\,\|\hat{u}_3\|_{W^{1,1}(\hat{E})}\\[6pt]
  &=&C\,|\tilde{E}|^{-1}\,\left[\|\tilde{u}_3\|_{L^1(\tilde{E})} +
    \sum_{i=1,2,3} h_i\,\left\|\frac{\partial\tilde{u}_3}{\partial\tilde{x}_i}\right\|_{L^1(\tilde{E})}\right]\\[6pt]
  &\leqslant& {C}\,|\tilde{E}|^{-\nicefrac{1}{p}}\,\left[\|\tilde{u}_3\|_{L^p(\tilde{E})} +
    \sum_{i=1,2,3} h_i\,\left\|\frac{\partial\tilde{u}_3}{\partial\tilde{x}_i}\right\|_{L^p(\tilde{E})}\right]
\end{IEEEeqnarray*}
so, immediately,
\begin{IEEEeqnarray}{rCl} \label{aux_label18}
  \|(\rkutilde)_3\|_{L^{p}(\tilde{E})}
  &\leqslant& C\,\left(
  \|\tilde{u}_3\|_{L^p(\tilde{E})} +
    \sum_{i=1,2,3} h_i\,\left\|\frac{\partial\tilde{u}_3}{\partial\tilde{x}_i}\right\|_{L^p(\tilde{E})}
  \right)
\end{IEEEeqnarray}
and the sum of the three estimates yields the theorem.
\end{proof}
%===============================================================================
% \begin{lemma}\label{L6} Let $P$ be a right prism. There exists a constant $C$ depending only on $\alpha_P$ such that for all $\bu$ in $W^{1,1}(P)$ we have
% \begin{multline}\label{estabL1}
% \|\bu_I\|_{L^1(P)} \leqslant C\Bigg(\|\bu\|_{L^1(P)} + \sum_{i=1}^3 h_{i,P}\|\partial_{\xi_{P,i}}\bu\|_{L^1(P)}\\ + \max\{h_{P,1},h_{P,2}\}\|\mbox{div\,}(u_1,u_2,0)\|_{L^1(P)}\Bigg).
% \end{multline}
% \end{lemma}
% \begin{proof} Using the notation introduced above for the vertices of $P$, suppose that $v_0$ is the vertex with the maximum angle of the triangle $v_0v_1v_2$. Let $\tilde P$ be a prism with vertices at $(0,0,0)$, $(h_{P,1},0,0)$, $(0,h_{P,2},0)$, $(0,0,h_{P,3})$, $(h_{P,1},0,h_{P,3})$ and $(0,h_{P,2},h_{P,3})$. Then by standard rescaling arguments using the Piola Transform we can prove from Lemma \eqref{L5} that there exists a constant $C$ such that for all $\bu\in W^{1,1}(\tilde P)$ we have
% \begin{eqnarray*}
% \|\tilde\bu_I\|_{L^1(\tilde P)}&\le& C\Bigg(\|\tilde\bu\|_{L^1(\tilde P)} + \sum_{i=1}^3h_{P,i}\|\partial_{x_i}\tilde\bu\|_{L^1(\tilde P)}\\&&\qquad + 
% \max\{h_{P,1},h_{P,2}\}\|\dv(\tilde u_1,\tilde u_2,0)\|_{L^1(\tilde P)}\Bigg).
% \end{eqnarray*}
% Let $B$ be the matrix with columns $\xi_{P,1}$, $\xi_{P,2}$ and $\xi_{P,3}$ (note $B$ has the form \eqref{matrix} and $\xi_{P,3}=(0,0,1)$). Then the map $F(\tilde{\bf x})=B\tilde{\bf x}+v_0$ sends $\tilde P$ onto $P$. Then, again by a change of variables, we obtain from the previous estimate, that for all $\bu\in W^{1,1}(P)$ it holds
% \begin{eqnarray*}
% \|\bu_I\|_{L^1(P)}&\le& C\|B\|\|B^{-1}\|\bigg(\|\bu\|_{L^1(P)} + \sum_{i=1}^3h_{P,i}\|\partial_{\xi_{P,i}}\bu\|_{L^1(P)}\\ &&  \qquad +\max\{h_{P,1},h_{P,2}\}\frac1{\|B^{-1}\|}\|\dv(u_1,u_2,0)\|_{L^1(P)}\bigg). 
% \end{eqnarray*}
% Then the proof concludes by noting that $\|B\|\leqslant C$ and $\|B^{-1}\|\sim \sin\alpha_P$.
% \end{proof}
% 
% \begin{remark} Stability estimates in $L^p$-norm, $p>1$, can by proved analogously.
% In particular, from  \eqref{estabL1}, using an inverse inequality on the left hand side, and Cauchy-Schwarz inequality on the right hand side, we obtain under assumptions of Lemma \ref{L6}
% \begin{multline}\label{estabL2}
% \|\bu_I\|_{L^2(P)} \leqslant C\Bigg(\|\bu\|_{L^2(P)} + \sum_{i=1}^3 h_{i,P}\|\partial_{\xi_{P,i}}\bu\|_{L^2(P)}\\ + \max\{h_{P,1},h_{P,2}\}\|\mbox{div\,}(u_1,u_2,0)\|_{L^2(P)}\Bigg)
% \end{multline}
% \end{remark}
%===============================================================================

\begin{corollary} Under assumptions of Lemma \ref{L6}, and if $h_{P,3}\ge \max\{h_{P,1},h_{P,2}\}$ we obtain 
\begin{equation}\label{estabLp}
\|\br_E \bu\|_{L^p(E)} \leqslant \left(\|\bu\|_{L^p(E)} + \sum_{i=1}^3 h_{E,i}\|\partial_{\xi_i} \bu\|_{L^p(E)}+ h_E\|\mbox{div\,}\bu\|_{L^p(E)}\right)
\end{equation}
\end{corollary}
\begin{remark}
{\color{red}esto es del corolario aca arriba}  When it comes to estimate in terms of the data $f$ we
  will assume $h_3 \geqslant C\max\{h_1,h_2\}$ to be able to do
  \begin{IEEEeqnarray*}{rCl}
    \left\| \rkutilde \right\|_{L^p(\tilde{E})}
    & \leqslant & C \left( \left\| \tilde{\bu} \right\|_{L^p(\tilde{E})}
    + \sum_{i=1}^3 h_i \left\| \frac{\partial\tilde{\bu}}{\partial\tilde{x}_i} \right\|_{L^p(\tilde{E})}
    + \max\{h_1,h_2\}\left\|{\dv}\hat\bu\right\|_{L^p(\tilde{E})}
    + \max\{h_1,h_2\}\left\|\frac{\partial\hat u_3}{\partial\hat x_3}\right\|_{L^p(\tilde{E})}\right).\\[5pt]
    &\leqslant& C \left( \left\| \tilde{\bu} \right\|_{L^p(\tilde{E})}
    + \sum_{i=1}^3 h_i \left\| \frac{\partial\tilde{\bu}}{\partial\tilde{x}_i} \right\|_{L^p(\tilde{E})}
    + \max\{h_1,h_2\}\left\|{\dv}\hat\bu\right\|_{L^p(\tilde{E})}\right).
  \end{IEEEeqnarray*}
  this is not a restriction since we needed the prisms to be 
  elongated exactly along the direction paralell to the cuadrilateral faces.
\end{remark}



\subsection{Local Interpolation Estimates for Prismatic Elements} % (fold)
\label{sub:local_interpolation_estimates_for_prismatic_elements}

For the following paragraph we refer to the exposition in pages $25$--$26$
of~\cite{ariel}, in which the author
state the forthcoming facts for tetrahedra. We will state scaling consequences
of inequalities~(\ref{aux_label19}). For a non--negative integer
$m$ let $\partial^m f$ denote
the sum of the absolute values of all the derivatives of order $m$ of $f$.
\begin{lemma}\label{aux_label20}
Let $E$ be a prism such that (\noindent{\color{BrickRed}hip. prisma}).
Let $\xi_i$, $1\leqslant i \leqslant 3$ be unitary vectors with the directions
of the three edges sharing a vertex $\bx_E$ of $E$, whose lengths are
$h_i$, $1\leqslant i\leqslant 3$. Given $p\geqslant 1$, $m\geqslant 0$ and
$\bu \in W_{m+1,p}$ there exists a vector polynomial $\bq\in P_m(E)^3$ such that 
\begin{IEEEeqnarray}{rCl}\label{aux_label22}
  \left\|\frac{\partial}{\partial \xi_i}(\bu-\bq)\right\|_{L^p(E)}
  &\leqslant&C\sum_{|\alpha| = m} \boldsymbol{h}^\alpha 
  \left\|\frac{\partial}{\partial\xi_i} (\partial^{\alpha}\bu) \right\|_{L^p(E)}
\end{IEEEeqnarray} 
and 
\begin{IEEEeqnarray}{rCl}\label{aux_label23}
  \|\dv(\bu-\bq)\|_{L^p(E)}&\leqslant&Ch_E^m\|\partial^m\dv\bu\|_{L^p(E)}
\end{IEEEeqnarray}
where $C$ depends only on $m$ and \noindent{\color{BrickRed} ????}.

If $m \geqslant 1$ and $p \geqslant 1$
\begin{IEEEeqnarray}{rCl}
  \label{aux_label24}
  \|\curl(\tilde\bu-\tilde\bq)\|_{L^1(\tilde E)}&\leqslant&
  C|E|^{1-\nicefrac1p}\,h^m
  \|\partial^m\curl\tilde\bu\|_{L^p(\tilde E)}\\[5pt]
  \label{aux_label25}
  \|\frac{\partial}{\partial_{\tilde x_i}}\curl(\tilde\bu-\tilde\bq)\|_{L^1(\tilde E)}&\leqslant&
  C|E|^{1-\nicefrac1p}\,h^{m-1}
  \|\partial^m\curl\tilde\bu\|_{L^p(\tilde E)}
\end{IEEEeqnarray}
where C depends only on $m$, $\sigma$ (cfr. Theorem~\ref{aux_label21})
and the reference element.
\end{lemma}




one of the main results in this thesis
Sean un prisma obl\'{\i}cuo irregular $K$, $k\in\mathbb{N}$, el operador de interpolaci\'on 
$\bw_E$ de grado $k$ determinado por el elemento en la Definición~(\ref{edgeelement}), y $p>2$.

\begin{theorem}
Existe $C > 0$ independiente de $E$ tal que para todo campo $\bu\in W^{m + 1,p}(E)$
con $\bcurl \bu\in W^{m,p}(E)$ y $m\leqslant k-1$, 
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bw_E \bu\|_{L^p(E)} & \leqslant & C
  \left(
    \sum_{|\alpha|=m+1}\boldsymbol{h}^\alpha \|\partial^\alpha \bu\|_{L^p(E)} +
    h_E^{m+1}\|\partial^m \bcurl \bu\|_{L^p(E)}
  \right).
\end{IEEEeqnarray*} 
\end{theorem}

\begin{proof}

{\color{blue}\#\#\#\#\#\#\#\# continue here.} 
  ~(\ref{aux_label24})

  ~(\ref{aux_label25})








\end{proof}


{\color{BrickRed}
Take a kernel $\hat{\phi}\in\mathcal{C}_0^\infty(\mathbb{R}^n)$ such that
\begin{IEEEeqnarray*}{rCl}
  \supp{\hat{\phi}}&\subseteq&\hat{B}\\[5pt]
  \int\limits_{\hat{B}} \hat{\phi}\,d\textbf{x} & = & 1
\end{IEEEeqnarray*} 
Now define the kernel on B
\begin{IEEEeqnarray*}{rCl}
  \phi_B&=&\frac{|\hat{B}|}{|B|}\,\hat{\phi}\circ F^{-1}\\[5pt]
  &=&\frac{1}{\det DF}\,\hat{\phi}\circ F^{-1}
\end{IEEEeqnarray*}
This way we have
\begin{IEEEeqnarray*}{rClCr}
  \int\limits_{B}\phi\,d\textbf{x}&=&
  \int\limits_{\hat{B}}\hat{\phi}\,\,d\hat{\textbf{x}}&=&1\\[5pt]
\end{IEEEeqnarray*}
and also
\begin{IEEEeqnarray*}{rClClCr}
  \supp{\phi_B}&=&\supp{\hat{\phi}\circ F^{-1}}
  &=&F(\supp{\hat{\phi}})&=&B.
\end{IEEEeqnarray*}
Then we build an averaged Taylor polynomial over $B$ with the kernel
$\phi_B$ and it holds that
\begin{IEEEeqnarray*}{rCl}
  \hat{Q}^m(\hat{w})&=&(Q^mw)^{\hat{}}\\[5pt]
\end{IEEEeqnarray*}
where 
\begin{IEEEeqnarray*}{rCl}
  \hat{Q}&=&\text{avg. Taylor polyn. over }\hat{B}\text{ with kernel }\hat{\phi}\\[5pt]
  {Q}&=&\text{avg. Taylor polyn. over }{B}\text{ with kernel }{\phi_B}
\end{IEEEeqnarray*}
}











%%==============================================================================
% \begin{theorem}\label{thmErrorInterpolacionPrismas}
% Let $P$ be a right prism, and consider a local system of coordinates $x_1x_2x_3$
% such that the triangular basis of $P$ are parallel to the $x_1x_2$-coordinate
% plane. Denote by $\xi_{P,1}$ and $\xi_{P,2}$ the versors parallel to the edges
% of the triangular basis of $P$ adjacent to its maximum angle
% $\alpha_P$, $\xi_{P,3}=(0,0,1)$ and $h_{P,i}$ are the lengths of the edges of
% $P$ parallel to $\xi_{P,i}$. We assume that $h_{P,3}>ch_{P,1}$ and
% $h_{P,3}>ch_{P,2}$. Then, there exists a constant $C$ depending only on $c$
% and $\alpha_P$, such that for all $\bu\in H^1(P)$ we have
% \begin{equation}\label{interp}
% \|\bu-\boldsymbol{r}_E\bu\|_{L^2(E)} \leqslant C\left(\sum_{i=1}^3 h_{E,i}
% \|\partial_{\xi_{E,i}}\bu\|_{L^2(E)} + h_T\|\dv\bu\|_{L^2(E)}\right).
% \end{equation}
% \end{theorem}
%%==============================================================================

% subsection local_interpolation_estimates_for_prismatic_elements (end)
% section prismatic_finite_elements (end)