\chapter{Approximation}
\section{Discrete Well posedness} % (fold)
\label{sec:well_posedness}
If we consider the following kernel
\begin{IEEEeqnarray*}{rCl}
  \mathcal K_h & = & \{\bv_h\in V_h: b(\bv_h,q)=0\,\,
                        \mbox{for all } q\in Q_h\} \\[4pt]
               & = & V_{\textit{h}}\cap\ker\dv
\end{IEEEeqnarray*}
then Lemma~\ref{lemma_for_coercivity} implies the following Proposition.
\begin{proposition}
  $a_h$ is coercive over $\mathcal K_h$ and the coercivity constant
  depends only on the shape regularity of the pyramids of the mesh.
\end{proposition}
\begin{proposition} \label{cont} The local discrete bilinear form $a_h^E$ is continuous en $L^2(E)$, that is,
\[
a_h^E(\bu,\bv)\leqslant C \|\bu\|_{L^2(E)}\|\bv\|_{L^2(E)}, \qquad \forall \bu,\bv\in V_h(E),
\]
where $C$ equals $1$ when $E$ is a right prism or tetrahedron, and depends only on the aspect ratio of $E$ in the case of pyramids.
\end{proposition}
\begin{proof}
When $E$ is a prism or tetrahedron, $a_h^E(\bu,\bv)=a^E(\bu,\bv)$ for $\bu$ and $\bv$ in $V_h(E)$, and the result is clear from the definition of $a^E$. When $E$ is a pyramid, we observe that $a_h^E$ is symmetric and coercive in $L^2(E)$ because of \eqref{L2}, and then it defines an inner product. Hence, from Cauchy-Schwarz inequality and again \eqref{L2} we have
\begin{multline*}
\left|a_h^E(\bu,\bv)\right|\leqslant a_h^E(\bu,\bu)^\frac12 a_h^E(\bv,\bv)^\frac12 \le\\ C_E a^E(\bu,\bu)^\frac12 a^E(\bv,\bv)^\frac12 \leqslant C_E\|\bu\|_{L^2(E)}\|\bv\|_{L^2(E)}.
\end{multline*}
The constant $C_E$ depends on the aspect ratio of $E$. This concludes the proof.
\end{proof}
\begin{lemma} \label{lemma_inf_sup_bh} There exists a constant
$\beta^*>0$ depending only on $\Omega$ {\color{brown} and the maximum aspect
ratio of the pyramids of $\Th$ (is this necessary?)}
such that for all $q^*\in Q_h$ there exists $\bw_h^*\in V_h$ such
that
\[
\dv\bw_h^*=q^* \mbox{\quad and\quad} \beta^*\|\bw_h^*\|_{Q}\leqslant\|q^*\|_{Q}.
\]
\end{lemma}
\begin{proof} Start considering the infinite dimensional version
of the statement. There is, in fact, a constant $\beta^*$ depending only on
$\Omega$ such that
for every $q^*\in Q_h \subseteq Q$ there exists 
$\bw^*\in H^1_0(\Omega)^3$ with $\dv\bw^*=q^*$ such that
\begin{IEEEeqnarray}{rCl} \label{bound_w}
  \beta^*\|\bw^*\|_{H^1(\Omega)} & \leqslant &
  \|q^*\|_{Q}.
\end{IEEEeqnarray}
Now, for each $q^*\in Q_h$ take $\bw_h^*$ such that,
in every $E\in\Th$, $\bw_h^*|_E := I(\bw^*|_E)$, as defined in
Corollary~\ref{interpolant}. As a consequence of Proposition~\ref{vem_equal_fem}
and because we are considering the exact same degrees of freedom, this
interpolation operator coincides, in the lowest order case, with the
$H(\dv)$--conforming operators~(\ref{sub:definition_of_the_h_div_element_on_prisms})
on prisms and~(\ref{sub:definition_of_the_h_div_element_on_tetrahedra}) on tetrahedra,
respectively. For prismatic elements we use the estimate in~(\ref{estabLp}), which is the 
analog of the statement in Theorem $3.1$ in page $149$ of~\cite{aadl}.
In the case of a pyramidal element we draw upon estimate~(\ref{estab2}). With
all these together and~(\ref{bound_w}) for all cases we get
\[
  \|\bw_{\textit{h}}^*\|_{Q} =
  \|I\bw^*\|_{Q}\leqslant
  C(1+\textit{h})\|\bw^*\|_{H^1(\Omega)}
  \leqslant\frac{C(1+\textit{h})}{\beta^*}\|q^*\|_{Q}.
\]
Besides, since $q^*\in Q_h$, by~(\ref{p0_projection}) we have
\[
  \dv I\bw^*=P_0\,\dv\bw^*=P_0\,q^*=q^*.
\]
\end{proof}
Now we can prove the discrete inf-sup condition. 
\begin{theorem}[Discrete $\inf-\sup$ condition for $b_h$] \label{inf_sup_b_h}
There exists $\beta > 0$ such that for all $q^*\in Q_h$ 
\begin{IEEEeqnarray}{rCl}\label{discrete_inf_sup_b} 
  \sup_{0\ne\bv\in V_h} \frac{b_h(\bv,q^*)}{\|\bv\|_{V_h}} &\geqslant& \beta\|q^*\|_{Q_h}.
\end{IEEEeqnarray}
\end{theorem}
\begin{proof} By Lemma~\ref{lemma_inf_sup_bh} for $q^*\in Q_h$
there exists $\bw_h^*\in V_h$ such that $\dv\bw_h^*=q^*$ and
$\beta^*\|\bw_h^*\|_{L^2(\Omega)}\leqslant\|q^*\|_{Q_h}$ (the constant $\beta^*$
is independent of $q^*$). Then
\begin{IEEEeqnarray*}{rcCcl}
  \|\bw_h^*\|_{V_h}^2 \, & \, = \, & \, \|\bw_h^*\|_{L^2(\Omega)}^2 + \|q^*\|_{Q_h}^2 
    \, & \,\leqslant\, & \, \left(\frac1{(\beta^*)^2}+1\right) \|q^*\|_{Q_h}^2
\end{IEEEeqnarray*}
and
\begin{IEEEeqnarray*}{rcCcl}
\sup_{0\ne\bv\in V_h} \frac{b_h(\bv,q^*)}{\|\bv\|_{V_h}}
      \,&\,\geqslant\,&\,
\frac{b_h(\bw_h^*,q^*)}{\|\bw_h^*\|_{V_h}}
      \,&\,\geqslant\,&\,
\frac1{\sqrt{\dfrac1{(\beta^*)^2}+1}}\,\|q^*\|_{Q_h}.
\end{IEEEeqnarray*}
\end{proof}
\begin{theorem} Problem~(\ref{mixedDiscrete}) has a unique solution
\end{theorem}
\begin{proof}
  Theorem 5.2 of~\ref{ricardoMixed} states that 
  Problem~(\ref{mixedDiscrete}) has a unique solution
  provided~(\ref{discrete_inf_sup_b})  holds and 
  that there exists some $\alpha>0$ such that for all $\bu\in\mathcal{K}_{\textit{h}}$
\begin{IEEEeqnarray*}{rCl}\label{discrete_inf_sup_a} 
  \sup_{0\ne\bv\in \mathcal{K}_{\textit{h}}}
  \frac{a_{\textit{h}}(\bu,\bv)}{\|\bv\|_{V_h}} &\geqslant& \alpha\|\bu\|_{V_h}
\end{IEEEeqnarray*}
  but this is implied by the coercivity of $a_{\textit{h}}$
since
\begin{IEEEeqnarray*}{rCcCl}
  \sup_{0\ne\bv\in \mathcal{K}_{\textit{h}}}
  \frac{a_{\textit{h}}(\bu,\bv)}{\|\bv\|_{V_h}}
  & \geqslant &
  \frac{a_{\textit{h}}(\bu,\bu)}{\|\bu\|_{V_h}}
  & \geqslant & c\|\bu\|_{V_h}.
\end{IEEEeqnarray*}
\end{proof}
% section well_posedness (end)
\section{convex Case} % (fold)
\label{sec:convex Case}

\begin{theorem} solution $(\bu_{\textit{h}},p_{\textit{h}})$
to~(\ref{mixedDiscrete}) satisfies,
for every approximation $\pi(\bu)$ of $\bu$ in
$W(\mathcal{T}_{\textit{h}})$,
  \begin{IEEEeqnarray*}{rCl}
    \|\bu-\bu_h\|_{L^2(\Omega)^3} &\leqslant& C\{\|\bu-I(\bu)\|_{L^2(\Omega)^3} + \|\bu-\pi(\bu)\|_{L^2(\Omega)^3}\} \\[5pt]
    \|P_{0,{\tau_{\textit{h}}}}p-p_h\|_{L^2(\Omega )} &\leqslant& C\{\|\bu-\bu_h\|_{L^2(\Omega)^3} + \|\bu-\pi(\bu)\|_{L^2(\Omega)^3}\}\\[5pt]
    &{\color{red}\uparrow}&\\[5pt]
        \IEEEeqnarraymulticol{3}{c}{\mbox{{\color{red} tal vez ac\'a no va como lemma 3.9 de ricardo mixed porque no tengo la propiedad}}}\\
        \IEEEeqnarraymulticol{3}{c}{\mbox{{\color{red}div(Vh) = PPk}}}
  \end{IEEEeqnarray*} 
\end{theorem}
\begin{proof}
\end{proof}

{\color{brown}
esta version de intercalado se usa?? Dur\'an Mixed lemma 3.9 es la segunda de estas
\begin{proof}
\begin{IEEEeqnarray*}{lCl}
  \|\boldsymbol{u} - \boldsymbol{u}_{\textit{h}}\|_{L^2(\Omega)^3}
  &\leqslant& 
  C\,\inf_{v\in\mathbb{V}_h}\|\boldsymbol{u} - \textbf{v}\|_{\mathbb{V}}\\[7pt]
  &\leqslant& 
  C\,\|\boldsymbol{u} - \pi\boldsymbol{u}\|_{\mathbb{V}}\\[10pt]
  \|p-p_{\textit{h}}\|_{\mathbb{Q}}&\leqslant&
  C\,[\|\boldsymbol{u} - \pi\boldsymbol{u}\|_{L2(\Omega)}+\|p - \pi_{\textit{h}}^{\bot} p \|_{\mathbb{Q}}].
\end{IEEEeqnarray*}
\end{proof}

}

If $\Omega$ were convex and $f\in L^2(\Omega)$ we know that the solution $p$ of
problem $H^2(\Omega)$, and so $\bu\in H^1(\Omega)^3$. In this case, using the 
interpolation error estimates we proved in Propositions 
\ref{propErrorInterpolacionPrismas} and 
\eqref{propErrorInterpolacionPiramidesTetraedros}, the result of 
Proposition \ref{propupi}, and a standard estimate for $L^2$-projection error, 
we obtain from Theorem \ref{estimacionError} the following Corollary.

\begin{corollary}
\begin{eqnarray*}
\|\bu-\bu_h\|_{L^2(\Omega)}&\leqslant& C\textit{h}|p|_{H^2(\Omega)}\\ 
\|p-p_h\|_{L^2(\Omega)}&\leqslant& C\textit{h}|p|_{H^1(\Omega)}
\end{eqnarray*}
where the constant $C$ depends only on the aspect ratios of tetrahedra 
and pyramids and the triangular bases of the right prisms on the mesh. 
\end{corollary}

Arbitrarily narrow right prisms can be used in the mesh without 
affecting this estimate. This fact can be further exploited when the
domain $\Omega$ is not convex or $f$ is not in $L^2(\Omega)$. This is what follows!

\section{non--convex case}
\label{sec:non_convex_case}

\begin{theorem}

{\color{BrickRed} poner esto en la intro como objetivo de todo el texto que sigue y
el enunciado este, entero, ponerlo al final, en donde digo lo de la $\bw_{\bu}$ \\

no, ojo que las mallas las estoy queriendo poner antes ... pensarlo}

There exists a family of anisotropic graded meshes
$\{\mathcal{T}_{\textit{h}}\}_{{\textit{h}}\downarrow 0}\,$
made up of
Prisms, tetrahedra and pyramids 
for which 
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bu_{\textit{h}}\|_{0,\Omega}&\leqslant &C {\textit{h}} \|f\|_{0,\Omega}\\[5pt]
  \|p-p_{\textit{h}}\|_{0,\Omega}&\leqslant &C \textit{h} \|f\|_{0,\Omega}
\end{IEEEeqnarray*}
whith $\textit{h}$ being smaller than  $C N^{\nicefrac{-1}{3}}$, where
$N = N_{\textit{h}}$ is the  number of elements in $\mathcal{T}_{\textit{h}}$.
\end{theorem}
%%=========== GRADING ==============================================
\begin{IEEEeqnarray*}{lCl}
  h_1, h_2 &\sim&
    \begin{cases}
      \textit{h}^{\frac{1}{\mu}}  & \text{ if\, }d(K,e)=0\\
      \textit{h}\,d(K,e)^{1-\mu}  & \text{ if\, }0<d(K,e)\lesssim1\\
      \textit{h}          & \text{ if\, }d(K,e)\sim1
    \end{cases}\\[5pt]
  h_3   &\sim& 
    \begin{cases}
      \textit{h}^{\frac{1}{\nu}}  & \text{ if\, }d(K,v)=0\\
      \textit{h}\,d(K,v)^{1-\nu}  & \text{ if\, }0<d(K,v)\lesssim1\\
      \textit{h}          & \text{ if\, }d(K,v)\sim1
    \end{cases}
\end{IEEEeqnarray*}
%%==================================================================
{\color{violet} $\mu \sim 1 - \delta$},\\
{\color{violet} $\nu \sim 1 - \beta$}\\
\textbf{Obs}: si $\delta(\Lambda)>1$ entonces
\[
  R_K(\textbf{x}) \leqslant \delta(\Lambda)\min\{ R_K(\textbf{x}), 1\}
\]
as\'i que asumimos $R_K(\textbf{x})\leqslant 1$.\\[7pt]
\textbf{Obs}: $\mu < 1 \Rightarrow \mu \leqslant \nu$. \\[7pt]

\subsection{Meshes}\label{meshes}
\noindent{\color{BrickRed}*** ver si las mallas hacen falta antes del caso convexo;
ver si hace falta llegar hasta subsubseccion} 
\subsubsection{Macro--element with singular edge and vertex}\label{caso4}
Let $T$ be a tetrahedral macro--element with vertices $P_0, P_1, P_2$ and $P_3$. We suppose that $P_0$ is the singular vertex and that the
singular edge is $P_0P_1$. The mesh $\mathcal T_h$ on $T$ will contain tetrahedra, prisms and pyramids. 
In Tables~\ref{prisms_barycentric_a}--\ref{tetrahedral_barycentric}
we explicit the elements in terms
of the barycentric coordinates of the vertices of each element corresponding to the ordered vertices $P_0, P_1, P_2$ and $P_3$.
\bigskip

\prismsBaryCoordA

\prismsBaryCoordB

\pyramidsBaryCoord

\tetrahedraBaryCoord

\subsubsection{Macro--element with a singular edge}
This case corresponds to the prismatic macro--element.
A mesh is constructed as the cartesian product between a graded mesh
in a triangle and a quasi--uniform mesh along the singular edge. Table~\ref{prisms_product}
shows the points
For $0\leqslant i\leqslant n$ and $0\leqslant j\leqslant n-1$ let $p_{i,j}$
be the point with barycentric coordinates, with respect to $P_0,P_1,P_2$,
equal to      
\begin{eqnarray*}
&&\lambda_0(i,j)=1-\lambda_1(i,j)-\lambda_2(i,j),\\[5pt]
&&\lambda_1(i,j)=\frac in\left(\frac{i+j}n\right)^{\gamma-1},\quad
  \lambda_2(i,j)=\frac jn\left(\frac{i+j}n\right)^{\gamma-1},\quad
\end{eqnarray*}
Now let $\Tb$ the family of triangles with vertices  {\color{BrickRed}( controlar )}
\begin{IEEEeqnarray*}{lllCLL}
p_{i,j} & p_{i+1,j} & p_{i,j+1} & \quad & 0\leqslant i  < n\mbox{,\quad}&0\leqslant j < n - i\\
p_{i,j} & p_{i+1,j-1} & p_{i+1,j} & \quad & 0\leqslant i  < n-1\mbox{,\quad}&1\leqslant j < n - i.
\end{IEEEeqnarray*}
The elements in $\Lambda_\ell$ will be
$\tau\times (P_{0,3} + \frac kn h_{\Lambda_\ell,3}, P_{0,3} + \frac{k+1}{n} h_{\Lambda_\ell,3})$
for each $\tau\in\Tb$ and each $0\leqslant k<n$. See Figure~\ref{prismatic_macroelements}.
%borrar ---->>>  \prismsProductCoord

\def\col{black}
\def\height{0}
\def\twoPi{360}
\begin{figure}[!h]\centering
  \subfloat
  {
    \begin{tikzpicture}[scale=2]
      \prismaticMacroelement{8}{2}{.63}{4}{\col}
    \end{tikzpicture}\hspace{1cm}
    \begin{tikzpicture}[scale=2]
      \prismaticMacroelement{8}{3}{.63}{4}{\col}
      \draw[red] (0,0,0) -- (0,-1.5,0);
    \end{tikzpicture}\hspace{1cm}
    \begin{tikzpicture}[scale=2]
      \prismaticMacroelement{8}{4}{.63}{4}{\col}
      \draw[red] (0,0,0) -- (0,-1.5,0);
    \end{tikzpicture}
  }
  \caption{Elements of the family of
    meshes restricted to a prismatic macro--element.$\mu = .63$}
  \label{prismatic_macroelements}
\end{figure}

\subsubsection{Macro--element with a singular vertex}

We consider again a tetrahedral macro--element $T$ with vertices $P_0, P_1, P_2$
and $P_3$, assuming that it has a singular vertex at $P_0$ and no singular edge.
We construct a triangulation of $T$ made of tetrahedra describing 
the barycentric coordinates of the vertices of each tetrahedron with respect
to $P_0, P_1, P_2$ and $P_3$. This case corresponds to Case 1 of \cite{AN}.

Let $p_{i,j,k}$ be the points with barycentric coordinates
\begin{eqnarray*}
&&\lambda_0=1-\lambda_1-\lambda_2-\lambda_3,\\[5pt]
&&\lambda_1=\frac in\left(\frac{i+j+k}n\right)^{\gamma-1},\quad
  \lambda_2=\frac jn\left(\frac{i+j+k}n\right)^{\gamma-1},\quad
  \lambda_3=\frac kn\left(\frac{i+j+k}n\right)^{\gamma-1},
\\[5pt] &&0\le i\le n, 0\le j\le n-i, 0\le k\le n-i-j.
\end{eqnarray*}
Then, the tetrahedra are the ones with vertices
\begin{eqnarray*}
&& p_{i,j,k}, p_{i+1,j,k}, p_{i,j+1,k}, p_{i,j,k+1}, \qquad 0\le i+j+k\le n-1\\
&& p_{i+1,j,k}, p_{i,j+1,k}, p_{i,j,k+1}, p_{i+1,j,k+1}, \qquad 0\le i+j+k\le n-2\\
&& p_{i,j+1,k}, p_{i,j,k+1}, p_{i+1,j,k+1}, p_{i,j+1,k+1}, \qquad 0\le i+j+k\le n-2\\
&& p_{i+1,j,k}, p_{i,j+1,k}, p_{i+1,j+1,k}, p_{i+1,j,k+1}, \qquad 0\le i+j+k\le n-2\\
&& p_{i,j+1,k}, p_{i+1,j+1,k}, p_{i+1,j,k+1}, p_{i,j+1,k+1}, \qquad 0\le i+j+k\le n-2\\
&& p_{i+1,j+1,k}, p_{i+1,j,k+1}, p_{i,j+1,k+1}, p_{i+1,j+1,k+1}, \qquad 0\le i+j+k\le n-3
\end{eqnarray*}


\begin{proposition} Pyramids and tetrahedra are isotropic.
\end{proposition}
\begin{proof} We deal firstly with pyramids. Consider a pyramid with vertices $p_0, \ldots, p_4$ in a macro--element of vertices $P_0,P_1,P_2$ and $P_3$ as in Subsection \ref{caso4}. Note that the basis of the pyramid is the paralelogram $p_0p_1p_3p_2$ with
\begin{eqnarray}\label{once}
&&p_1-p_0=p_3-p_2=\frac1n\left(\frac{n-l-1}n\right)^{\gamma-1}(P_3-P_2)\\\label{doce} &&p_2-p_0=p_3-p_1=\left[\left(\frac{n-l}n\right)^\gamma-\left(\frac{n-l-1}n\right)^\gamma\right](P_0-P_1).
\end{eqnarray}
So 
\[
\frac{\gamma}{n}\left(\frac{n-l-1}n\right)^{\gamma-1}|P_0-P_1|\le |p_2-p_0|=|p_3-p_1|\le \frac{\gamma}{n}\left(\frac{n-l}n\right)^{\gamma-1}|P_0-P_1|,
\]
and 
\[
\frac1\gamma\left(\frac12\right)^{\gamma-1}\le\frac1\gamma\left(\frac{n-l-1}{n-l}\right)^{\gamma-1}\le\frac{|p_1-p_0|}{|p_2-p_0|}\le \frac1\gamma.
\]
Then the parallelogram $p_0p_1p_3p_2$ is shape-regular since the angle between $P_0-P_1$ and $P_3-P_2$ depends only on the macro--element, and so it is away from $0$ and $\pi$. 

Now we prove that there exists constants $c_0$ and $c_1$ depending only on $\gamma$ and the macro--element's vertices such that
\begin{eqnarray}\label{diez}
&c_0\le\frac{|p_4-p_2|}{|p_2-p_0|}\le c_1&\\ \label{trece}
&c_0\le\frac{|p_4-p_3|}{|p_2-p_0|}\le c_1&.
\end{eqnarray}
After simple computations we obtain
\begin{eqnarray*}
p_4-p_2 &=& \left[\left(\frac{n-l}n\right)^\gamma - \left(\frac{n-l-1}n\right)^\gamma\right](P_3-P_0) \\ &&\qquad + \frac in \left[\left(\frac{n-l}n\right)^{\gamma-1} - \left(\frac{n-l-1}n\right)^{\gamma-1}\right](P_2-P_3)\\ &=& \left[\left(\frac{n-l}n\right)^\gamma - \left(\frac{n-l-1}n\right)^\gamma\right]\bigg\{P_3-P_0 +\\ &&\qquad + \frac{\frac in \left[\left(\frac{n-l}n\right)^{\gamma-1} - \left(\frac{n-l-1}n\right)^{\gamma-1}\right]}{\left[\left(\frac{n-l}n\right)^\gamma - \left(\frac{n-l-1}n\right)^\gamma\right]} (P_2-P_3)\bigg\}\\ &\sim& \left[\left(\frac{n-l}n\right)^\gamma - \left(\frac{n-l-1}n\right)^\gamma\right](P_3-P_0)\\ &\sim& p_3-p_1
\end{eqnarray*}
where we used that 
\[
\frac{\frac in \left[\left(\frac{n-l}n\right)^{\gamma-1} - \left(\frac{n-l-1}n\right)^{\gamma-1}\right]}{\left[\left(\frac{n-l}n\right)^\gamma - \left(\frac{n-l-1}n\right)^\gamma\right]}\le \frac{\gamma-1}{\gamma},
\]
that the angle between $P_3-P_0$ and $P_2-P_3$ is fixed (and depends only on the macro--element) and equation \eqref{doce}. This prove \eqref{diez}, and \eqref{trece} follows analogously. In order to prove that the pyramid is isotropic now we have to note that the basis $p_0p_1p_3p_2$ is contained in a plane parallel to the one generated by the vectors $P_1-P_0$ and $P_3-P_2$, and the face $p_2p_3p_4$ is in a plane parallel to the plane (macro--element's face) $P_0P_2P_3$, and the angle between those planes depends only on the macro--element.      


COMPLETAR PRUEBA PARA LOS TETRAEDROS
\end{proof}



Another way, less formal but clearer, to look
at the  mesh points in a tetrahedral macro--element
with both kinds of singularities is the following.

Fijamos:
\begin{IEEEeqnarray*}{rCl}
  T &=& \left[\textbf{p}_0,\textbf{p}_1,\textbf{p}_2,\textbf{p}_3\right]\\[7pt]
  \textbf{p}_0 &=& 0\\[7pt]
  \left[\textbf{p}_0,\textbf{p}_3\right] &=& 
  \text{la arista singular}\\[7pt]
  \textbf{p}_3 & = & \text{v\'ertice singular}\\[7pt]
  \left[\textbf{p}_0, \textbf{p}_1, 
  \textbf{p}_2\right]&\subseteq&\{z=0\}.
\end{IEEEeqnarray*}
  
$\lambda_0,\lambda_1$ y $\lambda_2$: {\color{RedOrange}coordenadas  baric\'entricas} con respecto a
$\textbf{p}_0,\textbf{p}_1$ y $\textbf{p}_2$.\\[10pt]
$\textbf{p}_{i,j}$ es tal que\\[5pt]
\begin{IEEEeqnarray*}{rCl}
  \lambda_0(\textbf{p}_{i,j})  &=& 1-\lambda_1(\textbf{p}_{i,j}) - \lambda_2(\textbf{p}_{i,j}) \\[5pt]
  \lambda_1(\textbf{p}_{i,j})  &=& \frac{i}{n}\left(\frac{i+j}{n}\right)^{\frac{1}{\mu}-1}\\[5pt]
  \lambda_2(\textbf{p}_{i,j})  &=& \frac{j}{n}\left(\frac{i+j}{n}\right)^{\frac{1}{\mu}-1}.\\[15pt]
  &&0\leqslant i\leqslant n\\[5pt]
  &&0\leqslant j\leqslant n-i
\end{IEEEeqnarray*}
  
Los puntos son la uni\'on de\\[5pt]
\begin{IEEEeqnarray*}{lCl}
  \left\{ \textbf{p}_{i,j}\,:\,0\leqslant i\leqslant n,\quad
    0\leqslant j\leqslant n-i \right\}&&\\[7pt]
  \left\{ \textbf{p}_{i,j}\,:\,0\leqslant i\leqslant n-1,\quad
  0\leqslant j\leqslant n-1-i \right\} & \quad+\quad & 
  [{\scriptstyle 1-\left(\frac{n-1}{n}\right)^{1/\mu}}]\,\textbf{e}_3\\[7pt]
  \IEEEeqnarraymulticol{3}{c}{\vdots}\\[7pt]
  \left\{\textbf{p}_{i,j}\,:\,0\leqslant i\leqslant n-k,\quad
  0\leqslant j\leqslant n-k-i \right\} & \quad+\quad &
  [{\scriptstyle 1-\left(\frac{n-k}{n}\right)^{1/\mu}}]\,\textbf{e}_3\\[7pt]
  \IEEEeqnarraymulticol{3}{c}{\vdots}\\[7pt]
  \left\{ \textbf{p}_{i,j}\,:\,0\leqslant i\leqslant 1,\quad
  0\leqslant j\leqslant 1-i \right\} & \quad+\quad &
  [{\scriptstyle 1-\left(\frac{1}{n}\right)^{1/\mu}}]\,\textbf{e}_3\\[10pt]
  \IEEEeqnarraymulticol{3}{l}{\left\{\textbf{e}_3\right\}}\text{,}
\end{IEEEeqnarray*}
i.e.:
\begin{IEEEeqnarray*}{rCl}
  \mathcal{P} & = & \bigcup_{k=0}^n\;\left\{ \textbf{p}_{i,j}\,:\,0\leqslant i\leqslant n - k,\quad
  0\leqslant j\leqslant n-k-i \right\}\\[8pt]
  &&\quad+\,[{\scriptstyle1-\left(\frac{n-k}{n}\right)^{1/\mu}}]\,\textbf{e}_3.
\end{IEEEeqnarray*}

\section{main global interpolation error theorem}
Given a positive parameter $\textit{h}\downarrow 0$ and the mesh $\Th$ of
Subsection~\ref{meshes} let $\rZerou$  be the \emph{global interpolation operator}
\begin{IEEEeqnarray}{rCl}\label{global_interpolator}
  \rZerou & : & W^{1,1}(\Omega) \to V_{\textit{h}}
\end{IEEEeqnarray}
such that, for each $\{\overline{E}:E\in\Th\}$,
\begin{equation*}
  (\rZerou)|_{E} = 
    \left\{
    \begin{array}{rll}
      \boldsymbol{r}_E\,[\bu|_E] & \mbox{\,as in Definition~\ref{defi_face_element}} & \mbox{if $E$ is a prism}\\[5pt]
                         I\bu    & \mbox{\,as in Corollary~\ref{interpolant}} & \mbox{if $E$ is a pyramid}\\[5pt]
      \boldsymbol{r}_E\,[\bu|_E] & \mbox{\,as in Definition~\ref{defi_face_element_tetra}} & \mbox{if $E$ is a tetrahedron,}
    \end{array}
    \right.
\end{equation*}
in all cases with the lowest interpolation degree $k=0$ and
with consistent normal components for interelementary faces.
The following is the main interpolation error theorem.
\begin{theorem}\label{interpolation_theorem} Let $\Omega$ and $f$ be the data and $(\bu,p)$ be the 
solution
of Problem~\ref{weakMixedContinuous}. Let  $\boldsymbol{r}_0$ be the operator~(\ref{global_interpolator}), then
  \begin{IEEEeqnarray*}{rCl}
    \|\bu-\rZerou\|_{0,\Omega} &\leqslant& C \textit{h}\|f\|_{0,\Omega}\\[5pt]
    \|p-P_{\scriptscriptstyle \Th}p\|_{0,\Omega} &\leqslant& 
    \mbox{>}C \textit{h}\|f\|_{0,\Omega}\mbox{ o bien }C \textit{h}\|p\|_{1,\Omega}\mbox{?}
  \end{IEEEeqnarray*}
\end{theorem}

\begin{lemma}
  The oerator~(\ref{global_interpolator}) is well defined because *** ver cuaderno
\end{lemma}

\begin{proof}[Proof of Theorem~\ref{interpolation_theorem}]
by Lemma~\ref{well_defined_dofs}, the field $\rZerou = r_0u_s + r_0u_r$ is well defined.  
\end{proof} 
**bound for the scalar variable: para todos igual, 
lo pongo una sola vez.
%%======================================================================================= 
% Recall that $\|\bw\|^2_{\mathbb{V}} = \|\bw\|^2_{0,\Omega} + \|\dv\,\bw\|^2_{0,\Omega}$ 
% and that, 
% First, for the divergence term,
% Primero usar el lemma de taylor promediado aplicado al caso sin derivar. Despu'es:
% If we apply this after the commutative diagram property~(\ref{div_commutativity})
% \begin{IEEEeqnarray*}{rCl}
% \|\dv(\bu - \rZerou)\|^2_{0,\Omega} & = &
%   \|\dv\,\bu - \dv\,\rZerou\|^2_{0,\Omega}\\
%     & = &\|\dv\,\bu - \boldsymbol{P}_{\mathcal{T}_h}\dv\,\bu\|^2_{0,\Omega}\\
%   &\leqslant&\textit{h}^2\,\|\dv\,\bu\|^2_{0,\Omega}\\
%   &=&\textit{h}^2\,\|f\|^2_{0,\Omega}.|
% \end{IEEEeqnarray*}
%%======================================================================================= 
In any macro--element, in order to bound the regular part,

Given an element $E$, let $\boldsymbol{h}=(h_{E,1},h_{E,2},h_{E,3})'$.
\begin{IEEEeqnarray*}{rCl}
  \|\bu_r - \boldsymbol{r}_0\bu_r\|_{L^2(\Omega)}^2 & = &
  \sum_{E\in\mathcal{T}_{\textit{h}}}
  \|\bu_r - \boldsymbol{r}_0\bu_r\|_{L^2(E)}^2\\
  &=&\sum_{E\in\mathcal{T}_{\textit{h}}}\left( \sum_{|\alpha| = 1} 
  \boldsymbol{h}^\alpha \|D^\alpha\bu_r\|_{L^2(E)} + 
  h_E\|\dv\bu_r\|_{L^2(E)}
  \right)^2\\
  &\leqslant&\sum_{E\in\mathcal{T}_{\textit{h}}}\left[\sum_{|\alpha| = 1}
  \boldsymbol{h}^{2\alpha} + h_E^{2} \right]
  \left[\sum_{|\alpha| = 1}\|D^\alpha\bu_r\|_{L^2(E)}^2 + 
  \|\dv\bu_r\|_{L^2(E)}^2\right].
\end{IEEEeqnarray*}
Now $\boldsymbol{h}\leqslant C\,\textit{h}$ and $h_E \leqslant C\,h_3 \sim \textit{h}$ for all the elements of the
mesh, so the last expression is bounded above by
\begin{IEEEeqnarray*}{rCl}
  C^2\sum_{E\in\mathcal{T}_{\textit{h}}}4\,\textit{h}^{2}
  \left[\sum_{|\alpha| = 1}\|D^\alpha\bu_r\|_{L^2(E)}^2 + 
  \|\text{div}\bu_r\|_{L^2(E)}^2\right]
  &=&C\,\textit{h}^{2}
  \left[\sum_{|\alpha| = 1}\|D^\alpha\bu_r\|_{L^2(\Omega)}^2 + 
  \|\text{div}\bu_r\|_{L^2(\Omega)}^2\right].
\end{IEEEeqnarray*}
Then, finally
\begin{IEEEeqnarray*}{rCl}
  \|\bu_r - \boldsymbol{r}_0\bu_r\|_{L^2(\Omega)}&\leqslant&
  C\,\textit{h}\,|\bu_r|_{1,\Omega}.
\end{IEEEeqnarray*}
{\color{red} C\'omo pasamos a la norma de $f$?}
\subsection{prismatic macro--element, bound singular part} % (fold)
\label{sub:bound_singular_part_prismatic_macroelement}
Here we need to distinguish between the elements $\text{d}(K,e) > 0$ and $\text{d}(K,e) = 0$.
\begin{IEEEeqnarray*}{rCl}
  \| \boldsymbol{\sigma}_s - \boldsymbol{r}\boldsymbol{\sigma} _s\|_{L^2(\Omega)}^2 &\leqslant&
  \sum_{\text{d}(K,e) = 0} \left(\| \boldsymbol{\sigma}_s\|_{L^2(E)} + 
  \|\boldsymbol{r}\boldsymbol{\sigma} _s\|_{L^2(E)}\right)^2\\
  & &\:+\sum_{\text{d}(K,e) > 0} \left( \sum_{|\alpha| = 1} 
  \boldsymbol{h}^\alpha \|D^\alpha\boldsymbol{\sigma}_s\|_{L^2(E)} + 
  h_K\|\text{div}\boldsymbol{\sigma}_s\|_{L^2(E)}
  \right)^2.
\end{IEEEeqnarray*}
\paragraph{Elements with $d(K,e) > 0$.} % (fold)
\label{par:elements_with_d_pos}
The objective of the following items is to bound each one of the terms
involved by a constant times $\textit{h}$ times the norm of the data $f$. 
Afterwards, we will sum up every term to find our estimation.
\subparagraph{Bound for $\|\partial_{x_1}\boldsymbol{\sigma}_s\|_{L^2(E)}$.} % (fold)
\label{subp:bound_for_100} Pick up a weight $w(\textbf{x})$ such that $w(\textbf{x})\geq h_1$.
\begin{IEEEeqnarray*}{rCl}
  h_1\|\partial_{x_1}\boldsymbol{\sigma}_s\|_{L^2(E)}& = & 
    \sum_{i=1,2} \|h_1\partial_{x_1}\sigma_{s,i}\|_{L^2(E)} +
      h_1\|\partial_{x_1}\sigma_{s,3}\|_{L^2(E)}\\
  & \leqslant & \sum_{i=1,2} \|w(\textbf{x})\partial_{x_1}\sigma_{s,i}\|_{L^2(E)} +
      h_1\|\sigma_{s,3}\|_{V_0^{1,2}(\Omega)}.
\end{IEEEeqnarray*}
Now it turns out that if we could choose $w(\textbf{x}) = \textit{h}\,r(\textbf{x})^\delta \geq h_1$, then
we would have
\begin{IEEEeqnarray*}{rCl}
  &\leqslant&\textit{h} \sum_{i=1,2} \|\sigma_{s,i}\|_{V_\delta^{1,2}(\Omega)} +
      \textit{h}\|\sigma_{s,3}\|_{V_0^{1,2}(\Omega)}\\
  &\leqslant&C\,\textit{h}\|f\|_{L^2(\Omega)}.
\end{IEEEeqnarray*}
Let's look for $\delta$. We have $r(\textbf{x})\geq \text{d(K,e)}$ so, according to the grading, in the 
case $0< \text{d(K,e)} <1$, it holds
\begin{IEEEeqnarray*}{rClCl}
  \textit{h}\,r(\textbf{x})^{1-\mu}&\geq&\textit{h}\,\text{d(K,e)}^{1-\mu}&\sim& h_1.
\end{IEEEeqnarray*}
In the 
case $\text{d(K,e)} \sim 1$
\begin{IEEEeqnarray*}{rClCl}
  \textit{h}\,r(\textbf{x})^{1-\mu}&\gtrsim&\textit{h}&\sim& h_1.
\end{IEEEeqnarray*}
In both cases we take $\delta \sim 1-\mu > 1 - \frac{\pi}{\omega} $. The bound for the term 
$\alpha = (0,1,0)$ is similar.
% subparagraph bound_for_100 (end)
\subparagraph{Bound for $\|\partial_{x_3}\boldsymbol{\sigma}_s\|_{L^2(E)}$.} % (fold)
\label{subp:bound_for_001}
If $i = 1,2,3$, $\partial_{x_3}\sigma_i$ equals $\partial_{x_i}\sigma_3$.
\begin{IEEEeqnarray*}{rCl}
  h_3\|\partial_{x_3}\boldsymbol{\sigma}_s\|_{L^2(E)}& = & 
    \sum_{i=1,2,3} h_3\,\|\partial_{x_3}\sigma_{s,i}\|_{L^2(E)}\\
    &\lesssim&\textit{h}\,\| \sigma_3 \|_{V_0^{1,2}(\Omega)}\leqslant\textit{h}\,\|f\|_{L^2(\Omega)}.
\end{IEEEeqnarray*}
\subparagraph{Bound for the divergence.} % (fold)
\label{subp:bound_for_the_div}
\begin{IEEEeqnarray*}{rCl}
  h_K\,\| \dvg\boldsymbol{\sigma}_s \|_{L^2(E)} & \lesssim &
  {h_3}\,\|\dvg\boldsymbol{\sigma}_s\|_{L^2(\Omega)}\sim
  \textit{h}\,\|\dvg\boldsymbol{\sigma}_s\|_{L^2(\Omega)}\\[7pt]
  &\leqslant&\textit{h}\,(\|f\|+
  \|\dvg\bu_r\|_{L^2(\Omega)})\lesssim\textit{h}\,\|f\|.
\end{IEEEeqnarray*}
% subparagraph bound_for_the_div (end)

% paragraph elements_with_d_pos (end)
\paragraph{Elements with $d(K,e) = 0$.} % (fold)
\label{par:elements_with_d0}
Take $\delta \sim 1-\mu$ in this paragraph again.
\subparagraph{Bound for $\| \boldsymbol{\sigma}_s\|_{L^2(E)}$.} % (fold)
\label{subp:bound_for_sigma_i}
\begin{IEEEeqnarray*}{rCl}
  \|\boldsymbol{\sigma}_s\|_{L^2(E)}& = & \sum_{i=1,2,3}\|{\sigma_{s,i}}\|_{L^2(E)}\\
  &=&\sum_{i=1,2,3}\|r(\textbf{x})^{1-\delta} r(\textbf{x})^{\delta-1} {\sigma_{s,i}}\|_{L^2(E)}\\
  &\leqslant& \max r(\textbf{x})^{1-\delta}\sum_{i=1,2,3}\|{\sigma_{s,i}}\|_{V_\delta^{1,2}(\Omega)}\\
  &\lesssim& h_1^{1-\delta}\sum_{i=1,2,3}\|{\sigma_{s,i}}\|_{V_\delta^{1,2}(\Omega)}\\
  &\sim&  (\textit{h}^{1/\mu})^\mu\sum_{i=1,2,3}\|{\sigma_{s,i}}\|_{V_\delta^{1,2}(\Omega)}
  \leqslant C\,\textit{h}\,\|f\|_{L^2(\Omega)}.
\end{IEEEeqnarray*}
% subparagraph bound_for_sigma_i (end)
\subparagraph{Bound for $\| \boldsymbol{r} \boldsymbol{\sigma}_s \|_{L^{2}(K)}$.} % (fold)
\label{subp:bound_for_r_k_1} 
First, if $\phi$ is a scalar polynomial defined on a physical element $K$, then
\begin{IEEEeqnarray}{rCl}\label{normaL2L1}
  \| \phi \|_{L^{2}(K)} & \leqslant & C\,|K|^{-1/2}\, 
  \| \phi \|_{L^{1}(K)}.
\end{IEEEeqnarray}
Now we estimate the $L^1$ norms, starting with the stability estimate in $\tilde{K}$.
\begin{IEEEeqnarray*}{rCl}
  \| (\boldsymbol{r}\boldsymbol{\sigma}_s)_1 \|_{L^{1}(K)}  & = & \int\limits_K |(\boldsymbol{r} \boldsymbol{\sigma}_s)_1|\,d\textbf{x}\\
        & = & \int\limits_{\tilde{K}} |(A\,\tilde{\boldsymbol{r}}\tilde{\boldsymbol{\sigma}}_s)_1|\,d\tilde{\textbf{x}}\\
        & \leqslant & {\color{BrickRed} \|A\|_\infty} \left[\|\tilde{\sigma}_{s,1}\|_{L^1(\tilde{K})} + \|\tilde{\sigma}_{s,2}\|_{L^1(\tilde{K})}\right.\\
   &    & +\;h_1 \left( \| \partial_{x} \tilde{\sigma}_{s,1} \|_{L^{1}(\tilde{K})} +
        \| \partial_{x} \tilde{\sigma}_{s,2} \|_{L^{1}(\tilde{K})}\right)\\
   &    & +\;h_2 \left( \| \partial_{y} \tilde{\sigma}_{s,1} \|_{L^{1}(\tilde{K})} +
        \| \partial_{y} \tilde{\sigma}_{s,2} \|_{L^{1}(\tilde{K})}\right)\\
   &    & +\;\left.h_3 \left( \| \partial_{z} \tilde{\sigma}_{s,1} \|_{L^{1}(\tilde{K})} +
        \| \partial_{z} \tilde{\sigma}_{s,2} \|_{L^{1}(\tilde{K})}\right) + 
          2 h_1\|\tilde{\text{div}}(\tilde{\sigma}_{s,1},\tilde{\sigma}_{s,2},0)\|_{L^{1}(\tilde{K})}\right].
\end{IEEEeqnarray*}
{\color{BrickRed}($\|A\|_\infty$ no molesta! $1 \leqslant \|A^{-1}\|_\infty$, $\|A\|_\infty \leqslant \|A\|_\infty\|A^{-1}\|_\infty$).}
By~(\ref{Piola}) and~(\ref{derivadaPiola}):
\begin{IEEEeqnarray*}{rCl}
  \|\tilde{\sigma}_{s,1}\|_{L^1(\tilde{K})} & = &
  \frac{1}{|\det(A)|} \int\limits_{K} \left|\tilde{\sigma}_{s,1}(F^{-1}(\textbf{x}))\right|\,d\textbf{x}\\
        & =   &         \int\limits_{K} |A^{-1}_{\text{row}_1}\boldsymbol{\sigma}_s(\textbf{x})|\,d\textbf{x}\\
        & \leqslant &         \|A^{-1}\|_\infty\left(\|\sigma_{s,1}\|_{L^1(K)} + \|\sigma_{s,2}\|_{L^1(K)}\right),
\end{IEEEeqnarray*}
and
\begin{IEEEeqnarray*}{rCl}
  \|\tilde{\sigma}_{s,2}\|_{L^1(\tilde{K})} & \leqslant & \|A^{-1}\|_\infty\left(\|\sigma_{s,1}\|_{L^1(K)} + \|\sigma_{s,2}\|_{L^1(K)}\right).
\end{IEEEeqnarray*}
Derivatives. If $k,l = 1,2$: 
\begin{IEEEeqnarray*}{rCl}
  \|\partial_{\tilde{x}_l} \tilde{\sigma}_{s,k}\|_{L^1(\tilde{K})} 
  & = & \frac{1}{|\det(A)|} \int\limits_{K} \left|\det(A)\,A^{-1}_{\text{row}_k}\,
  D\boldsymbol{\sigma}_s(\textbf{x})\,A_{\text{col}_l}\right|\,d\textbf{x}\\
  %& \leqslant & \|A^{-1}_{\text{row}_k}\|_\infty\|A_{\text{col}_l}\|_\infty\sum_{i,j = 1,2} \|\partial_{x_j}\sigma_{s,i}\|_{L^{1}(K)}\\
  & \leqslant & \|A^{-1}\|_\infty\|\partial_{\xi_j}\boldsymbol{\sigma}_{s}\|_{L^{1}(K)},
\end{IEEEeqnarray*}
and similarly, if $k=1,2$:
\begin{IEEEeqnarray*}{rCl}
  \|\partial_{\tilde{x}_3} \tilde{\sigma}_{s,k}\|_{L^1(\tilde{K})} & \leqslant &
  \|A^{-1}\|_\infty\sum_{i = 1,2} \|\partial_{\xi_3}\sigma_{s,i}\|_{L^{1}(K)}.
\end{IEEEeqnarray*}
Divergence: because of the blocks of the matrix $A$ we have
\begin{IEEEeqnarray*}{rCl}
  (\sigma_1(\textbf{x}), \sigma_2(\textbf{x}), 0)^t & = &
\frac{1}{\det A}\,A\, (\tilde{\sigma}_1(\tilde{\textbf{x}}), \tilde{\sigma}_2(\tilde{\textbf{x}}), 0)^t\text{,}\\
{\text{div}}({\sigma}_1,{\sigma}_2,0)&=&\frac{1}{\det A} \tilde{\text{div}}(\tilde{\sigma}_1,\tilde{\sigma}_2,0).
\end{IEEEeqnarray*}
Then, changing variables,
\begin{IEEEeqnarray*}{rCl}
  \|\tilde{\text{div}}(\tilde{\sigma}_{s,1},\tilde{\sigma}_{s,2},0)\|_{L^{1}(\tilde{K})} &=&
  \|\text{div}(\sigma_{s,1},\sigma_{s,2},0)\|_{L^{1}(K)}.
\end{IEEEeqnarray*}
Joining everything, by~(\ref{matrix1}) and~(\ref{matrix2}), and $\|A\|_\infty\leqslant C$:
\begin{IEEEeqnarray*}{rCl}
  \| (\boldsymbol{r} \boldsymbol{\sigma}_s)_1 \|_{L^{1}(K)} & \lesssim & 
  \|\sigma_{s,1}\|_{L^1(K)} + \|\sigma_{s,2}\|_{L^1(K)}\\
  & &+\;h_1\|\partial_{\xi_1}\boldsymbol{\sigma}_{s}\|_{L^{1}(K)} +
    h_2\|\partial_{\xi_2}\boldsymbol{\sigma}_{s}\|_{L^{1}(K)} +
  h_3 \sum_{i = 1,2} \|\partial_{\xi_3}\sigma_{s,i}\|_{L^{1}(K)}\\
  & & +\;h_1 \|\text{div}(\sigma_{s,1}, \sigma_{s,2}, 0)\|_{L^{1}(K)}.
\end{IEEEeqnarray*}
{\color{red} PESOS: revisar desde ac\'a por la correcci\'on de la p\'agina anterior.}
Now, for $\|\sigma_{s,i}\|$ with $i=1,2$,
\begin{IEEEeqnarray*}{rCl}
  \|\sigma_{s,i}\|_{L^1(K)} & = & 
  \| r(\textbf{x})^{1-\delta} r(\textbf{x})^{\delta-1} \sigma_{s,i}\|_{L^1(K)}\\
  &\leqslant& \|r^{1-\delta}\|_{L^2(E)} \|\sigma_{s,i}\|_{V_\delta^{1,2}(K)}\\
  &\leqslant& C\,h_1^{1-\delta}\,|K|^{1/2}\,\|\sigma_{s,i}\|_{V_\delta^{1,2}(K)}\\
  &\leqslant& C\,\textit{h}\,|K|^{1/2}\,\|\sigma_{s,i}\|_{V_\delta^{1,2}(\Omega)}\\
  &\leqslant& C\,\textit{h}\,|K|^{1/2}\,\|f\|_{L^{2}(\Omega)}.
\end{IEEEeqnarray*}
\noindent With respect to the derivatives orthogonal to the singular edge, take $i,j = 1,2$ and, by H\"older's inequality,
\begin{IEEEeqnarray*}{rCl}
  h_1\|\partial_{x_j}\sigma_{s,i}\|_{L^1(K)} &\leqslant&
  h_1\,\|r^{-\delta}\|_{L^2(E)}\,\|\sigma_{s,i}\|_{V_\delta^{1,2}(K)}.
\end{IEEEeqnarray*}
Integrating:
\begin{IEEEeqnarray*}{rCl}
  \|r^{-\delta}\|_{L^2(E)} & \leqslant & C\, h_1^{-\delta}\,h_1\,h_3^{1/2}\\
  & \sim & h_1^{-\delta}(h_1h_2h_3)^{1/2}\\
  &\leqslant& C\, h_1^{-\delta} |K|^{1/2},
\end{IEEEeqnarray*}
(where we used the minimun angle condition and $h_1 \sim h_2$)
So we have
\begin{IEEEeqnarray*}{rCl}
  h_1\|\partial_{x_j}\sigma_{s,i}\|_{L^1(K)} & \leqslant & C\,h_1^{1-\delta} |K|^{1/2}
  \|\sigma_{s,i}\|_{V_\delta^{1,2}(K)}\\
  &\sim& (\textit{h}^{1/\mu})^{\mu} |K|^{1/2}
  \|\sigma_{s,i}\|_{V_\delta^{1,2}(K)}\\
  \label{derivOrtog} \yesnumber &=&|K|^{1/2}\,\textit{h}\,\|\sigma_{s,i}\|_{V_\delta^{1,2}(K)}.
\end{IEEEeqnarray*}
For the derivatives along the singular edge: by H\"older's inequality
\begin{IEEEeqnarray*}{rCl}
  h_3\,\| \partial_{x_3}\sigma_{s,i} \|_{L^1(K)} &=& h_3\,\| \partial_{x_i}\sigma_{s,3} \|_{L^1(K)}\\
  &\leqslant& h_3\,|K|^{1/2}\,\| \partial_{x_i}\sigma_{s,3} \|_{L^2(E)}\\
  \yesnumber\label{alongSingular}&\leqslant& C\,|K|^{1/2}\,\textit{h}\,\|f\|_{L^2{(\Omega)}}.
\end{IEEEeqnarray*}
\noindent For the divergence we can do... recalling again the grading condition $h_1\sim h_2$,
\begin{IEEEeqnarray*}{rCl}
  h_1 \|\text{div}(\sigma_{s,1}, \sigma_{s,2}, 0)\|_{L^{1}(K)} & \leqslant &
  h_1 \|\partial_{x_1} \sigma_{s,1}\|_{L^{1}(K)} + h_1\|\partial_{x_2} \sigma_{s,2}\|_{L^{1}(K)}
\end{IEEEeqnarray*}
and reuse the estimates~(\ref{derivOrtog}). The estimate for 
$\| (\boldsymbol{r} \boldsymbol{\sigma}_s)_2 \|_{L^{2}(K)}$ is the same.The estimate for 
$\| (\boldsymbol{r} \boldsymbol{\sigma}_s)_3 \|_{L^{2}(K)}$ is as follows. By Theorem~\ref{thmStabilityKtildeRT},
\begin{IEEEeqnarray*}{rCl}
          \| (\boldsymbol{r}\boldsymbol{\sigma}_s)_3 \|_{L^{1}(K)}
  & =     &
  \| (\tilde{\boldsymbol{r}}\tilde{\boldsymbol{\sigma}}_s)_3 \|_{L^{1}(\tilde{K})}\\
  & \leqslant & C\,(\,\|\tilde{\sigma}_{s,3}\|_{L^1(\tilde{K})} +
    \sum_{j=1,2,3} h_j\,\|\partial_{\tilde{x}_j}\tilde{\sigma}_{s,3}\|_{L^1(\tilde{K})}\,)\\
  & \leqslant & C\,(\,\|{\sigma}_{s,3}\|_{L^1({K})} +
    \sum_{j=1,2,3} h_j\|\partial_{\xi_j}{\sigma}_{s,3}\|_{L^1({K})}).
\end{IEEEeqnarray*}
Now
\begin{IEEEeqnarray*}{rCl}
  \|\sigma_{s,3}\|_{L^1(K)} &\leqslant& \|r\|_{L^2(E)} \,\|r^{-1}\,\sigma_{s,3}\|_{L^2(E)}\\
              &\leqslant&C\,h_1\,|K|^{\frac{1}{2}}\,\|\sigma_{s,3}\|_{V_0^{1,2}(\Omega)}\\
              &\leqslant&C\,\textit{h}\,|K|^{\frac{1}{2}}\,\|\sigma_{s,3}\|_{V_0^{1,2}(\Omega)}. 
\end{IEEEeqnarray*}
We have also {\color{red} (al final no va $(h_1 + h_2)$)}
\begin{IEEEeqnarray*}{rCl}
  (h_1 + h_2)\sum_{i=1,2} \|\partial_{{x}_i}{\sigma}_{s,3}\|_{L^1({K})} &\leqslant&
  C\,|K|^{1/2}\,\textit{h}\,\|\sigma_{s,3}\|_{V_0^{1,2}(\Omega)}
\end{IEEEeqnarray*}
and~(\ref{alongSingular})
\begin{IEEEeqnarray*}{rCl}
  h_3\,\|\partial_{x_3}\sigma_{s,3}\|_{L^1(K)} &\leqslant& C\,|K|^{1/2}\,\textit{h}\,\|f\|_{L^2{(\Omega)}}.
\end{IEEEeqnarray*}
At last, having the bound for each of the three components, by~(\ref{normaL2L1}), {\color{BrickRed}(redactar mejor)}
\begin{IEEEeqnarray*}{rCl}
  \|\boldsymbol{r} \boldsymbol{\sigma}_s\|_{L^{2}(K)} &\leqslant& C\,\textit{h}\,\|f\|_{L^2(\Omega)}.
\end{IEEEeqnarray*}
% subparagraph bound_for_r_k (end)

% paragraph elements_with_d0 (end)
% subsection bound_singular_part_prismatic_macroelement (end)

\subsection{bound singular part tetrahedral macroelement
with vertex and edge singularities} % (fold)
{\color{brown}Table~\ref{element_classification} shows what has to be done for each type of
element.
\begin{table}
\centering
\caption{Parte singular.}
\label{element_classification}
  \begin{IEEEeqnarraybox}
  [\IEEEeqnarraystrutmode
   \IEEEeqnarraystrutsizeadd{0pt}{0pt}]{v/c/v/c/v/c/v/c/v}
    \IEEEeqnarrayrulerow\\
    \IEEEeqnarrayseprow[3pt]\\
    &\hfill\raisebox{22pt}[0pt][0pt]{$d(K,\textbf{e})>0$}\hfill
                & & \referencePrismTikz 
              & & \referencePyramidTikz
                & & \referenceTetrahedronTikz{1.1}&\\
    \IEEEeqnarrayrulerow\\
    \IEEEeqnarrayseprow[3pt]\\
    &\hfill\raisebox{30pt}[0pt][0pt]{$d(K,\textbf{e})=0$}\hfill& &
      \begin{IEEEeqnarraybox}{c}
      \referencePrismTikz\\d(K,\textbf{v}) > 0
      \end{IEEEeqnarraybox}
    &&&&
      \begin{IEEEeqnarraybox}{c}
        \referenceTetrahedronTikz{1.1}\d(K,\textbf{v}) = 0
      \end{IEEEeqnarraybox}
    &\\
    \IEEEeqnarrayseprow[3pt]\\
    \IEEEeqnarrayrulerow
  \end{IEEEeqnarraybox}
\end{table}
[color brown end]}

Parte singular:
\begin{IEEEeqnarray*}{rCl}
  \|\bu_s - \pi\bu_s\|^2_{\scriptscriptstyle L^2(\Omega)^3}
  &=&\sum_{d(K,e) = 0}
  \|\bu_s - \pi\bu_s\|^2_{\scriptscriptstyle L^2(E)^3}+
  \sum_{d(K,e) > 0}
  \|\bu_s - \pi\bu_s\|^2_{\scriptscriptstyle L^2(E)^3}\\[7pt]
\end{IEEEeqnarray*}
Parte con $d(K,e)>0$. Recordar c\'omo son los nuevos $h_1,h_2,h_3$.
%% (y,z,x)
\begin{center}
\begin{tikzpicture}[rotate=0,scale=1,shape border uses incircle,shape border rotate=-30]
  \node [name=t,shape=trapezium,draw,minimum width=2cm,
      trapezium left angle=120] at (0,0,0) {};
  
  \coordinate (punta) at (0,0,3);

  \coordinate (tl) at (t.top left corner);
  \coordinate (tr) at (t.top right corner);
  \coordinate (bl) at (t.bottom left corner);
  \coordinate (br) at (t.bottom right corner);

  \draw (tl) -- (punta);
  \draw (bl) -- (punta);
  \draw (tr) -- (punta);
  \draw (br) -- (punta);
  
  \coordinate (k1) at ($0.70*(tl) + 0.30*(punta)$);
  \coordinate (k2) at ($0.5*(tl) + 0.5*(tr)$);
  \coordinate (k3) at ($0.4*(tl) + 0.6*(bl)$);

  \node [left=1mm] (eta1) at (k1) {$\boldsymbol{\eta_1}$};
  \node [right=1mm] (eta2) at (k2) {$\boldsymbol{\eta_2}$};
  \node [below=0.5mm,right] (eta3) at (k3) {$\boldsymbol{\eta_3}$};

  \draw [->,thick] (tl) -- (k1);
  \draw [->,thick] (tl) -- (k2);
  \draw [->,thick] (tl) -- (k3);
\end{tikzpicture}
\end{center}
$K$ es una pir\'amide
\begin{IEEEeqnarray*}{rCl}
  \|\textbf{u}_s - \pi\textbf{u}_s\|^2_{\ss L^2(E)}&\leqslant&
  h_1^2\|\gancho_{\eta_1}\textbf{u}_s\|^2+
  h_2^2\|\gancho_{\eta_2}\textbf{u}_s\|^2+
  h_3^2\|\gancho_{\eta_3}\textbf{u}_s\|^2+
  h_K^2\|\dvg\textbf{u}_s\|^2\\[7pt]
\end{IEEEeqnarray*}
\begin{IEEEeqnarray*}{rCl}
  h_1\|\gancho_{\eta_1}\textbf{u}_s\|&=&
  h_1\sum_{i=1}^3 \|\gancho_{\eta_1}\textbf{u}_{s,i}\|\\
  &\leqslant&
    \textit{h}\sum_{i=1}^3 \|r^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,i}\|\\
  &\leqslant&
    \textit{h}\left(
     \sum_{i=1}^2 \|R^{1-\mu}\theta^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,i}\|+
     \|R^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
    \textit{h}\left(
     \sum_{i=1}^2 \|R^{1-\nu}\theta^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,i}\|+
     \|R^{1-\nu}\gancho_{\eta_1}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
    \textit{h}\left(
    \sum_{i=1}^2 \|R^{\beta}\theta^{\delta}\gancho_{\eta_1}\textbf{u}_{s,i}\|+
     \|R^{\beta}\gancho_{\eta_1}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
    \textit{h}
    \left(\sum_{i=1}^2 \|\textbf{u}_{s,i}\|_{\scriptscriptstyle \beta,\delta}+
         \|\textbf{u}_{s,3}\|_{\scriptscriptstyle \beta,0}\right).
\end{IEEEeqnarray*}
Now, since $h_2\sim h_1$:
\begin{IEEEeqnarray*}{rCl}
  h_2\|\gancho_{\eta_2}\textbf{u}_s\|&=&
  h_2\sum_{i=1}^3 \|\gancho_{\eta_2}\textbf{u}_{s,i}\|\\
  &\leqslant&
    \textit{h}
    \left(\sum_{i=1}^2 \|\textbf{u}_{s,i}\|_{\scriptscriptstyle \beta,\delta}+
         \|\textbf{u}_{s,3}\|_{\scriptscriptstyle \beta,0}\right).
\end{IEEEeqnarray*}
\begin{IEEEeqnarray*}{rCl}
  h_3\|\gancho_{\eta_3}\textbf{u}_s\|&=&
  h_3\sum_{i=1}^3 \|\gancho_{\eta_3}\textbf{u}_{s,i}\|\\[7pt]
  &=&h_3\left(\sum_{i=1}^2\|\gancho_{\eta_i}\textbf{u}_{s,3}\|+
    \|\gancho_{\eta_3}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&\textit{h}\left(\sum_{i=1}^2\|d(K,v)^{1-\nu}\gancho_{\eta_i}\textbf{u}_{s,3}\|+
    \|d(K,v)^{1-\nu}\gancho_{\eta_3}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
  \textit{h}\left(\sum_{i=1}^2\|R^{\beta}\gancho_{\eta_i}\textbf{u}_{s,3}\|+
    \|R^{\beta}\gancho_{\eta_3}\textbf{u}_{s,3}\|\right)\\[7pt]
  &=&
  \textit{h}\sum_{i=1}^3\|R^{\beta}\gancho_{\eta_i}\textbf{u}_{s,3}\|\\[7pt]
  &\lesssim&
  \textit{h}\|\textbf{u}_{s,3}\|_{\scriptscriptstyle \beta,0}
\end{IEEEeqnarray*}
\begin{IEEEeqnarray*}{rCl}
  h_K\|\dvg\textbf{u}_s\|&\leqslant&
  h_K\|\dvg\textbf{u}_s+\dvg\textbf{u}_r\|+h_K\|\dvg\textbf{u}_r\|\\[7pt]
  &\lesssim&h_K\|f\|\sim \textit{h}\|f\|.
\end{IEEEeqnarray*}
Parte con ${\color{red} d(K,e)=0}$.
\begin{IEEEeqnarray}{rCl}
  \label{distancia_cero_arista}\sum_{d(K,e) = 0}
  \|\textbf{u}_s - \pi\textbf{u}_s\|^2_{\scriptscriptstyle L^2(E)^3}
  &\lesssim&
  {\color{green} \|\textbf{u}_s\|^2} + 
    {\color{blue}\|\pi\textbf{u}_s\|^2_{\scriptscriptstyle L^2(Tetra)^3}}\\[5pt]
  &&\,+\sum_{
  \substack{\text{ prisms }K\\
        d(K,e) = 0}
    }
  {\color{green} \|\textbf{u}_s\|^2} + {\color{olive} \|\pi\textbf{u}_s\|^2_{\scriptscriptstyle L^2(E)^3}}.
\end{IEEEeqnarray}
\\[10pt]
Si $K$ es tanto el tetraedro con el v\'ertice singular como un prisma 
($d(K,e) = 0$, $d(K,v) > 0$):
\begin{IEEEeqnarray*}{rCl}
  {\color{green} \|\textbf{u}_s\|} &=&
    \sum_{i=1}^2 \|R^\nu\theta^\mu R^{-\nu}\theta^{-\mu}\textbf{u}_{s,i}\|
    + \|R^\nu\theta^{-1}R^{-\nu}\theta\textbf{u}_{s,3}\|\\[7pt]
  &\leqslant&\max_{\textbf{x}}R(\textbf{x})^\nu\theta(\textbf{x})^\mu
  \sum_{i=1}^2 \|R^{-\nu}\theta^{-\mu}\textbf{u}_{s,i}\|
    + \max_{\textbf{x}}R(\textbf{x})^\nu\theta(\textbf{x})
    \|R^{-\nu}\theta^{-1}\textbf{u}_{s,3}\|.
\end{IEEEeqnarray*}
Pero es $\theta < 1$ y $\mu \leqslant \nu < 1$, entonces
\begin{IEEEeqnarray}{rClClCr}
  \label{cota_pesos}
  R(\textbf{x})^\nu\theta(\textbf{x})&\leqslant&
  R(\textbf{x})^\nu\theta(\textbf{x})^\mu&\leqslant&R(\textbf{x})^\mu\theta(\textbf{x})^\mu&=&
  r(\textbf{x})^\mu.
\end{IEEEeqnarray}
Volvemos y queda
\begin{IEEEeqnarray*}{rCl}
  \|\textbf{u}_s\|&\leqslant&\max_{\textbf{x}}r(\textbf{x})^\mu
  \left(
    \sum_{i=1}^2 \|R^{-\nu}\theta^{-\mu}\textbf{u}_{s,i}\|
    + \|R^{-\nu}\theta^{-1}\textbf{u}_{s,3}\|
  \right)\\[7pt]
  &\leqslant&\max\{h_1,h_2\}^\mu
  \left(
    \sum_{i=1}^2 \|R^{-\nu}\theta^{-\mu}\textbf{u}_{s,i}\|
    + \|R^{-\nu}\theta^{-1}\textbf{u}_{s,3}\|
  \right)\\[7pt]
  &\lesssim&\textit{h}
  \left(
    \sum_{i=1}^2 \|\textbf{u}_{s,i}\|_{\beta,\delta}
    + \|\textbf{u}_{s,3}\|_{\beta,0}
  \right) \lesssim \textit{h}\,\|f\|,
\end{IEEEeqnarray*}
con tal de tomar $\beta\sim 1-\nu$ y $\delta\sim 1-\mu$.\\[10pt]
${\color{blue}\|\pi\textbf{u}_s\|^2_{\scriptscriptstyle L^2(Tetra)^3}}$: First
\begin{IEEEeqnarray*}{rCl}
  \|(\pi\textbf{u}_s)_1\|_{\scriptscriptstyle L^2(E)}
    & \leqslant & C|K|^{-1/2} \|(\pi\textbf{u}_s)_1\|_{\scriptscriptstyle L^1(K)}.
\end{IEEEeqnarray*}
Now, by Prop 3.4 de AADL
\begin{IEEEeqnarray*}{rCl}
  \|(\pi\textbf{u}_s)_1\|_{L^1(K)} &=& \ldots\\[7pt]
  & = &\int\limits_{\tilde{K}}|(A\tilde{\pi}\tilde{\textbf{u}}_s)_1|\,d\tilde{x}\\[7pt]
    &\lesssim&\sum_{1\leqslant i\leqslant 3} \left(\|\tilde{u}_{s,i}\|_{L^1(\tilde{K})} + 
      \sum_{1\leqslant j\leqslant 3} h_j\|\partial_j\tilde{u}_{s,i}\|_{L^1(\tilde{K})} + 
      h_i\|\dvg \tilde{\textbf{u}}_s\|_{L^1(\tilde{K})}
    \right) \\[7pt]
    & = & \ldots \text{paso al tetraedro f\'isico} \ldots \\[7pt] % VER BORRADOR INTERPOLACION PIRAMIDE
    & \leqslant & C
    \left({\color{orange} \|\textbf{u}_{s}\|_{L^1(K)^3}} + 
    \sum_{1\leqslant j \leqslant 3} {\color{teal} h_j\|\partial_{\xi_j}\textbf{u}_{s}\|_{L^1(K)}} + 
    {\color{purple} (h_1+h_2+h_3) \|\dvg \textbf{u}_s\|_{L^1(K)}}\right).
\end{IEEEeqnarray*}
PESOS
\begin{IEEEeqnarray*}{rCl}
  {\color{Orange} \|\textbf{u}_{s}\|_{L^1(K)^3}} & = &
  \sum_{i=1,2}\|R^{\nu}\theta^{\mu}R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^1(K)} + 
  \|R^{\nu}\theta R^{-\nu}\theta^{-1}u_{s,3}\|_{L^1(K)} \\[7pt]
\text{H\"older\quad}&\leqslant&
\sum_{i=1,2}\|R^{\nu}\theta^{\mu}\|_{L^2(E)}\|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^2(E)} + 
  \|R^{\nu}\theta\|_{L^2(E)}\|R^{-\nu}\theta^{-1}u_{s,3}\|_{L^2(E)}
 \\[7pt]
&\leqslant&
\max_{\textbf{x}}R(\textbf{x})^\nu\theta(\textbf{x})^{\mu}|K|^{1/2}
\sum_{i=1,2}\|\ldots u_{s,i}\|_{L^2} + 
\max_{\textbf{x}}R(\textbf{x})^\nu\theta(\textbf{x})|K|^{1/2}
\|\ldots u_{s,3}\|_{L^2}\\[7pt]
\text{por~(\ref{cota_pesos})\quad}&\leqslant&
(\textit{h}^{1/\mu})^\mu|K|^{1/2}
\sum_{i=1,2}\|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^{2}(K)} +
\|\ldots u_{s,3}\|_{L^{2}(K)}\\[7pt]
&\leqslant&\textit{h} |K|^{1/2}
\|\textbf{u}_s\|_{V_{\beta,\delta}^{1,2}(K)^2\times V_{\beta,0}^{1,2}(K)}.
\end{IEEEeqnarray*}
Take $1\leqslant j,i \leqslant 3$ (HACER APARTE PARA $i=3$; creo que es un poco
diferente, como pas\'o antes):
\begin{IEEEeqnarray*}{rCl}
  {\color{teal} h_j\|\partial_{\xi_j} u_{s,i}\|_{L^1}} & \leqslant &
    h_j\|R^{\nu-1}\theta^{\mu-1}\|_{L^2}\|R^{1-\nu}\theta^{1-\mu}\partial_{\xi_j} u_{s,i}\|_{L^2}
\end{IEEEeqnarray*}
As $0\leqslant1-\nu\leqslant1-\mu<1$ we get 
\[
  R(\textbf{x})^{1-\nu}\geqslant R(\textbf{x})^{1-\mu}
\]
and
\[
  R(\textbf{x})^{\nu-1}\theta(\textbf{x})^{\mu-1}\leqslant
  R(\textbf{x})^{\mu-1}\theta(\textbf{x})^{\mu-1} = r(\textbf{x})^{\mu-1},
\]
\[
  \|R^{\nu-1}\theta^{\mu-1}\|_{L^2} \leqslant \|r^{\mu-1}\|_{L^2}.
\]
Now ({\color{red} $C$ es el pedazo de cilindro})\\
{est\'a bien as\'i?}
\[
  \|r^{\mu-1}\|_{L^2} = \sqrt{\frac{\pi}{4\mu}}\sqrt{h_3}\,h_1^{\mu}\sim \sqrt{h_3}\,\textit{h}.
\]
Then
\begin{IEEEeqnarray*}{rCl}
  h_j\|r^{\mu-1}\|_{L^2} & \lesssim & \sqrt{h_1h_2h_3}\textit{h}\\[7pt]
    & \sim & \sqrt{|K|}\,\textit{h}
\end{IEEEeqnarray*}
and then
\begin{IEEEeqnarray}{rCl}\label{cuentita_integral}
  h_j\|\partial_{\xi_j} u_{s,i}\|_{L^1} & \lesssim &
    \textit{h}\,\sqrt{|K|}\,\|R^{1-\nu}\theta^{1-\mu}\partial_{\xi_j} u_{s,i}\|_{L^2}.
\end{IEEEeqnarray}
Divergence:
\begin{IEEEeqnarray*}{rClCr}
  {\color{purple} (h_1+h_2+h_3) \|\dvg \textbf{u}_s\|_{L^1}} & \leqslant &
    (2\textit{h}^{1/\mu} + \textit{h}^{1/\nu}) \|\dvg \textbf{u}_s\|_{L^1} \\[7pt]
    & \leqslant & 3 \textit{h}\,\sqrt{|K|}\,\|\dvg \textbf{u}_s\|_{L^2} \\[7pt]
    & \leqslant & 3 \textit{h}\,\sqrt{|K|}\,\left(\|f\|_{L^2} + \|\dvg \textbf{u}_r\|_{L^2}\right) \\[7pt]
    & \lesssim  & \textit{h}\,\sqrt{|K|}\,\|f\|_{L^2}. \\[7pt]
\end{IEEEeqnarray*}
Now prisms, the last term on the right of~(\ref{distancia_cero_arista}).
By stability estimation
\begin{IEEEeqnarray*}{rCl}
  {\color{olive} \|\pi\textbf{u}_s\|_{\scriptscriptstyle L^1(K)^3}} & \leqslant & 
    \|A\|_\infty \|\tilde{\pi}\tilde{\textbf{u}}_s\|_{L^1{\tilde{K}}} \\ [7pt]
  &\lesssim& \left\| \tilde{\textbf{u}}_s \right\|_{L^1(\tilde{K})^3}
    + \sum_{j=1}^3 h_j \left\| \partial_{\tilde{x}_j}\tilde{\textbf{u}}_s \right\|_{L^1(\tilde{K})^3}
    + h_{\tilde{K}}\left\|\Div(\tilde{u}_1, \tilde{u}_2, 0) \,\right\|_{L^1(\tilde{K})}\\[7pt]
  &\lesssim& \left\| \textbf{u}_s \right\|_{L^1(K)^3}
    + \sum_{j=1}^3 h_j \left\| \partial_{\xi_j}\textbf{u}_s \right\|_{L^1(K)^3}
    + h_{K}\left\|\Div(u_1, u_2, 0) \,\right\|_{L^1(K)},    
\end{IEEEeqnarray*}
by the same argument as in Theorem 5.1 in primas.pdf.\\
\noindent Weights: again for $i=1$ or $2$
\begin{IEEEeqnarray*}{rCl}
  \|u_{s,i}\| & \leqslant & \|R^{\nu}\theta^{\mu}\| \|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^2} \\[7pt]
  & \leqslant & \textit{h}\,|K|^{1/2} \|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^2}.
\end{IEEEeqnarray*}
\begin{IEEEeqnarray*}{rCl}
  \|u_{s,3}\| & \leqslant & \|R^{\nu}\theta\| \|R^{-\nu}\theta^{-1}u_{s,3}\|_{L^2} \\[7pt]
  & \leqslant & \textit{h}\,|K|^{1/2} \|R^{-\nu}\theta^{-1}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
\noindent DErivatives: $j = 1$ or $2$.\\
If $i=1$ or $2$. With the same argument as in~(\ref{cuentita_integral})
\begin{IEEEeqnarray}{rCl}
  h_j\|\partial_{\xi_j} u_{s,i}\|_{L^1} & \lesssim &
    \textit{h}\,\sqrt{|K|}\,\|R^{1-\nu}\theta^{1-\mu}\partial_{\xi_j} u_{s,i}\|_{L^2}.
\end{IEEEeqnarray}
For $\partial_{\xi_j}u_{s,3}$:
\begin{IEEEeqnarray*}{rCl}
  h_j\|\partial_{\xi_j}u_{s,3}\|_{L^1} &\leqslant&
    h_j \|R^{\nu-1}\|_{L^2}\|R^{1-\nu}\partial_{\xi_j}u_{s,3}\|_{L^2}\\[7pt]
  &\leqslant& h_j \|r^{\mu-1}\|_{L^2}\|R^{1-\nu}\partial_{\xi_j}u_{s,3}\|_{L^2}\\[7pt]
  &\lesssim& \textit{h}\,\sqrt{|K|}\,\|R^{1-\nu}\partial_{\xi_j}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
For $\partial_{\xi_3}$ ($h_3\sim\textit{h}\,d(K,\textbf{v})^{1-\nu}$):\\
First and second components:
\begin{IEEEeqnarray*}{rCl}
  h_3\|\partial_{\xi_3}u_{s,i}\|_{L^1}& = & h_3\|\partial_{\xi_i}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}\|R^{1-\nu}\partial_{\xi_i}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}|K|^{1/2}\|R^{1-\nu}\partial_{\xi_i}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
Third component:
\begin{IEEEeqnarray*}{rCl}
  h_3\|\partial_{\xi_3}u_{s,3}\|_{L^1}& \sim & \textit{h}\|d(K,\textbf{v})^{1-\nu}
    \partial_{\xi_3}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}\|R^{1-\nu}\partial_{\xi_3}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}|K|^{1/2}\|R^{1-\nu}\partial_{\xi_3}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
Divergence:
\begin{IEEEeqnarray*}{rCl}
  h_K\|\dvg (u_{s,1},u_{s,1},0)\|_{L1}&\leqslant&h_K\|\dvg \textbf{u}_s\|_{L1}
    +h_K\|\partial_{\xi_3}u_{s,3}\|_{L1}\\[7pt]
    &\lesssim&h_K\|\dvg \textbf{u}_s\|_{L1} + h_3\|\partial_{\xi_3}u_{s,3}\|_{L1},
\end{IEEEeqnarray*}
and, as was done for these two terms, we have
\begin{IEEEeqnarray*}{rCl}
  h_K\|\dvg (u_{s,1},u_{s,1},0)\|_{L1}&\lesssim&\textit{h} |K|^{1/2}\|f\|_{L2} +
  \textit{h} |K|^{1/2}\|R^{1-\nu}\partial_{\xi_3}u_{s,3}\|_{L2}. 
\end{IEEEeqnarray*}


\subsection{bound singular part tetrahedral macroelement with
singular vertex and no singular edge.}

*****************************************************

Now we establish the bound for the error in the statement of the Theorem.
For every $\bw\in W(\Th)$:
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bu_h\|_{L^2(\Omega)^3} &\leqslant& C\{\|\bu-I(\bu)\|_{L^2(\Omega)^3} + \|\bu-\bw\|_{L^2(\Omega)^3}\}.
\end{IEEEeqnarray*}
Now
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bw\|^2_{0,\Omega} &=& \sum_1^N \|\bu-\bw\|^2_{0,\Lambda_\ell}\\
    &=& \sum_1^N \left\{
      \sum_{pri} \|\bu-\bw\|^2_{0,E_\ell} +
      \sum_{tet} \|\bu-\bw\|^2_{0,E_\ell} +
      \sum_{pyr} \|\bu-\bw\|^2_{0,E_\ell}
    \right\} 
\end{IEEEeqnarray*}
so it suggests to do: 
let $P_{0,E_{\ell}}$ be the projection onto the constants over $E_{\ell}$;
take a $\bw_{\bu}$ such that, for every $E_\ell$
\begin{equation*}
  (\bw_{\bu})|_{E_\ell} = 
    \left\{
    \begin{array}{rll}
      \boldsymbol{r}_{E_\ell}\,[\bu|_{E_\ell}] & \mbox{if $E_\ell$ is a prism or a tetrahedron}\\[5pt]
                         P_{0,E_{\ell}}\bu    & \mbox{if $E_{\ell}$ is a pyramid}\\[5pt]
    \end{array}
    \right.
\end{equation*}
then, we able to do:
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bw_{\bu}\|^2_{0,\Omega}
    &=& \sum_{\ell=1}^N \left\{
      \sum_{pri} \|\bu-I\bu\|^2_{0,E_\ell} +
      \sum_{tet} \|\bu-I\bu\|^2_{0,E_\ell} +
      \sum_{pyr} \|\bu-P_{0,E_{\ell}}\|^2_{0,E_\ell}
    \right\}\\[5pt]
    &\leqslant& \sum_{\ell=1}^N \left\{
      \sum_{pri} \textit{h} \|f\|^2_{0,E_\ell} +
      \sum_{tet} \textit{h} \|f\|^2_{0,E_\ell} +
      \sum_{pyr} h_{E_\ell}|\bu|^2_{1,E_\ell}
    \right\}\\[5pt]
    &\leqslant& \textit{h} \sum_{\ell=1}^N \left\{
      \sum_{pri}  \|f\|^2_{0,E_\ell} +
      \sum_{tet}  \|f\|^2_{0,E_\ell} +
      \sum_{pyr} |\bu|^2_{1,E_\ell} {\color{red}\mbox{$\leftarrow$ esta parte? $\|f\|?$}}
    \right\}\\[5pt]
    \IEEEeqnarraymulticol{3}{c}{{\color{red} \mbox{tal vez haya que tomar las distancias
        a la arista y al vertice. Me gustar\'ia que quede lo sgte:}}}\\
    &\leqslant& \textit{h} \sum_{\ell=1}^N \|f\|^2_{0,\Lambda_\ell} \,=\,
      \textit{h}\,\|f\|^2_{0,\Omega}.
\end{IEEEeqnarray*}

\noindent{\color{blue}\#\#\#\#\#\#\# Ojo que N está 
como cardinal de la primera malla y también como cardinal de una malla cualquiera}.




{\color{blue}\#\#\#\#\#\#\#\# examples of the meshing procedure \\[5pt]}
