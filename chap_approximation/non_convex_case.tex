\section{Approximation Error for the Non--Convex Case}
\label{sec:non_convex_case}
Our main approximation error Theorem will be the following statement:
There exists a family of anisotropic graded meshes
$\{\Th\}_{{\textit{h}}\downarrow 0}\,$
made up of
prisms, tetrahedra and pyramids 
for which 
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bu_{\textit{h}}\|_{0,\Omega}&\leqslant &C {\textit{h}} \|f\|_{0,\Omega}\\[5pt]
  \|p-p_{\textit{h}}\|_{0,\Omega}&\leqslant &C \textit{h} \|f\|_{0,\Omega}
\end{IEEEeqnarray*}
with $\textit{h}$ being smaller than  $C N_{\textit{h}}^{\nicefrac{-1}{3}}$, where
$N_{\textit{h}}$ is the  number of elements in $\Th$.

The rest of the chapter contains its proof, which is summarized at the end of it.
To avoid what would result in a proof causing weariness we decided to partition
the proof in subsections, paragraphs and items. The first part of the proof
will be the exhibition of the meshes and after that we will prove the estimates.
%=====================================================
%{\color{BrickRed}\paragraph{TODO} % (fold)
%\label{par:todo}
%ver qu'e pasa con lo de distance to the vertices, distance to de 
%singular vertices.
%
%ver si se acomoda definiendo $\lambda_e, \lambda_v$ como $+\infty$ en caso de
%ser arista o v'ertice regulares, y as'i poder usar las cotas con las 
%distancias al \'unico v\'ertice o arista de cada macroelemento, etc...
%}
%=====================================================
\subsection{Meshes and Meshing Procedure in Dimension $3$}\label{meshes}
%%=========== GRADING ==============================================
Our procedure starts taking a first partition of $\Omega$
into macro--elements, which may be
prisms or tetrahedra, according to the main regularity result, 
Theorem~\ref{thm_regularity}. Read Section~\ref{sec:regularity} again and recall Figures~\ref{macro_prism_reg}  and~\ref{macro_tetra_reg}.
Here we recall it.

Let $\Omega=\cup_{\ell=1}^N \Lambda_\ell$ be 
a decomposition in
macro--elements having, each one of them,
at most a singular edge $\lambda_{\be}^{(\ell)}$ and a singular vertex
$\lambda_{\bv}^{(\ell)}$. 

Please recall also the notation for the distance  $R(\bx)$ to the singular vertex 
and the angular distance $\theta(\bx)$ to the singular edge in Definition~\ref{auxlabel300}.

We will show that, in each prismatic or tetrahedral macro--element, our meshes
fulfill the following grading. Given a macro--element $\Lambda_\ell$ with
just a singular edge $\be$, for
any element $E\subseteq\Lambda_\ell$ it holds
\begin{equation}\label{label_grading3}
\begin{IEEEeqnarraybox*}{lCl}
  h_{E,1}, h_{E,2} &\sim&
    \begin{cases}
      \textit{h}^{\frac{1}{\mu}}  & \text{ if\, }d(E,\be)=0\\
      \textit{h}\,d(E,\be)^{1-\mu}  & \text{ if\, }0<d(E,\be) < 1\\
      \textit{h}          & \text{ if\, }d(E,\be)\sim1
    \end{cases}\\[5pt]
  h_{E,3}   &\sim&\textit{h}
\end{IEEEeqnarraybox*}
\end{equation}
Given a macro--element $\Lambda_\ell$ with
just a singular vertex $\bv$, for
any element $E\subseteq\Lambda_\ell$ it holds
\begin{equation}\label{label_grading2}
\begin{IEEEeqnarraybox*}{lCl}
  h_{E,1}, h_{E,2}, h_{E,3}   &\sim& 
    \begin{cases}
      \textit{h}^{\frac{1}{\nu}}  & \text{ if\, }d(E,v)=0\\
      \textit{h}\,d(E,\bv)^{1-\nu}  & \text{ if\, }0<d(E,v)<1\\
      \textit{h}          & \text{ if\, }d(E,v)\sim1.
    \end{cases}
\end{IEEEeqnarraybox*}
\end{equation}
Given a macro--element $\Lambda_\ell$ with
a singular edge $\be$ and a singular vertex $\bv$ at an
endpoint of $\be$, for
any element $E\subseteq\Lambda_\ell$ it holds
\begin{equation}\label{label_grading}
\begin{IEEEeqnarraybox*}{lCl}
  h_{E,1}, h_{E,2} &\sim&
    \begin{cases}
      \textit{h}^{\frac{1}{\mu}}  & \text{ if\, }d(E,\be)=0\\
      \textit{h}\,d(E,\be)^{1-\mu}  & \text{ if\, }0<d(E,\be)<1\\
      \textit{h}          & \text{ if\, }d(E,\be)\sim1
    \end{cases}\\[5pt]
  h_{E,3}   &\sim& 
    \begin{cases}
      \textit{h}^{\frac{1}{\nu}}  & \text{ if\, }d(E,v)=0\\
      \textit{h}\,d(E,\bv)^{1-\nu}  & \text{ if\, }0<d(E,v)<1\\
      \textit{h}          & \text{ if\, }d(E,v)\sim1
    \end{cases}
\end{IEEEeqnarraybox*}
\end{equation}
with $\mu\leqslant 1-\delta$ for $\delta>1-\lambda_{\be}$ and 
$\nu\leqslant 1-\beta$ for $\beta>\frac12-\lambda_{\bv}$ for all cases, 
respectively, and with $\mu\leqslant\nu<1$ in the presence of both
singularities.
%%==================================================================
\subsubsection{Macro--element with singular edge and singular vertex}\label{caso4}
Let $\Lambda$ be a tetrahedral macro--element with vertices $P_0, P_1, P_2$ and $P_3$.
We suppose that $P_0$ is the singular vertex and that the
singular edge is $P_0P_1$. The mesh $\pazocal T_h$ on $\Lambda$ will 
contain tetrahedra, prisms and pyramids. 
In Tables~\ref{prisms_barycentric_a}--\ref{tetrahedral_barycentric}
we explicit the elements in terms
of the barycentric coordinates of the vertices of each element corresponding to 
the ordered vertices $P_0, P_1, P_2$ and $P_3$.
\bigskip

\prismsBaryCoordA                        %% tables of coordinates

\prismsBaryCoordB

\pyramidsBaryCoord

\tetrahedraBaryCoord
In Figure~\ref{aux_label70} there are a couple of examples.
\begin{figure}
  \centering
  \subfloat[$n=0$]
  {
    \tetrahedralmacroelementA
  }\hspace{1cm}
  \subfloat[$n=1$]
  {
    \tetrahedralmacroelementB
  }\hspace{1cm}
  \subfloat[$n=2$]
  {
    \tetrahedralmacroelementC
  }\\
  \subfloat[$n=3$]
  {
    \tetrahedralmacroelementD
  }\hspace{1cm}
  \subfloat[$n=4$]
  {
    \tetrahedralmacroelementE
  }\hspace{1cm}
  \subfloat[$n=5$]
  {
    \tetrahedralmacroelementF
  }
  \caption{Tetrahedral macro--elements with singularities of both types.}
  \label{aux_label70}
\end{figure}
\newpage
\subsubsection{Macro--element with a singular edge}
This case corresponds to the prismatic macro--element as well as the
tetrahedral macro--element of Subsubsection~\ref{caso4} but only with
a singular edge. Therefore, we only need to present the meshing for the former case.
A mesh in the prismatic macro--elements is constructed as the cartesian product 
between a graded mesh
in a triangle and a quasi--uniform mesh along the singular edge. % Table~\ref{prisms_product} shows the points
For $0\leqslant i\leqslant n$ and $0\leqslant j\leqslant n-1$ let $p_{i,j}$
be the point with barycentric coordinates, with respect to $P_0,P_1,P_2$,
equal to      
\begin{eqnarray*}
&&\lambda_0(i,j)=1-\lambda_1(i,j)-\lambda_2(i,j),\\[5pt]
&&\lambda_1(i,j)=\frac in\left(\frac{i+j}n\right)^{\nicefrac{1}{\mu}-1},\quad
  \lambda_2(i,j)=\frac jn\left(\frac{i+j}n\right)^{\nicefrac{1}{\mu}-1},\quad
\end{eqnarray*}
Now let $\Tb$ the family of triangles with vertices
\begin{IEEEeqnarray*}{lllCLL}
p_{i,j} & p_{i+1,j} & p_{i,j+1} & \quad & 0\leqslant i  < n\mbox{,\quad}&0\leqslant j < n - i\\
p_{i,j} & p_{i+1,j-1} & p_{i+1,j} & \quad & 0\leqslant i  < n-1\mbox{,\quad}&1\leqslant j < n - i.
\end{IEEEeqnarray*}
The elements in $\Lambda_\ell$ will be
$\tau\times (P_{0,3} + \frac kn h_{\Lambda_\ell,3}, P_{0,3} + \frac{k+1}{n} h_{\Lambda_\ell,3})$
for each $\tau\in\Tb$ and each $0\leqslant k<n$. See Figure~\ref{prismatic_macroelements}.
%borrar ---->>>  \prismsProductCoord

\def\col{black}
\def\singCol{red}
\begin{figure}[!h]\centering
  \subfloat
  {
    \begin{tikzpicture}[scale=2]
      \prismaticMacroelement{8}{2}{.63}{4}{\col}{\singCol}
    \end{tikzpicture}\hspace{1cm}
    \begin{tikzpicture}[scale=2]
      \prismaticMacroelement{8}{3}{.63}{4}{\col}{\singCol}
      \draw[red] (0,0,0) -- (0,-1.5,0);
    \end{tikzpicture}\hspace{1cm}
    \begin{tikzpicture}[scale=2]
      \prismaticMacroelement{8}{4}{.63}{4}{\col}{\singCol}
      \draw[red] (0,0,0) -- (0,-1.5,0);
    \end{tikzpicture}
  }
  \caption{Elements of the family of
    meshes restricted to a prismatic macro--element.$\mu = .63$}
  \label{prismatic_macroelements}
\end{figure}

\subsubsection{Macro--element with a singular vertex}
\label{auxlabel302}
We consider again a tetrahedral macro--element $T$ with vertices $P_0, P_1, P_2$
and $P_3$, assuming that it has a singular vertex at $P_0$ and no singular edge.
We construct a triangulation of $T$ made of tetrahedra describing 
the barycentric coordinates of the vertices of each tetrahedron with respect
to $P_0, P_1, P_2$ and $P_3$. %This case corresponds to Case 1 of \cite{AN}.

Let $p_{i,j,k}$ be the points with barycentric coordinates
\begin{eqnarray*}
&&\lambda_0=1-\lambda_1-\lambda_2-\lambda_3,\\[5pt]
&&\lambda_1=\tfrac in\left(\tfrac{i+j+k}n\right)^{\nicefrac{1}{\mu}-1},\quad
  \lambda_2=\tfrac jn\left(\tfrac{i+j+k}n\right)^{\nicefrac{1}{\mu}-1},\quad
  \lambda_3=\tfrac kn\left(\tfrac{i+j+k}n\right)^{\nicefrac{1}{\mu}-1}
\end{eqnarray*}
for $0\leqslant i\leqslant n$, $0\leqslant j\leqslant n-i$, $0\leqslant k\leqslant n-i-j$.
Then, the tetrahedra are the $n^3$ ones with the following vertices
\begin{IEEEeqnarray*}{lcl}
p_{i,j,k}, p_{i+1,j,k}, p_{i,j+1,k}, p_{i,j,k+1}, &\quad& 0\leqslant i+j+k\leqslant n-1\mbox{,}\\
p_{i+1,j,k}, p_{i,j+1,k}, p_{i,j,k+1}, p_{i+1,j,k+1}, &\quad& 0\leqslant i+j+k\leqslant n-2\mbox{,}\\
p_{i,j+1,k}, p_{i,j,k+1}, p_{i+1,j,k+1}, p_{i,j+1,k+1}, &\quad& 0\leqslant i+j+k\leqslant n-2\mbox{,}\\
p_{i+1,j,k}, p_{i,j+1,k}, p_{i+1,j+1,k}, p_{i+1,j,k+1}, &\quad& 0\leqslant i+j+k\leqslant n-2\mbox{,}\\
p_{i,j+1,k}, p_{i+1,j+1,k}, p_{i+1,j,k+1}, p_{i,j+1,k+1}, &\quad& 0\leqslant i+j+k\leqslant n-2\mbox{,}\\
p_{i+1,j+1,k}, p_{i+1,j,k+1}, p_{i,j+1,k+1}, p_{i+1,j+1,k+1}, &\quad& 0\leqslant i+j+k\leqslant n-3.
\end{IEEEeqnarray*}


\begin{proposition} Pyramids and tetrahedra in the meshes in Subsection~\ref{meshes}  are isotropic.
\end{proposition}
\begin{proof} It is enough to prove the proposition
for pyramids, as the proof for tetrahedra is analogue
(each tetrahedra
in a macroelement with hybrid mesh shares two faces with pyramids).
Consider a pyramid with vertices $p_0, \ldots, p_4$ in a 
macro--element of vertices $P_0,P_1,P_2$ and $P_3$ as in Subsection~\ref{caso4}.
With $|p_i-p_j|$ or $|P_i-P_j|$ we mean euclidean distance.
Note that the basis of the pyramid is the paralelogram $p_0p_1p_3p_2$ with
\begin{eqnarray}
\label{once}
&&p_1-p_0=p_3-p_2=\tfrac1n\left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}-1}(P_3-P_2)\\
\label{doce}
&&p_2-p_0=p_3-p_1=\left[\left(\tfrac{n-l}n\right)^{\nicefrac{1}{\mu}}-\left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}}\right](P_0-P_1).
\end{eqnarray}
So there hold
\begin{IEEEeqnarray*}{rCl}
  \tfrac{\nicefrac{1}{\mu}}{n}\left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}-1}|P_0-P_1|
  & \leqslant & |p_2-p_0|=|p_3-p_1| \\[4pt]
  & \leqslant &
  \tfrac{\nicefrac{1}{\mu}}{n}\left(\tfrac{n-l}n\right)^{\nicefrac{1}{\mu}-1}|P_0-P_1|\mbox{,}
\end{IEEEeqnarray*}
and 
\[
\mu\left(\tfrac12\right)^{\nicefrac{1}{\mu}-1}\leqslant\mu\left(\tfrac{n-l-1}{n-l}\right)^{\nicefrac{1}{\mu}-1}\leqslant\tfrac{|p_1-p_0|}{|p_2-p_0|}\leqslant \mu.
\]
Then the parallelogram $p_0p_1p_3p_2$ is shape-regular since the angle between $P_0-P_1$ and $P_3-P_2$ depends only on the macro--element, and so it is away from $0$ and $\pi$. 

Now we prove that there exists constants $c_0$ and $c_1$ depending only on
 $\nicefrac{1}{\mu}$ and the vertices of the macro--element such that
\begin{IEEEeqnarray}{rCcCl}
\label{diez}
c_0&\leqslant&\tfrac{|p_4-p_2|}{|p_2-p_0|}&\leqslant& c_1
\end{IEEEeqnarray}
and  
\begin{IEEEeqnarray}{rCcCl}
\label{trece}
c_0&\leqslant&\tfrac{|p_4-p_3|}{|p_2-p_0|}&\leqslant& c_1.
\end{IEEEeqnarray}
After simple computations we obtain
\begin{eqnarray*}
p_4-p_2 &=& \left[\left(\tfrac{n-l}n\right)^{\nicefrac{1}{\mu}} - \left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}}\right](P_3-P_0) \\ &&\qquad + \tfrac in \left[\left(\tfrac{n-l}n\right)^{\nicefrac{1}{\mu}-1} - \left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}-1}\right](P_2-P_3)\\ &=& \left[\left(\tfrac{n-l}n\right)^{\nicefrac{1}{\mu}} - \left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}}\right]\bigg\{P_3-P_0 +\\ &&\qquad + \tfrac{\tfrac in \left[\left(\tfrac{n-l}n\right)^{\nicefrac{1}{\mu}-1} - \left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}-1}\right]}{\left[\left(\tfrac{n-l}n\right)^{\nicefrac{1}{\mu}} - \left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}}\right]} (P_2-P_3)\bigg\}\\ &\sim& \left[\left(\tfrac{n-l}n\right)^{\nicefrac{1}{\mu}} - \left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}}\right](P_3-P_0)\\ &\sim& p_3-p_1
\end{eqnarray*}
where we used the following relation 
\[
  \tfrac{\tfrac in \left[\left(\tfrac{n-l}n\right)^{\nicefrac{1}{\mu}-1} - \left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}-1}\right]}{\left[\left(\tfrac{n-l}n\right)^{\nicefrac{1}{\mu}} - \left(\tfrac{n-l-1}n\right)^{\nicefrac{1}{\mu}}\right]}\leqslant \tfrac{\nicefrac{1}{\mu}-1}{\nicefrac{1}{\mu}},
\]
and also that the angle between $P_3-P_0$ and $P_2-P_3$ is fixed
(and depends only on the macro--element) and equation~\eqref{doce}. 
This proves~\eqref{diez}. Inequalities in~\eqref{trece} follow analogously. 
To finish the proof of the isotropy of the pyramids we have to observe that the 
basis $p_0p_1p_3p_2$ is contained in a plane ${\Pi}_1$ that is parallel to the one generated 
by the directions $P_1-P_0$ and $P_3-P_2$, and the face $p_2p_3p_4$ is in a 
plane parallel to the plane ${\Pi}_2$ in which lies the triangle $P_0P_2P_3$ 
(this is a face of the macro--element), 
and the angle between  planes ${\Pi}_1$ and ${\Pi}_2$ depends only on the macro--element.      
\end{proof}
%===========================================================
%Another way, less formal but clearer, to look
%at the  mesh points in a tetrahedral macro--element
%with both kinds of singularities is the following.
%
%Fijamos:
%\begin{IEEEeqnarray*}{rCl}
%  T &=& \left[\textbf{p}_0,\textbf{p}_1,\textbf{p}_2,\textbf{p}_3\right]\\[7pt]
%  \textbf{p}_0 &=& 0\\[7pt]
%  \left[\textbf{p}_0,\textbf{p}_3\right] &=& 
%  \text{la arista singular}\\[7pt]
%  \textbf{p}_3 & = & \text{v\'ertice singular}\\[7pt]
%  \left[\textbf{p}_0, \textbf{p}_1, 
%  \textbf{p}_2\right]&\subseteq&\{z=0\}.
%\end{IEEEeqnarray*}
  %
%$\lambda_0,\lambda_1$ y $\lambda_2$: {\color{RedOrange}coordenadas  baric\'entricas} con respecto a
%$\textbf{p}_0,\textbf{p}_1$ y $\textbf{p}_2$.\\[10pt]
%$\textbf{p}_{i,j}$ es tal que\\[5pt]
%\begin{IEEEeqnarray*}{rCl}
%  \lambda_0(\textbf{p}_{i,j})  &=& 1-\lambda_1(\textbf{p}_{i,j}) - \lambda_2(\textbf{p}_{i,j}) \\[5pt]
%  \lambda_1(\textbf{p}_{i,j})  &=& \frac{i}{n}\left(\frac{i+j}{n}\right)^{\frac{1}{\mu}-1}\\[5pt]
%  \lambda_2(\textbf{p}_{i,j})  &=& \frac{j}{n}\left(\frac{i+j}{n}\right)^{\frac{1}{\mu}-1}.\\[15pt]
%  &&0\leqslant i\leqslant n\\[5pt]
%  &&0\leqslant j\leqslant n-i
%\end{IEEEeqnarray*}
  %
%Los puntos son la uni\'on de\\[5pt]
%\begin{IEEEeqnarray*}{lCl}
%  \left\{ \textbf{p}_{i,j}\,:\,0\leqslant i\leqslant n,\quad
%    0\leqslant j\leqslant n-i \right\}&&\\[7pt]
%  \left\{ \textbf{p}_{i,j}\,:\,0\leqslant i\leqslant n-1,\quad
%  0\leqslant j\leqslant n-1-i \right\} & \quad+\quad & 
%  [{\scriptstyle 1-\left(\frac{n-1}{n}\right)^{1/\mu}}]\,\textbf{e}_3\\[7pt]
%  \IEEEeqnarraymulticol{3}{c}{\vdots}\\[7pt]
%  \left\{\textbf{p}_{i,j}\,:\,0\leqslant i\leqslant n-k,\quad
%  0\leqslant j\leqslant n-k-i \right\} & \quad+\quad &
%  [{\scriptstyle 1-\left(\frac{n-k}{n}\right)^{1/\mu}}]\,\textbf{e}_3\\[7pt]
%  \IEEEeqnarraymulticol{3}{c}{\vdots}\\[7pt]
%  \left\{ \textbf{p}_{i,j}\,:\,0\leqslant i\leqslant 1,\quad
%  0\leqslant j\leqslant 1-i \right\} & \quad+\quad &
%  [{\scriptstyle 1-\left(\frac{1}{n}\right)^{1/\mu}}]\,\textbf{e}_3\\[10pt]
%  \IEEEeqnarraymulticol{3}{l}{\left\{\textbf{e}_3\right\}}\text{,}
%\end{IEEEeqnarray*}
%i.e.:
%\begin{IEEEeqnarray*}{rCl}
%  \mathcal{P} & = & \bigcup_{k=0}^n\;\left\{ \textbf{p}_{i,j}\,:\,0\leqslant i\leqslant n - k,\quad
%  0\leqslant j\leqslant n-k-i \right\}\\[8pt]
%  &&\quad+\,[{\scriptstyle1-\left(\frac{n-k}{n}\right)^{1/\mu}}]\,\textbf{e}_3.
%\end{IEEEeqnarray*}
%===========================================================
\begin{remark}\label{auxlabel216}
  Our meshes sastify the property that for each $\ell$ and each $\textit{h}$
  there exists an index set $I_{\textit{h},\ell}$ such that
  \begin{IEEEeqnarray*}{rCl}
    \Lambda_\ell = \cup_{i\in I_{\textit{h},\ell}} E_{\textit{h},i}.
  \end{IEEEeqnarray*}
  In this case we are denoting 
  $\Th = \{E_{\textit{h},i}\,:\,1\leqslant i\leqslant N_{\textit{h}}\}$.
\end{remark}
This means the meshes resolve the macro--elements in a conforming way and
refinement is done whithin the macro--elements of the 
initial mesh.
\begin{remark} 
We remark that if a mesh satisfies conditions~(\ref{label_grading}
for $\mu=\mu_0$ and $\nu=\nu_0$, then it satisfies the same for 
$\mu>\mu_0$ and $\nu>\nu_0$. Thus, the mesh can be constructed for 
$\mu_0=\nu_0=1-\gamma$ with $1>\gamma>\max\{1-\lambda_e,\frac12-\lambda_v\}$, 
and it still verifies the former conditions. 
The possibility to use $\mu_0=\nu_0$ for the construction of the mesh 
allows us to validate the assumptions at the beginning of Section~\ref{auxlabel290}.  

Therefore, we assume that the mesh $\Th$ on a macroelement $\Lambda_\ell$
with a singular edge 
$\be$ and a singular vertex $\bv$ 
satisfies conditions~\eqref{label_grading} 
for $\mu,\nu\geqslant 1-\gamma$. And in particular, those conditions hold
for $\mu=1-\delta$ for some $\delta>1-\lambda_{\be}$ and for $\nu=1-\beta$ 
for some $\beta>\frac12-\lambda_{\bv}$. 

For the case of a tetrahedral macroelement with just a singular edge, which is 
assumed to have a face $f$ perpendicular to the singular edge, 
we assume that it is meshed as in the case in
which the opposite vertex to the face $f$ is singular, satisfying 
conditions~\eqref{label_grading} with $\mu=\nu=1-\delta$.
This assumption does not affect the asymptotic relation between 
$\textit{h}$ and the number of elements.


We remark that if a mesh satisfies~(\ref{label_grading})
for $\mu=\mu_0$ and $\nu=\nu_0$, then it satisfies the
same for $\mu>\mu_0$ and $\nu>\nu_0$. Thus, the mesh can be overrefined by
taking $\mu=\nu=\min\{1-\delta,1-\beta\}$, and it still
verifies~(\ref{label_grading}) for
$\min\{1-\delta,1-\beta\}\leqslant\mu\leqslant 1-\delta$ and
$\min\{1-\delta,1-\beta\}\leqslant\nu\leqslant 1-\beta$. The possibility to use $\mu=\nu$
for the construction of the mesh, allows to validate condition stating
that tetrahedra and pyramids in $\Th$ are not necessarily anisotropic.
\end{remark}
\begin{remark}
If the diameter $\delta(\Lambda)$ of a macro--element $\Lambda$ were greater than $1$, 
then
\begin{IEEEeqnarray*}{rCl}
  R_K(\bx) & \leqslant & \delta(\Lambda)\min\{ R_K(\bx), 1\}
\end{IEEEeqnarray*}
so we will assume $R_K(\bx)\leqslant 1$.
\end{remark}
\begin{remark}
  $\mu < 1 \Rightarrow \mu \leqslant \nu$.
\end{remark}