\section{Main Approximation Error Theorem}
\label{auxlabel400}
\begin{theorem}\label{auxlabel11}
%=============================================================================
% {\color{BrickRed} poner esto en la intro como objetivo de todo el texto que sigue y
% el enunciado este, entero, ponerlo al final, en donde digo lo de la $\bw_{\bu}$ \\
% no, ojo que las mallas las estoy queriendo poner antes ... pensarlo}
%=============================================================================
Let $\Omega$ be a polihedral domain in $\mathbb{R}^3$, let $f\in L^2(\Omega)$ and 
let $(\bu,p)$ and 
$(\bu_{\textit{h}},p_{\textit{h}})$ 
be the solutions of Problems~\ref{weakMixedContinuous}
and~\ref{mixedDiscrete} respectively. There exists a family of anisotropic meshes
$\{\Th\}_{{\textit{h}}\to 0}\,$
made up of
prisms, tetrahedra and pyramids,  graded according to~\eqref{label_grading3}--\eqref{label_grading} 
for which 
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bu_{\textit{h}}\|_{0,\Omega}&\leqslant &C {\textit{h}} \|f\|_{0,\Omega}\\[5pt]
  \|p-p_{\textit{h}}\|_{0,\Omega}&\leqslant &C \textit{h} \|f\|_{0,\Omega}
\end{IEEEeqnarray*}
with $\textit{h}$ being smaller than  $C N_{\textit{h}}^{\nicefrac{-1}{3}}$, where
$N_{\textit{h}}$ is the  number of elements in $\Th$.
\end{theorem}
\begin{proof}
Recall from inequality~(\ref{aux_label48})  for every $\bw\in W(\Th)$ it holds
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bu_h\|_{L^2(\Omega)^3} &\leqslant& C\{\|\bu-\br_0\bu\|_{L^2(\Omega)^3} + \|\bu-\bw\|_{L^2(\Omega)^3}\}.
\end{IEEEeqnarray*}
For each $\bw$ we decompose the norm with the macro--elements as follows
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bw\|^2_{0,\Omega} &=& \sum_{\ell=1}^{N_{\textit{h}_0}} \|\bu-\bw\|^2_{0,\Lambda_\ell}\\
\IEEEeqnarraymulticol{3}{r}{
    =\,\sum_{\ell=1}^{N_{\textit{h}_0}} \left\{
\sum_{\substack{{\scriptscriptstyle{\text{prisms\,}}E_\ell}\\E_\ell\subseteq\Lambda_\ell}}
      \|\bu-\bw\|^2_{\scriptscriptstyle 0,E_\ell} +
\sum_{\substack{{\scriptscriptstyle{\text{tetrahedra\,}}E_\ell}\\E_\ell\subseteq\Lambda_\ell}}
      \|\bu-\bw\|^2_{\scriptscriptstyle 0,E_\ell} +
\sum_{\substack{{\scriptscriptstyle{\text{pyramids\,}}E_\ell}\\E_\ell\subseteq\Lambda_\ell}}
      \|\bu-\bw\|^2_{\scriptscriptstyle 0,E_\ell}
    \right\} 
}
\end{IEEEeqnarray*}
%%=========================================================================
%For each macro--element $\Lambda_\ell$, for each pyramid $E_\ell\in\Lambda_\ell$,
%\begin{IEEEeqnarray*}{rCl}
%  \|\bu_s - \pi\bu_s\|^2_{\sss L^2(E)}&\leqslant&
%  h_1^2\|\gancho_{\xi_1}\bu_s\|^2+
%  h_2^2\|\gancho_{\eta_2}\bu_s\|^2+
%  h_3^2\|\gancho_{\xi_3}\bu_s\|^2+
%  h_K^2\|\dvg\bu_s\|^2\\[7pt]
%\end{IEEEeqnarray*}
%\begin{IEEEeqnarray*}{rCl}
%  h_1\|\gancho_{\xi_1}\bu_s\|&=&
%  h_1\sum_{i=1}^3 \|\gancho_{\xi_1}\bu_{s,i}\|\\
%  &\leqslant&
%    \textit{h}\sum_{i=1}^3 \|r^{1-\mu}\gancho_{\xi_1}\bu_{s,i}\|\\
%  &\leqslant&
%    \textit{h}\left(
%     \sum_{i=1}^2 \|R^{1-\mu}\theta^{1-\mu}\gancho_{\xi_1}\bu_{s,i}\|+
%     \|R^{1-\mu}\gancho_{\xi_1}\bu_{s,3}\|\right)\\[7pt]
%  &\leqslant&
%    \textit{h}\left(
%     \sum_{i=1}^2 \|R^{1-\nu}\theta^{1-\mu}\gancho_{\xi_1}\textbf{u}_{s,i}\|+
%     \|R^{1-\nu}\gancho_{\xi_1}\textbf{u}_{s,3}\|\right)\\[7pt]
%  &\leqslant&
%    \textit{h}\left(
%    \sum_{i=1}^2 \|R^{\beta}\theta^{\delta}\gancho_{\xi_1}\textbf{u}_{s,i}\|+
%     \|R^{\beta}\gancho_{\xi_1}\textbf{u}_{s,3}\|\right)\\[7pt]
%  &\leqslant&
%    \textit{h}
%    \left(\sum_{i=1}^2 \|\textbf{u}_{s,i}\|_{\scriptscriptstyle \beta,\delta}+
%         \|\textbf{u}_{s,3}\|_{\scriptscriptstyle \beta,0}\right).
%\end{IEEEeqnarray*}
%%=========================================================================
and then take $\bw_{\bu}$ as in Definition~\ref{aux_label51}.
For the sum term over the pyr\-amids (remember pyr\-amids do not touch singularities)
we have, restricting $\bw_{\bu}$, by the inequality we proved
in~(\ref{aux_label63})  for pyramids,
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bw_{\bu}\|^2_{0,E_\ell} & = & \|\bu-P_{0,E_{\ell}}\bu\|^2_{0,E_\ell}\\[4pt]
                           & \leqslant & C \left\{h_E|\bu_r|_{H^1(E_\ell)^3} 
                                + h_E|\bu_s|_{H^1(E_\ell)^3}\right\}\\[4pt]
                           & \leqslant & C\textit{h}\left\{ |\bu_r|_{H^1(E_\ell)^3} 
                              + \|\bu_s\|_{\pazocal{V}_{\beta,\delta}(E)}\right\}.
\end{IEEEeqnarray*}
With this and all the others for prisms and tetrahedra within the proof of the
interpolation Theorem~\ref{interpolation_theorem} we have
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bw_{\bu}\|^2_{0,\Omega}
    &=& \sum_{\ell=1}^{N_{\textit{h}_0}} \Bigg\{
\sum_{\substack{{\scriptscriptstyle{\text{prisms\,}}E_\ell}\\E_\ell\subseteq\Lambda_\ell}}
      \|\bu-\br_0\bu\|^2_{\scriptscriptstyle 0,E_\ell} +
\sum_{\substack{{\scriptscriptstyle{\text{tetrahedra\,}}E_\ell}\\E_\ell\subseteq\Lambda_\ell}}
      \|\bu-\br_0\bu\|^2_{\scriptscriptstyle 0,E_\ell}\\[7pt] 
\IEEEeqnarraymulticol{3}{R}{
      +\,
\sum_{\substack{{\scriptscriptstyle{\text{pyramids\,}}E_\ell}\\E_\ell\subseteq\Lambda_\ell}}
      \|\bu-P_{0,E_{\ell}}\bu\|^2_{\scriptscriptstyle 0,E_\ell}
    \Bigg\}
}\\[5pt]
\yesnumber\label{aux_label62}
    &\leqslant& C \sum_{\ell=1}^{N_{\textit{h}_0}}
      \textit{h}^2 \|f\|^2_{0,\Omega} \, \leqslant \,  C\,\textit{h}^2 \|f\|^2_{0,\Omega}.
\end{IEEEeqnarray*}
Note $C$ depends on the cardinal of the initial mesh.
Now by Theorem~\ref{interpolation_theorem} and~(\ref{aux_label62}) we have, for 
the vectorial variable, 
$\|\bu-\bu_h\|_{L^2(\Omega)^3} \leqslant C\textit{h}\|f\|_{L^2(\Omega)}$.
For the scalar variable estimate we may do
\begin{IEEEeqnarray*}{rCl}
  \|p-p_{\textit h}\|_{0,\Omega} &\leqslant& \|p - P_0 p\|_{0,\Omega} + \|P_0 p - p_{\textit h}\|_{0,\Omega}
\end{IEEEeqnarray*}
and then apply Theorem~\ref{interpolation_theorem} to the first term and 
Theorem~\ref{aux_label47} to the second and reuse the error 
estimate for the vectorial variable.
\end{proof}
