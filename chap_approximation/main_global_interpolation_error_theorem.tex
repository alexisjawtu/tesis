\section{Main Global Interpolation Error Theorem}
In the present section we perform the anisotropic approximation error estimates
over the meshes we constructed in the previous section.

To estimate the error, we start with inequality~(\ref{aux_label48}) of
Theorem~\ref{aux_label47} and work with each term in the right--hand side
in the non--convex case.

As in the meshing algorithm we proposed the pyramids turned out to be isotropic,
we may use Proposition~\ref{propErrorInterpolacionPiramidesTetraedros} as the
local interpolation estimate which.
Nevertheless, starting with the anisotropic Finite Element stability estimates
we proved in Theorem~\ref{aux_label53}  and in Theorem~\ref{aux_label54}   
we could arrive at inequalities of the form~(\ref{aux_label39}) and~(\ref{aux_label55})
for the interpolation operators determined by the 
finite elements in Definitions~\ref{aux_label50} and~\ref{aux_label71}
and the estimates in terms of weighted norms would follow exactly as the ones
we will perform in short for $h_E|u|_{1,E}$.                        %%%  At the end of this proof we include weighted

The following is the main interpolation error theorem.
\begin{theorem}\label{interpolation_theorem} Let $\Omega$ and $f$ be the data and $(\bu,p)$ be the 
solution
of Problem~\ref{weakMixedContinuous}. Let  $\br_0$ be the operator~(\ref{global_interpolator}), then
  \begin{IEEEeqnarray}{rCl}
  \label{auxlabel75}
    \|\bu-\rZerou\|_{0,\Omega} &\leqslant& C \textit{h}\|f\|_{0,\Omega}\\[5pt]
  \label{auxlabel76}
    \|p-P_{\scriptscriptstyle \Th}p\|_{0,\Omega} &\leqslant& 
    {\color{Orange}\mbox{>}C \textit{h}\|f\|_{0,\Omega}\mbox{ o bien }C \textit{h}\|p\|_{1,\Omega}\mbox{?}}.
  \end{IEEEeqnarray}
\end{theorem}

\begin{remark}
  The operator~(\ref{global_interpolator}) is well defined because, for any
  polyhedral element considered, for any of its faces, if a field $\bv$ of the discrete
  global space has all
  the
  degrees of freedom with respect to that face equal to zero, then the restriction
  of $\bv$ to that face vanishes identically.
\end{remark}

\section{Proof of Theorem~\ref{interpolation_theorem}}
Start splitting the field $\bu$ as in~(\ref{splitting}).

By Lemma~\ref{well_defined_dofs}, the field $\rZerou = \br_0\bu_s + \br_0\bu_r$ 
is well defined, so we will work 
with the regular part $\bu_r - \br_0\bu_r$ and the singular part $\bu_s - \br_0\bu_s$
separately. The bound for the error of the interpolation of the singular part will be 
performed in each type of macro--element.

First we'd like to remark that, for a given macro--element in 
$\pazocal{T}_{\textit{h}_0}$ the case when there is no weight with respect to 
the distance $R(\bx)$
to the vertex is also available by simply putting 
$R\equiv 1$ in the computations we show. The case when there is no weight with 
respect to the angular distance
$\theta(\bx)$ is also available by simply putting 
$\theta\equiv 1.$ Additionally, if $\be$ is not singular, the condition for 
$\delta$ in~(\ref{label_grading}) 
turns $\delta > -\infty$ and if $\bv$ is not singular, the condition for $\beta$
turns $\beta > -\infty.$

Now it is the time to make a remark of crucial importance. If we take the
solution $(\bu, p)$ of Problem~\ref{mixedContinuous},
the singular part of the vectorial variable, $\bu_s$, has a well defined $H(div, \Omega)$--conforming interpolate.
This is implied by the next result, since the normal traces on faces
of the elements in $W^{1,1}(\Lambda_\ell)$ are well defined.
\begin{lemma}\label{well_defined_dofs}
If $\beta,\delta\in[0,1)$ and $\beta + \delta\leqslant 1$ then 
\[
  V^{1,2}_{\beta,\delta}(\Lambda_\ell) \subseteq W^{1,1}(\Lambda_\ell)
\]
for all macro--element $\Lambda_{\ell}$.
\end{lemma}
\begin{proof}
Every function ${\bv}\in V^{1,2}_{\beta,\delta}(\Lambda_\ell)$ has a finite
$L^1(\Lambda_\ell)$ norm. On the other hand,
\[
  R^{-\beta}\theta^{-\delta}\leqslant\left(\max_{\bx
  \in\Lambda_\ell}R(\bx)^\delta\right)
  r^{-\beta-\delta}
  \leqslant C r^{-\beta-\delta}\in L^2(\Lambda_\ell)
\]
which implies $\partial^\alpha{\bv}\in L^1(\Lambda_\ell)$ for all
$\bv\in V^{1,2}_{\beta,\delta}(\Lambda_\ell)$.
\end{proof}


\noindent{\color{Orange}\#\#\#\#\#\#\# **bound for the scalar variable: para todos igual,
lo pongo una sola vez. c\'omo lo ponemos?} 
%%======================================================================================= 
% Recall that $\|\bw\|^2_{\mathbb{V}} = \|\bw\|^2_{0,\Omega} + \|\dv\,\bw\|^2_{0,\Omega}$ 
% and that, 
% First, for the divergence term,
% Primero usar el lemma de taylor promediado aplicado al caso sin derivar. Despu'es:
% If we apply this after the commutative diagram property~(\ref{div_commutativity})
% \begin{IEEEeqnarray*}{rCl}
% \|\dv(\bu - \rZerou)\|^2_{0,\Omega} & = &
%   \|\dv\,\bu - \dv\,\rZerou\|^2_{0,\Omega}\\
%     & = &\|\dv\,\bu - \boldsymbol{P}_{\pazocal{T}_h}\dv\,\bu\|^2_{0,\Omega}\\
%   &\leqslant&\textit{h}^2\,\|\dv\,\bu\|^2_{0,\Omega}\\
%   &=&\textit{h}^2\,\|f\|^2_{0,\Omega}.|
% \end{IEEEeqnarray*}
%%======================================================================================= 
\subsection{Bound for the Regular Part in~(\ref{auxlabel75})} % (fold)
\label{sub:bound_for_the_regular_part}

Take any macro--element $\Lambda_\ell$. Given an element $E\subset\Lambda_\ell$, 
let $\boldsymbol{h}=(h_{1},h_{2},h_{3})'$. By Theorem~\ref{aux_label46}
\begin{IEEEeqnarray*}{rCl}
  \|\bu_r - \br_0\bu_r\|_{L^2(\Omega)}^2 & = &
  \sum_{E\in\Th}
  \|\bu_r - \br_0\bu_r\|_{L^2(E)}^2\\
\IEEEeqnarraymulticol{3}{l}{\qquad
  \leqslant\,C\,\sum_{E\in\Th}\left( \sum_{|{\balpha}| = 1} 
  \boldsymbol{h}^{\balpha} \|\partial^{\balpha}\bu_r\|_{L^2(E)} + 
  h_E\|\dv\bu_r\|_{L^2(E)}
  \right)^2
}
  \\[5pt]
\IEEEeqnarraymulticol{3}{l}{\qquad
  \leqslant\,\sum_{E\in\Th}\left\{\sum_{|{\balpha}| = 1}
  \boldsymbol{h}^{2{\balpha}} + h_E^{2} \right\}
  \left\{\sum_{|{\balpha}| = 1}\|\partial^{\balpha}\bu_r\|_{L^2(E)}^2 + 
  \|\dv\bu_r\|_{L^2(E)}^2\right\}.
}
\end{IEEEeqnarray*}
\noindent{\color{Orange}\#\#\#\#\#\#\# aca hay que poner la interpolacion en piramides
aparte tambien.} 
Now following the grading~(\ref{label_grading}) it holds
$\boldsymbol{h}^{\balpha}\leqslant C\,\textit{h}$ and $h_E \leqslant C\,h_3 \sim \textit{h}$ 
for all the elements of the
  mesh, so the last expression is bounded above by
\begin{IEEEeqnarray*}{lCl}
  C^2\sum_{E\in\Th}4\,\textit{h}^{2}
  \left\{\sum_{|{\balpha}| = 1}\|\partial^{\balpha}\bu_r\|_{L^2(E)}^2 + 
  \|\text{div}\bu_r\|_{L^2(E)}^2\right\}
  &=&\qquad\\[5pt]
\IEEEeqnarraymulticol{3}{R}{
  =\,C\,\textit{h}^{2}
  \left\{\sum_{|{\balpha}| = 1}\|\partial^{\balpha}\bu_r\|_{L^2(\Omega)}^2 + 
  \|\text{div}\bu_r\|_{L^2(\Omega)}^2\right\}.
}
\end{IEEEeqnarray*}
Then, finally
\begin{IEEEeqnarray*}{rCl}
  \|\bu_r - \br_0\bu_r\|_{L^2(\Omega)}&\leqslant&
  C\,\textit{h}\,|\bu_r|_{1,\Omega}\\
  \mbox{by~(\ref{aux_label11})\qquad}&\leqslant&C\,\textit{h}\,\|f\|_{0,\Omega}.
\end{IEEEeqnarray*}
% subsection bound_for_the_regular_part (end)
\subsection{Bound for the Singular Part in~(\ref{auxlabel75}) in a 
prismatic macro--element with
a singular Edge} % (fold)
\label{sub:bound_singular_part_prismatic_macroelement}

Let $\Lambda_\ell$ be a prismatic element of $\pazocal{T}_{\textit{h}_0}$.
Let $\be$ be the singular edge of $\Lambda_\ell$ and let 
$\bxi = (\xi_1,\xi_2,\xi_3)'$ be it's local coordinates, all as in the hypotheses
of Theorem~\ref{thm_regularity}. In this case we need to
distinguish between the elements $E$ with $d(E,\be) > 0$ and those with
$d(E,\be) = 0$.
\begin{IEEEeqnarray*}{rCl}
  \| \bu_s - \br_0\bu _s\|_{L^2(\Lambda_\ell)}^2 &\leqslant&
  \sum_{d(E,\be) = 0} \left(\| \bu_s\|_{L^2(E)} + 
  \|\br_0\bu_s\|_{L^2(E)}\right)^2\\
  & &\:+\sum_{d(E,\be) > 0} \left( \sum_{|{\balpha}| = 1} 
  \boldsymbol{h}^{\balpha} \|\partial^{\balpha}\bu_s\|_{L^2(E)} + 
  h_E\|\text{div}\bu_s\|_{L^2(E)}
  \right)^2.\\
  \yesnumber\label{aux_label}&&
\end{IEEEeqnarray*}
The objective of the following paragraphs and items is to bound each one of the
terms involved in the right hand side of~(\ref{aux_label})
by a constant times
$\textit{h}$ times the norm of $f$, to sum everything up afterwards.
\paragraph{Elements with $d(E,\be) > 0$ in~(\ref{aux_label}).} % (fold)
\label{par:elements_with_d_pos}
\begin{enumerate}
\item Bound for $\|\partial_{\xi_1}\bu_s\|_{L^2(E)}$.                    %%, $\alpha = (1,0,1).$ % (fold)
\label{subp:bound_for_100} Pick any weight $w(\bx)\geqslant h_1$.
\begin{IEEEeqnarray*}{rCl}
  h_1\|\partial_{\xi_1}\bu_s\|_{L^2(E)}& = & 
    \sum_{i=1,2} \|h_1\partial_{\xi_1}u_{s,i}\|_{L^2(E)} +
      h_1\|\partial_{\xi_1}u_{s,3}\|_{L^2(E)}\\
  & \leqslant & \sum_{i=1,2} \|w(\bx)\partial_{\xi_1}u_{s,i}\|_{L^2(E)} +
      h_1\|u_{s,3}\|_{V_0^{1,2}(E)}.
\end{IEEEeqnarray*}
Now it turns out that if we could choose $w(\bx) = \textit{h}\,r(\bx)^\delta \geqslant h_1$
for some $\delta$, then
we would have
\begin{IEEEeqnarray*}{rCl}
  h_1\|\partial_{\xi_1}\bu_s\|_{L^2(E)}
  &\leqslant&\textit{h} \sum_{i=1,2} \|u_{s,i}\|_{V_\delta^{1,2}(E)} +
      \textit{h}\|u_{s,3}\|_{V_0^{1,2}(E)}\\
  \yesnumber\label{aux_label1}
  &\leqslant&C\,\textit{h}\|\bu_s\|_{\pazocal{V}_{\beta,\delta}(E)}.
\end{IEEEeqnarray*}
Let's look for $\delta$. We have $r(\bx)\geqslant d(E,\be)$ so, according to the
grading~(\ref{label_grading}) , in the 
case $0< d(E,\be) <1$, it holds
\begin{IEEEeqnarray*}{rClCl}
  \textit{h}\,r(\bx)^{1-\mu}&\geqslant&\textit{h}\,d(E,\be)^{1-\mu}&\sim& h_1.
\end{IEEEeqnarray*}
In the 
case $d(E,\be) \sim 1$
\begin{IEEEeqnarray*}{rClCl}
  \textit{h}\,r(\bx)^{1-\mu}&\gtrsim&\textit{h}&\sim& h_1.
\end{IEEEeqnarray*}
In both cases we have to take $\delta \sim 1-\mu > 1 - \frac{\pi}{\omega_\ell}$
to get the estimate~(\ref{aux_label1}).
The bound for the term $\|\partial_{\xi_22}\bu_s\|$ is done similarly.
\item Bound for $\|\partial_{\xi_3}\bu_s\|_{L^2(E)}$. % (fold)
\label{subp:bound_for_001}
If $i = 1$,$2$ or $3$, $\partial_{\xi_3}u_i$ equals $\partial_{\xi_i}u_3$, so
\begin{IEEEeqnarray*}{rCl}
  h_3^2\|\partial_{\xi_3}\bu_s\|^2_{L^2(E)}& = & 
     h_3^2\sum_{i=1,2,3}\|\partial_{\xi_3}u_{s,i}\|^2_{L^2(E)}\\
    &\lesssim&\textit{h}^2\,\| u_3 \|^2_{V_0^{1,2}(E)}.
\end{IEEEeqnarray*}
\item {Bound for the divergence.} By the grading in the present macro--element and
the triangle inequality we have
\label{subp:bound_for_the_div}
\begin{IEEEeqnarray*}{rCl}
  h_E\,\| \dv\bu_s \|_{L^2(E)} & \lesssim &
  {h_3}\,\|\dv\bu_s\|_{L^2(E)}\sim
  \textit{h}\,\|\dv\bu_s\|_{L^2(E)}\\[7pt]
  \yesnumber\label{aux_label64}&\leqslant&\textit{h}\,\left\{\|\dv\bu\|_{L^2(E)}+
  \|\dv\bu_r\|_{L^2(E)}\right\}.
\end{IEEEeqnarray*}
\end{enumerate}
\paragraph{Elements with $d(E,\be) = 0$ in~(\ref{aux_label}).}
Take $\delta \sim 1-\mu$ in this paragraph again.
\begin{enumerate}
  \item Bound for $\| \bu_s\|_{L^2(E)}$. % (fold)
\begin{IEEEeqnarray*}{rCl}
  \|\bu_s\|^2_{L^2(E)}& = & \sum_{i=1,2}\|{u_{s,i}}\|^2_{L^2(E)} + 
    \|{u_{s,3}}\|^2_{L^2(E)}\\
\IEEEeqnarraymulticol{3}{r}{
\begin{IEEEeqnarraybox*}{rCl}
\qquad&=&\sum_{i=1,2}\|r(\bx)^{1-\delta} r(\bx)^{\delta-1} {u_{s,i}}\|^2_{L^2(E)}
    + \|r\,r^{-1} {u_{s,3}}\|^2_{L^2(E)}\\
  &\leqslant& 
  \max r(\bx)^{2(1-\delta)}\sum_{i=1,2}\|{u_{s,i}}\|^2_{V_\delta^{1,2}(E)}
  + \max_{\bx\in E} r(\bx)^{2}\|{u_{s,3}}\|^2_{V_0^{1,2}(E)}\\
  &\lesssim& h_1^{2(1-\delta)}\sum_{i=1,2}\|{u_{s,i}}\|^2_{V_\delta^{1,2}(E)}
  + h_1\|{u_{s,3}}\|^2_{V_0^{1,2}(E)}\\
  &\sim&  (\textit{h}^{\nicefrac{2}{\mu}})^\mu\sum_{i=1,2}\|{u_{s,i}}\|^2_{V_\delta^{1,2}(E)}
  + (\textit{h}^{\nicefrac{1}{\mu}})^2\|{u_{s,3}}\|^2_{V_0^{1,2}(E)}\\
  &\leqslant& C\,\textit{h}^2\|\bu_{s}\|^2_{\pazocal{V}_\delta^{1,2}(E)}
\end{IEEEeqnarraybox*}
}    
\end{IEEEeqnarray*}
(because $\mu \leqslant 1$).
\item \label{aux_label61} {Bound for $\| \br_E \bu_s \|_{L^2(E)^3}$.} % (fold)
First recall that if $\phi$ is a scalar polynomial defined on a physical element $E$, then
\begin{IEEEeqnarray}{rCl}\label{normaL2L1}
  \| \phi \|_{L^{2}(E)} & \leqslant & C\,|E|^{-1/2}\,\| \phi \|_{L^{1}(E)}.
\end{IEEEeqnarray}
Now we estimate the $L^1$ norms, starting with the stability estimate in 
the rescaled element $\tilde{E}$ of Figure~(\ref{rescaled_prism}).
As in our mesh we are considering right prisms and local coordinates
in $\Lambda_\ell$ such that $\xi_3$ is the direction containing the singular
edge $\be_\ell$, there is a matrix $M_E$ of the form 
\begin{equation}\label{matrix_A}
  M_E=
    \left(\begin{array}{ccc}a_{11}&a_{12}&0\\a_{21}&a_{22}&0\\0&0&1\end{array}\right)
\end{equation}
for which an affine transform $F_E$ with matrix $M_E$ maps $\tilde{E}$ onto $E$.
The infinity
norm of $\left(\begin{array}{cc}a_{11}&a_{12}\\a_{21}&a_{22}\end{array}\right)$
is bounded by a quantity $c_E$ depending only on the maximum angle of the projection
of $E$ onto the $(\xi_1,\xi_2)$ plane and the infinity norm of its inverse
is bounded by one.
So changing variables and pulling
back to $\tilde E$ we get 
\begin{IEEEeqnarray*}{rCcCl}
  \| (\br_E\bu_s)_1 \|_{L^{1}(E)}  & = & \int_E |(\br_E\bu_s)_1|\,d\bx
        & = & \int_{\tilde{E}} |(M_E\,\tilde{\br}_{\tilde E}\tilde{\bu}_s)_1|\,d\tilde{\bx}\\
   \IEEEeqnarraymulticol{5}{R}{\leqslant  c_E\,\Big\{
    \sum_{i=1,2} \|\tilde{u}_{s,i}\|_{L^1(\tilde{E})}
      + \sum_{i=1}^3 h_i \left(\|\partial_{i} \tilde{u}_{s,1} \|_{L^{1}(\tilde{E})} +
           \| \partial_{i} \tilde{u}_{s,2} \|_{L^{1}(\tilde{E})}\right)}\\
    && & & +\,2 h_1\|\dv(\tilde{u}_{s,1},\tilde{u}_{s,2},0)\|_{L^{1}(\tilde{E})}\Big\}.\\[4pt]
\yesnumber\label{aux_label3}&&&&
\end{IEEEeqnarray*}
Now the work comes to rewrite and bound each term in~(\ref{aux_label3}).
Recalling the properties~(\ref{transfDiv}) and~(\ref{derivadaPiola}) about the derivatives
with coordinate changes,
\begin{IEEEeqnarray*}{rCl}
  \|\tilde{u}_{s,1}\|_{L^1(\tilde{E})} & = &
  \frac{1}{|\det(M_E)|} \int_{E} \left|\tilde{u}_{s,1}(F_E^{-1}(\bx))\right|\,d\bx\\[4pt]
    & =   &         \int_{E} |(M_E^{-1})_{\text{row}_1}\bu_s(\bx)|\,d\bx\\[4pt]
    & \leqslant & \|M_E^{-1}\|_\infty   \sum_{i=1,2} \|{u}_{s,i}\|_{L^1({E})}\\[4pt]
    & \leqslant & \sum_{i=1,2} \|{u}_{s,i}\|_{L^1({E})}
\end{IEEEeqnarray*}
and by the same reasons
\begin{IEEEeqnarray*}{rCl}
  \|\tilde{u}_{s,2}\|_{L^1(\tilde{E})} & \leqslant & \sum_{i=1,2} \|{u}_{s,i}\|_{L^1({E})}.
\end{IEEEeqnarray*}
For the first derivatives, let $k,l = 1$ or $2$. 
\begin{IEEEeqnarray*}{rCl}
  \|\partial_{\tilde{x}_l} \tilde{u}_{s,k}\|_{L^1(\tilde{E})} 
  & = & \frac{1}{|\det(M_E)|} \int_{E} \left|\det(M_E)\,(M_E^{-1})_{\text{row}_k}\,
  D\bu_s(\bx)\,(M_E)_{\text{col}_l}\right|\,d\bx\\[4pt]
  %& \leqslant & \|M_E^{-1}_{\text{row}_k}\|_\infty\|A_{\text{col}_l}\|_\infty\sum_{i,j = 1,2} \|\partial_{\xi_j}u_{s,i}\|_{L^{1}(E)}\\
  & \leqslant & \sum_{i=1,2}\|\partial_{\xi_l}u_{s,i}\|_{L^{1}(E)}
\end{IEEEeqnarray*}
and, similarly, if $k=1,2$
\begin{IEEEeqnarray*}{rCl}
  \|\partial_{\tilde{x}_3} \tilde{u}_{s,k}\|_{L^1(\tilde{E})} & \leqslant &
  \|M_E^{-1}\|_\infty\sum_{i = 1,2} \|\partial_{\xi_3}u_{s,i}\|_{L^{1}(E)}.
\end{IEEEeqnarray*}
To cope with the divergence term, because of the blocks of the matrix $M_E$
we have
\begin{IEEEeqnarray*}{rCl}
  (u_1(F_E\tilde\bx), u_2(F_E\tilde\bx), 0)' & = &
\frac{1}{\det M_E}\,M_E\, (\tilde{u}_1(\tilde{\bx}), \tilde{u}_2(\tilde{\bx}), 0)'\mbox{,}\\
{\dv}({u}_1,{u}_2,0)'&=&\frac{1}{\det M_E} \dv(\tilde{u}_1,\tilde{u}_2,0)'.
\end{IEEEeqnarray*}
Then, changing variables,
\begin{IEEEeqnarray*}{rCl}
  \|\dv(\tilde{u}_{s,1},\tilde{u}_{s,2},0)'\|_{L^{1}(\tilde{E})} &=&
  \|\dv(u_{s,1},u_{s,2},0)'\|_{L^{1}(E)}.
\end{IEEEeqnarray*}
Finally joining everything,
\begin{IEEEeqnarray*}{rCl}
  \| (\br_E \bu_s)_1 \|_{L^{1}(E)} & \leqslant & C\,\bigg\{ 
  \sum_{i=1,2} 
\Big\{
  \|u_{s,i}\|_{L^1(E)}\\[5pt]
  & &+\;h_i\sum_{j=1,2}\|\partial_{\xi_i}u_{s,j}\|_{L^{1}(E)^3} +
  h_3 \|\partial_{\xi_3}u_{s,i}\|_{L^{1}(E)}\Big\}\\[5pt]
  \yesnumber\label{aux_label15}
  & & +\;h_1 \|\dv(u_{s,1}, u_{s,2}, 0)'\|_{L^{1}(E)}\bigg\}.
\end{IEEEeqnarray*}
Now we enumerate the bound for each term on the right of~(\ref{aux_label15}).
\begin{enumerate}
    \item
  For $\|u_{s,i}\|$ we have
  \begin{IEEEeqnarray*}{rCl}
    \|u_{s,i}\|_{L^1(E)} & = & 
    \| r(\bx)^{1-\delta} r(\bx)^{\delta-1} u_{s,i}\|_{L^1(E)}\\
    &\leqslant& \|r^{1-\delta}\|_{L^2(E)} \|u_{s,i}\|_{V_\delta^{1,2}(E)}\\
    &\leqslant& C\,h_1^{1-\delta}\,|E|^{\nicefrac12}\,\|u_{s,i}\|_{V_\delta^{1,2}(E)}\\
    &\leqslant& C\,\textit{h}\,|E|^{\nicefrac12}\,\|u_{s,i}\|_{V_\delta^{1,2}(E)}.
  \end{IEEEeqnarray*}
    \item
  With respect to the derivatives orthogonal to the singular edge, take $i$,$j = 1$,$2$ and,
  by H\"older's inequality,
  \begin{IEEEeqnarray}{rCl}\label{aux_label16}
    h_1\|\partial_{\xi_j}u_{s,i}\|_{L^1(E)} &\leqslant&
    h_1\,\|r^{-\delta}\|_{L^2(E)}\,\|u_{s,i}\|_{V_\delta^{1,2}(E)}.
  \end{IEEEeqnarray}
  Integrating the radial weight $r^{-\delta}$ we get
  \begin{IEEEeqnarray*}{rCl}
    \|r^{-\delta}\|_{L^2(E)} & \leqslant & C\, h_1^{-\delta}\,h_1\,h_3^{\nicefrac12}\\
    & \sim & h_1^{-\delta}(h_1h_2h_3)^{\nicefrac12}\\
    &\leqslant& C\, h_1^{-\delta} |E|^{\nicefrac12},
  \end{IEEEeqnarray*}
  (where we used $h_1 \sim h_2$ and the minimun angle condition to bound the
  area of a triangular face from below with $h_1h_2$), so in~(\ref{aux_label16})
  we have
  \begin{IEEEeqnarray*}{rCl}
    h_1\|\partial_{\xi_j}u_{s,i}\|_{L^1(E)} & \leqslant & C\,h_1^{1-\delta} |E|^{\nicefrac12}
    \|u_{s,i}\|_{V_\delta^{1,2}(E)}\\
    &\sim& (\textit{h}^{1/\mu})^{\mu} |E|^{\nicefrac12}
    \|u_{s,i}\|_{V_\delta^{1,2}(E)}\\
    \label{derivOrtog} \yesnumber &=&|E|^{\nicefrac12}\,\textit{h}\,\|u_{s,i}\|_{V_\delta^{1,2}(E)}.
  \end{IEEEeqnarray*}
    \item
  For the derivatives along the singular edge we use $\bu = \nabla p$ to
  commute the indices of the derivatives and H\"older's inequality. We have
  \begin{IEEEeqnarray*}{rCl}
    h_3\,\| \partial_{\xi_3}u_{s,i} \|_{L^1(E)} &=& h_3\,\| \partial_{\xi_i}u_{s,3} \|_{L^1(E)}\\
    &\leqslant& h_3\,|E|^{\nicefrac12}\,\| \partial_{\xi_i}u_{s,3} \|_{L^2(E)}\\
    \yesnumber\label{alongSingular}&\leqslant& C\,|E|^{\nicefrac12}\,\textit{h}\,\| u_{s,3} \|_{V_0^{1,2}(E)}.
  \end{IEEEeqnarray*}
    \item
  For the divergence we can recall the grading condition $h_1\sim h_2$ and 
  observe that
  \begin{IEEEeqnarray*}{rCl}
    h_1 \|\text{div}(u_{s,1}, u_{s,2}, 0)\|_{L^{1}(E)} & \leqslant &
    h_1 \sum_{j=1,2} \|\partial_{\xi_j} u_{s,j}\|_{L^{1}(E)}
  \end{IEEEeqnarray*}
  and reuse the estimates~(\ref{derivOrtog}). 
\end{enumerate}
The estimate for 
$\| (\br_0\bu_s)_2 \|_{L^{2}(E)}$ is the same. The estimate for 
component $(\br_0\bu_s)_3$ is as follows. By the commutativity of the
local interpolator and the coordinate change in Corollary~\ref{aux_label17} and
the estimate~(\ref{aux_label18}) in the proof Theorem~\ref{thmStabilityKtildeRT} we have
\begin{IEEEeqnarray*}{rCl}
  \| (\br_E\bu_s)_3 \|_{L^{1}(E)}
  & =     &
  \| (\br_{\tilde E}\tilde{\bu}_s)_3 \|_{L^{1}(\tilde{E})}\\
  & \leqslant & C\,\big{\{}\,\|\tilde{u}_{s,3}\|_{L^1(\tilde{E})} +
    \sum_{j=1}^3 h_j\,\|\partial_{\tilde{x}_j}\tilde{u}_{s,3}\|_{L^1(\tilde{E})}\,\big{\}}
\end{IEEEeqnarray*}
which by~(\ref{matrix_A}) and the considerations made there is bounded by
\begin{IEEEeqnarray*}{rCl}
  C\,(\,\|{u}_{s,3}\|_{L^1({E})} +
    \sum_{j=1}^3 h_j\|\partial_{\xi_j}{u}_{s,3}\|_{L^1({E})}).
\end{IEEEeqnarray*}
Now
\begin{IEEEeqnarray*}{rCl}
  \|u_{s,3}\|_{L^1(E)} &\leqslant& \|r\|_{L^2(E)} \,\|r^{-1}\,u_{s,3}\|_{L^2(E)}\\
              &\leqslant&C\,h_1\,|E|^{\nicefrac12}\,\|u_{s,3}\|_{V_0^{1,2}(E)}\\
              &\leqslant&C\,\textit{h}\,|E|^{\nicefrac12}\,\|u_{s,3}\|_{V_0^{1,2}(E)}. 
\end{IEEEeqnarray*}
We have also                                   %% TODO {\color{red} (al final no va $(h_1 + h_2)$)}
\begin{IEEEeqnarray*}{rCl}
  (h_1 + h_2)\sum_{i=1,2} \|\partial_{{x}_i}{u}_{s,3}\|_{L^1({E})} &\leqslant&
  C\,|E|^{\nicefrac12}\,\textit{h}\,\|u_{s,3}\|_{V_0^{1,2}(E)}
\end{IEEEeqnarray*}
and by~(\ref{alongSingular})
\begin{IEEEeqnarray*}{rCl}
  h_3\,\|\partial_{\xi_3}u_{s,3}\|_{L^1(E)} &\leqslant& C\,|E|^{\nicefrac12}\,
  \textit{h}\,\|u_{s,3}\|_{V_{0}^{1,2}(E)}.
\end{IEEEeqnarray*}

At last, having the bound for each of the three terms in 
$\|\br_E \bu_s\|_{L^2(E)^3}$, (\ref{normaL2L1}) yields    %% TODO {\color{BrickRed}(redactar mejor)}
\begin{IEEEeqnarray*}{rCl}
  \|\br_E\bu_s\|_{L^{2}(E)^3} &\leqslant& C\,\textit{h}\,\|\bu_s\|_{\pazocal{V}_{\delta}(E)}.
\end{IEEEeqnarray*}
\end{enumerate}
% paragraph elements_with_d0 (end)
% subsection bound_singular_part_prismatic_macroelement (end)
\subsection{Bound for the Singular Part  of~(\ref{auxlabel75})
in a Tetrahedral Macro--Element with Singular Edge and Vertex} % (fold)
Again we organize separating cases in terms of distance to the singular edge 
and then, for this type of macro--element, the terms with $d(E,\be) = 0$
will be separated in terms of distance to the singular vertex.

Table~\ref{element_classification} shows what has to be done for each type of
element. The rest of the needed estimates are contained in the proof of
the former case.
\begin{table}[!h]
\centering
\caption{Singular Part.}
\label{element_classification}
  \begin{IEEEeqnarraybox}
  [\IEEEeqnarraystrutmode
   \IEEEeqnarraystrutsizeadd{0pt}{0pt}]{v/c/v/c/v/c/v/c/v}
    \IEEEeqnarrayrulerow\\
    \IEEEeqnarrayseprow[5pt]\\
    &\hfill\raisebox{22pt}[0pt][0pt]{$d(E,\be)>0$}\hfill
                & & \referencePrismTikz{.9} 
              & & \referencePyramidTikz{0.9}
                & & \referenceTetrahedronTikz{.94}&\\
    \IEEEeqnarrayrulerow\\
    \IEEEeqnarrayseprow[5pt]\\
    &\hfill\raisebox{30pt}[0pt][0pt]{$d(E,\be)=0$}\hfill& &
      \begin{IEEEeqnarraybox}{c}
      \referencePrismTikz{.9}\\{\scriptstyle d(E,\bv) > 0}
      \end{IEEEeqnarraybox}
    &&&&
      \begin{IEEEeqnarraybox}{c}
        \referenceTetrahedronTikz{.94}\\{\scriptstyle d(E,\bv) = 0}
      \end{IEEEeqnarraybox}
    &\\
    \IEEEeqnarrayseprow[3pt]\\
    \IEEEeqnarrayrulerow
  \end{IEEEeqnarraybox}
\end{table}

Take a tetrahedral macro--element $\Lambda_\ell$ in $\pazocal{T}_{\textit{h}_0}$ as
in the title of the subsection. Let us start with
\begin{IEEEeqnarray}{rCl}\nonumber
  \|\bu_s - \br_0\bu_s\|^2_{\scriptscriptstyle L^2(\Lambda_\ell)^3}
  &=&\sum_{d(E,\be) = 0}
  \|\bu_s - \br_0\bu_s\|^2_{\scriptscriptstyle L^2(E)^3}+
  \sum_{d(E,\be) > 0}
  \|\bu_s - \br_0\bu_s\|^2_{\scriptscriptstyle L^2(E)^3}.\\
\label{auxlabel350}
\end{IEEEeqnarray}
\paragraph{Terms in~\eqref{auxlabel350} such that $d(E,\be)>0$. }
\begin{enumerate}
  \item 
Case $E$ is a pyramid.  {\color{Orange}\#\#\#\#\#\#\#\# seguir continue.}
Remember the local $h_1,h_2,h_3$ for pyramids in our setting.
%% (y,z,x)
\begin{center}
\begin{tikzpicture}[rotate=0,scale=1,shape border uses incircle,shape border rotate=-30]
  \node [name=t,shape=trapezium,draw,minimum width=2cm,
      trapezium left angle=120] at (0,0,0) {};
  
  \coordinate (punta) at (0,0,3);

  \coordinate (tl) at (t.top left corner);
  \coordinate (tr) at (t.top right corner);
  \coordinate (bl) at (t.bottom left corner);
  \coordinate (br) at (t.bottom right corner);

  \draw (tl) -- (punta);
  \draw (bl) -- (punta);
  \draw (tr) -- (punta);
  \draw (br) -- (punta);
  
  \coordinate (k1) at ($0.70*(tl) + 0.30*(punta)$);
  \coordinate (k2) at ($0.5*(tl) + 0.5*(tr)$);
  \coordinate (k3) at ($0.4*(tl) + 0.6*(bl)$);

  \node [left=1mm] (eta1) at (k1) {$\boldsymbol{\eta_1}$};
  \node [right=1mm] (eta2) at (k2) {$\boldsymbol{\eta_2}$};
  \node [below=0.5mm,right] (eta3) at (k3) {$\boldsymbol{\eta_3}$};

  \draw [->,thick] (tl) -- (k1);
  \draw [->,thick] (tl) -- (k2);
  \draw [->,thick] (tl) -- (k3);
\end{tikzpicture}
\end{center}
For a pyramid $E$, as pyramids don't touch singularities
and are regular  
\begin{IEEEeqnarray*}{rCl}
  \|\bu_s - \br_0\bu_s\|^2_{\sss L^2(E)} & \leqslant & h_E^2|\bu_s|_{1,E}^2
  \,\,\leqslant\,\,
  \textit{h}^2d(E,\be)^{2(1-\mu)}\sum_{i=1}^3 |u_{s,i}|^2_{1,E}\\
  &\leqslant&
    \textit{h}^2\sum_{i=1}^3\sum_{j=1}^3 \|r^{1-\mu}\gancho_{\eta_j}u_{s,i}\|_{\sss L^2(E)}^2\\
  &\leqslant&
    \textit{h}^2\left(
     \sum_{i=1}^2 \sum_{j=1}^3\|R^{1-\mu}\theta^{1-\mu}\gancho_{\eta_j}u_{s,i}\|_{\sss L^2(E)}^2
     \right.\\
     \IEEEeqnarraymulticol{3}{R}{\left.+
          \sum_{j=1}^3\|R^{1-\mu}\gancho_{\eta_j}u_{s,3}\|_{\sss L^2(E)}^2\right)}\\[7pt]
  (1-\mu\geqslant 1-\nu)\quad&\leqslant&
    \textit{h}^2\left(
     \sum_{i=1}^2 \sum_{j=1}^3\|R^{1-\nu}\theta^{1-\mu}\gancho_{\eta_j}u_{s,i}\|_{\sss L^2(E)}^2
     \right.\\
     \IEEEeqnarraymulticol{3}{R}{\left.+
          \sum_{j=1}^3\|R^{1-\nu}\gancho_{\eta_j}u_{s,3}\|_{\sss L^2(E)}^2\right)}\\[7pt]
  &\leqslant&
    \textit{h}^2\left(
    \sum_{i=1}^2 \sum_{j=1}^3\|R^{\beta}\theta^{\delta}\gancho_{\eta_j}u_{s,i}\|_{\sss L^2(E)}^2+
     \sum_{j=1}^3\|R^{\beta}\gancho_{\eta_j}u_{s,3}\|_{\sss L^2(E)}^2\right)\\[7pt]
  \yesnumber\label{aux_label63} &\leqslant&
    \textit{h}^2
    \left(\|u_{s,1}\|_{\sss V^{1,2}_{\beta,\delta}}+
          \|u_{s,2}\|_{\scriptscriptstyle V^{1,2}_{\beta,\delta}}+
          \|u_{s,3}\|_{\scriptscriptstyle V^{1,2}_{\beta,0}}\right).
\end{IEEEeqnarray*}
\item For prisms with $d(E,\be)>0$ or tetrahedra: in the case of prisms we use 
the result of Theorem~\ref{aux_label46} and in the case of tetrahedra
we use Theorem 6.2 of~\cite{aadl}  to get
\begin{IEEEeqnarray*}{rCl}
  \|\bu_s - \br_0\bu_s\|^2_{\sss L^2(K)}&\leqslant& C\left\{
    h_1^2\|\gancho_{\xi_1}\bu_s\|^2+
    h_2^2\|\gancho_{\xi_2}\bu_s\|^2+
    h_3^2\|\gancho_{\xi_3}\bu_s\|^2+
    h_K^2\|\dv\bu_s\|^2
  \right\}
\end{IEEEeqnarray*}
Now the treatment is a slight variation of the previous item including a few small
tricks. In fact,
\begin{IEEEeqnarray*}{rCl}
  h_1^2\|\gancho_{\xi_1}\bu_s\|^2_{L^2(E)^3}&=&
  h_1^2\sum_{i=1}^3 \|\gancho_{\xi_1}u_{s,i}\|^2_{L^2(E)}\,\leqslant\,
    \textit{h}^2\sum_{i=1}^3 \|r^{1-\mu}\gancho_{\xi_1}u_{s,i}\|^2_{L^2(E)}\\
  &\leqslant&
    \textit{h}^2\left(
     \sum_{i=1}^2 \|R^{1-\mu}\theta^{1-\mu}\gancho_{\xi_1}u_{s,i}\|^2_{L^2(E)}+
     \|R^{1-\mu}\gancho_{\xi_1}u_{s,3}\|^2_{L^2(E)}\right)\\[7pt]
  &\leqslant&
    \textit{h}^2\left(
     \sum_{i=1}^2 \|R^{1-\nu}\theta^{1-\mu}\gancho_{\xi_1}u_{s,i}\|^2_{L^2(E)}+
     \|R^{1-\nu}\gancho_{\xi_1}u_{s,3}\|^2_{L^2(E)}\right)\\[7pt]
  &\leqslant&
    \textit{h}^2\left(
    \sum_{i=1}^2 \|R^{\beta}\theta^{\delta}\gancho_{\xi_1}u_{s,i}\|^2_{L^2(E)}+
     \|R^{\beta}\gancho_{\xi_1}u_{s,3}\|^2_{L^2(E)}\right)\\[7pt]
  &\leqslant&
    \textit{h}^2
    \left(\sum_{i=1}^2 \|u_{s,i}\|^2_{\scriptscriptstyle V^{1,2}_{\beta,\delta}}+
         \|u_{s,3}\|_{\scriptscriptstyle V^{1,2}_{\beta,0}}\right).
\end{IEEEeqnarray*}
Now, since $h_2\sim h_1$, with the same argument,
\begin{IEEEeqnarray*}{rCl}
  h_2\|\gancho_{\xi_2}\bu_s\|_{L^2(E)^3}&=&
  h_2\sum_{i=1}^3 \|\gancho_{\xi_2}u_{s,i}\|\,\leqslant\,
    \textit{h}
    \left(\sum_{i=1}^2 \|u_{s,i}\|_{\scriptscriptstyle \beta,\delta}+
         \|u_{s,3}\|_{\scriptscriptstyle \beta,0}\right).
\end{IEEEeqnarray*}
For the derivative with respect to $\xi_3$,
\begin{IEEEeqnarray*}{rCl}
  h_3^2\|\gancho_{\xi_3}\bu_s\|^2_{L^2(E)^3}&=&
  h_3^2\sum_{i=1}^3 \|\gancho_{\xi_3}u_{s,i}\|^2_{L^2(E)}\\
  &=&h_3^2\left(\sum_{i=1}^2\|\gancho_{\xi_i}u_{s,3}\|^2_{L^2(E)}+
    \|\gancho_{\xi_3}u_{s,3}\|^2_{L^2(E)}\right)\\[7pt]
  &\leqslant&\textit{h}^2\left(\sum_{i=1}^2\|d(K,v)^{1-\nu}\gancho_{\xi_i}u_{s,3}\|^2_{L^2(E)}
  \right.\\
  \IEEEeqnarraymulticol{3}{r}{\left.
    +\|d(K,v)^{1-\nu}\gancho_{\xi_3}u_{s,3}\|^2_{L^2(E)}\right)}\\[7pt]
  &\leqslant&
  \textit{h}^2\left(\sum_{i=1}^2\|R^{\beta}\gancho_{\xi_i}u_{s,3}\|^2_{L^2(E)}+
    \|R^{\beta}\gancho_{\xi_3}u_{s,3}\|^2_{L^2(E)}\right)\\[7pt]
  &=&
  \textit{h}^2\sum_{i=1}^3\|R^{\beta}\gancho_{\xi_i}u_{s,3}\|^2_{L^2(E)}\\[7pt]
  &\leqslant&
  3\textit{h}^2\|u_{s,3}\|^2_{\scriptscriptstyle V^{1,2}_{\beta,0}}.
\end{IEEEeqnarray*}
The divergence term goes like in~(\ref{aux_label64}).
\end{enumerate}
Terms such that $d(E,\be)=0$. We have just prisms and one isotropic tetrahedron
to be considered separately as $T$ for the interpolation term after 
triangle inequality. In fact,
\begin{IEEEeqnarray}{rCl} %
  \IEEEeqnarraymulticol{3}{L}{\nonumber
    \sum_{d(E,\be) = 0}
    \|\bu_s - \br_0\bu_s\|^2_{\scriptscriptstyle L^2(E)^3}
    \,\lesssim\,}
  \\
  \IEEEeqnarraymulticol{3}{R}{
  \label{distancia_cero_arista}
  \,\lesssim\,\|\br_0\bu_s\|^2_{\scriptscriptstyle L^2(T)^3}
  \,+\sum_{
  \substack{{\small{\text{prisms\,}}P}\\
          d(P,\be) = 0}} \|\br_0\bu_s\|^2_{\scriptscriptstyle L^2(P)^3}
  \,+\sum_{d(E,\be) = 0} \|\bu_s\|^2_{\scriptscriptstyle L^2(E)^3}}.
\end{IEEEeqnarray}
Now let us bound each term on the right of~(\ref{distancia_cero_arista}).
\begin{enumerate}
  \item 
  For the last term on the right of~(\ref{distancia_cero_arista}), let
$E$ be any of both the tetrahedron with the
singular
 vertex or a prism. If $E$ is a prism, recall in this case we have
 $d(E,\be) = 0$ and $d(E,v) > 0$. 
\begin{IEEEeqnarray*}{rCl}
   \|\bu_s\|_E &=&
    \sum_{i=1}^2 \|R^\nu\theta^\mu R^{-\nu}\theta^{-\mu} u_{s,i}\|
    + \|R^\nu\theta^{-1}R^{-\nu}\theta u_{s,3}\|\\[7pt]
  &\leqslant&\|R^\nu\theta^\mu\|_{L^\infty(E)}
  \sum_{i=1}^2 \|R^{-\nu}\theta^{-\mu} u_{s,i}\|
    + \|R^\nu\theta\|_{L^\infty(E)}
    \|R^{-\nu}\theta^{-1} u_{s,3}\|.
\end{IEEEeqnarray*}
Since $\theta < 1$ and $\mu \leqslant \nu < 1$, then
\begin{IEEEeqnarray}{rClClCr}
  \label{cota_pesos}
  R(\bx)^\nu\theta(\bx)&\leqslant&
  R(\bx)^\nu\theta(\bx)^\mu&\leqslant&R(\bx)^\mu\theta(\bx)^\mu&=&
  r(\bx)^\mu.
\end{IEEEeqnarray}
Using this we get
\begin{IEEEeqnarray*}{rCl}
  \|\bu_s\|&\leqslant&\|r^\mu\|_{\infty,E}
  \left(
    \sum_{i=1}^2 \|R^{-\nu}\theta^{-\mu}u_{s,i}\|
    + \|R^{-\nu}\theta^{-1}u_{s,3}\|
  \right)\\[7pt]
  &\leqslant&\max\{h_1,h_2\}^\mu
  \left(
    \sum_{i=1}^2 \|R^{-\nu}\theta^{-\mu}u_{s,i}\|
    + \|R^{-\nu}\theta^{-1}u_{s,3}\|
  \right)\\[7pt]
  &\lesssim&\textit{h}
    \|\bu_{s}\|_{\pazocal{V}_{\beta,\delta}(E)}
\end{IEEEeqnarray*}
provided we take $\beta\sim 1-\nu$ and $\delta\sim 1-\mu$.
\item For the first term in~\ref{distancia_cero_arista},
although the family of tetrahedra touching the singular vertex
y the present type of macro--element remain regular, we estimate with 
the weighted norms anisotropically for the sake of completeness. Let $T_\ell$
be that tetrahedron touching the singular vertex and with an edge
contained in the singular edge of $\Lambda_\ell$. %${\color{blue}\|\br_0\bu_s\|^2_{\scriptscriptstyle L^2(Tetra)^3}}$.
We work for the first component of the local interpolate in the $L^1(T_\ell)$ norm
using~(\ref{normaL2L1}).
\begin{IEEEeqnarray*}{rCl}
  \|(\br_0\bu_s)_1\|_{\scriptscriptstyle L^2(T_\ell)}
    & \leqslant & C|T_\ell|^{-1/2} \|(\br_0\bu_s)_1\|_{\scriptscriptstyle L^1(T_\ell)}.
\end{IEEEeqnarray*}
Remember that by Lemma~\ref{well_defined_dofs} we know $\bu_s$ is in 
$W^{1,1}(\Lambda_\ell)$.
\rescaledTetraTikz
We 
start pulling $\br_0\bu_s$ back to a rescaled reference tetrahedron $\tilde{T}$ 
with the mapping 
$F_{T_\ell}(\tilde{\bx}) = M_{T_\ell}\tilde{\bx} + \bx_{T_\ell}$
(cfr. Figure~\ref{rescaled_tetra}). Using Lemma 5.22 in page 123 of~\cite{monk},
which gives the analog of~(\ref{div_interp_commutes}) for 
tetrahedra, and then using Proposition 3.4 of~\cite{aadl}, we get
\begin{IEEEeqnarray*}{rCl}
  \|(\br_0\bu_s)_1\|_{L^1(T_\ell)} &=& \int_{\tilde{T}}|(M_{T_\ell}\tilde{\br}_0\tilde{\bu}_s)_1|\,d\tilde{\bx}\\[7pt]
    &\leqslant& C \sum_{1\leqslant i\leqslant 3} \left(\|\tilde{u}_{s,i}\|_{L^1(\tilde{T})} + 
      \sum_{1\leqslant j\leqslant 3} h_j\|\partial_j\tilde{u}_{s,i}\|_{L^1(\tilde{T})}\right.\\
      \IEEEeqnarraymulticol{3}{r}{\left. + 
             h_i\|\dvg \tilde{\bu}_s\|_{L^1(\tilde{T})}\right)} \\[7pt] %%% & = & \ldots \text{paso al tetraedro f\'isico} \ldots \\[7pt] % VER BORRADOR INTERPOLACION PIRAMIDE
    & \leqslant & C
    \left(\|\bu_{s}\|_{L^1(T_\ell)^3} + 
    \sum_{1\leqslant j \leqslant 3} h_j\|\partial_{\xi_j}\bu_{s}\|_{L^1(T_\ell)^3}\right.\\
    \IEEEeqnarraymulticol{3}{r}{\yesnumber\label{aux_label60}
    \left. + (h_1+h_2+h_3) \|\dvg \bu_s\|_{L^1(T_\ell)}\right)}
\end{IEEEeqnarray*}
{\color{Orange}\#\#\#\#\#\#\# where $C$ depends only on the max angle?}. 
Now we estimate each term in the right of~(\ref{aux_label60}).
\begin{enumerate}
  \item[(2a)] By H\"older's inequality
\begin{IEEEeqnarray*}{rCl}
  \|\bu_{s}\|_{L^1(T_\ell)^3} &\leqslant&
\sum_{i=1,2}\|R^{\nu}\theta^{\mu}\|_{L^2(T_\ell)}\|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^2(T_\ell)}\\ %%&\leqslant&\|R^\nu\theta^{\mu}\|_\infty|T_\ell|^{\nicefrac12}\sum_{i=1,2}\|\ldots u_{s,i}\|_{L^2(T\ell)} + \|R^\nu\theta\|_\infty|T_\ell|^{\nicefrac12}\|\ldots u_{s,3}\|_{L^2(T\ell)}\\[7pt]
 & &\qquad+\,\|R^{\nu}\theta\|_{L^2(T_\ell)}\|R^{-\nu}\theta^{-1}u_{s,3}\|_{L^2(T_\ell)}
\end{IEEEeqnarray*}
and by~(\ref{cota_pesos}) and~(\ref{label_grading}) we have                                        %&\leqslant&(\textit{h}^{1/\mu})^\mu|T_\ell|^{\nicefrac12}\sum_{i=1,2}\|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^{2}(T_\ell)} +\|R^{-\nu}\theta^{-1} u_{s,3}\|_{L^{2}(T_\ell)}\\[7pt]
\begin{IEEEeqnarray*}{rCl} 
\|\bu_{s}\|_{L^1(T_\ell)^3} &\leqslant&(\textit{h}^{1/\mu})^\mu|T_\ell|^{\nicefrac12}
\|\bu_s\|_{V_{\beta,\delta}^{1,2}(T_\ell)^2\times V_{\beta,0}^{1,2}(T_\ell)}\\
&=&\textit{h}\,|T_\ell|^{\nicefrac12}\|\bu_s\|_{\pazocal{V}_{\beta,\delta}(T_\ell)}.
\end{IEEEeqnarray*}
  \item[(2b)]
Take $1\leqslant j,i \leqslant 3$ %%% TODO (HACER APARTE PARA $i=3$; creo que es un poco diferente, como pas\'o antes):
\begin{IEEEeqnarray*}{rCl}
  h_j\|\partial_{\xi_j} u_{s,i}\|_{L^1(T_\ell)} & \leqslant &
    h_j\|R^{\nu-1}\theta^{\mu-1}\|_{L^2(T_\ell)}\|R^{1-\nu}\theta^{1-\mu}\partial_{\xi_j} u_{s,i}\|_{L^2(T_\ell)}
\end{IEEEeqnarray*}
As $0\leqslant1-\nu\leqslant1-\mu<1$ we get 
\[
  R(\bx)^{1-\nu}\geqslant R(\bx)^{1-\mu}
\]
and
\[
  R(\bx)^{\nu-1}\theta(\bx)^{\mu-1}\leqslant
  R(\bx)^{\mu-1}\theta(\bx)^{\mu-1} = r(\bx)^{\mu-1}.
\]
From this we will use that
\[
  \|R^{\nu-1}\theta^{\mu-1}\|_{L^2(T_\ell)} \leqslant \|r^{\mu-1}\|_{L^2(T_\ell)}.
\]
Now, calculating the right side integrating in a cylindrical section,
\[
  \|r^{\mu-1}\|_{L^2(T_\ell)} = \sqrt{\frac{\pi}{4\mu}}\sqrt{h_3}\,h_1^{\mu}\sim \sqrt{h_3}\,\textit{h}.
\]
Then
\begin{IEEEeqnarray*}{rCl}
  h_j\|r^{\mu-1}\|_{L^2} & \lesssim & \sqrt{h_1h_2h_3}\textit{h}\\[7pt]
    & \sim & \sqrt{|T_\ell|}\,\textit{h}
\end{IEEEeqnarray*}
and then
\begin{IEEEeqnarray}{rCl}
\nonumber
  h_j\|\partial_{\xi_j} u_{s,i}\|_{L^1(T_\ell)} & \lesssim &
    \textit{h}\,\sqrt{|T_\ell|}\,\|R^{1-\nu}\theta^{1-\mu}\partial_{\xi_j} u_{s,i}\|_{L^2(T_\ell)}\\
\label{cuentita_integral}
    &\leqslant& \textit{h}\,\sqrt{|T_\ell|}\,\|u_{s,i}\|_{\scriptscriptstyle V^{1,2}_{\beta,\delta}(T_\ell)}.
\end{IEEEeqnarray}
\item[(2c)]\label{aux_label65} The divergence term in~(\ref{aux_label60}):
\begin{IEEEeqnarray*}{rClCr}
  (h_1+h_2+h_3) \|\dvg \bu_s\|_{L^1(T_\ell)} & \leqslant &
    (2\textit{h}^{1/\mu} + \textit{h}^{1/\nu}) \|\dvg \bu_s\|_{L^1(T_\ell)} \\[7pt]
    & \leqslant & 3\,\textit{h}\,\sqrt{|T_\ell|}\,\|\dvg \bu_s\|_{L^2(T_\ell)} \\[7pt]
    \yesnumber\label{aux_label66}
    & \leqslant & 3\,\textit{h}\,\sqrt{|T_\ell|}\,\left\{\|\dv\bu\|_{L^2(T_\ell)}
     + \|\dv\bu_r\|_{L^2(T_\ell)}\right\}.
\end{IEEEeqnarray*}
\end{enumerate}
\item
Now prisms, the middle term on the right of~(\ref{distancia_cero_arista}). Remember
the difference with the tetrahedron is that $d(P,\bv_\ell) \gtrsim h_1$.
We start pulling back from $P$ to the rescaled prism in Figure~\ref{rescaled_prism}
called here $\tilde P$.   
By the stability estimate in Theorem~\ref{thmStabilityKtildeRT}, 
\begin{IEEEeqnarray*}{rCl}
  \|\br_0\bu_s\|_{\scriptscriptstyle L^1(P)^3} & \leqslant & 
    \|M_P\|_\infty \|\tilde{\br}_0\tilde{\bu}_s\|_{L^1{\tilde{P}}} \\ [7pt]
  &\lesssim& \left\| \tilde{\bu}_s \right\|_{L^1(\tilde{P})^3}
    + \sum_{j=1}^3 h_j \left\| \partial_{\tilde{x}_j}\tilde{\bu}_s \right\|_{L^1(\tilde{P})^3}
    + h_{\tilde{P}}\left\|\dv(\tilde{u}_1, \tilde{u}_2, 0) \,\right\|_{L^1(\tilde{P})}\\[7pt]
  &\lesssim& \left\| \bu_s \right\|_{L^1(P)^3}
    + \sum_{j=1}^3 h_j \left\| \partial_{\xi_j}\bu_s \right\|_{L^1(P)^3}
    + h_{P}\left\|\dv(u_1, u_2, 0) \,\right\|_{L^1(P)}\mbox{,}    
\end{IEEEeqnarray*}
by the same argument as in~(\ref{aux_label15}) for 
elements touching the singular edge in the prismatic macro--element. Now
to estimate each term, again for $i=1$ or $2$ we have
\begin{IEEEeqnarray*}{rCcCl}
  \|u_{s,i}\| & \leqslant & \|R^{\nu}\theta^{\mu}\| \|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^2}
  & \leqslant & \textit{h}\,|P|^{\nicefrac12} \|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^2}
\end{IEEEeqnarray*}
and
\begin{IEEEeqnarray*}{rCcCl}
  \|u_{s,3}\| & \leqslant & \|R^{\nu}\theta\| \|R^{-\nu}\theta^{-1}u_{s,3}\|_{L^2}
  & \leqslant & \textit{h}\,|P|^{\nicefrac12} \|R^{-\nu}\theta^{-1}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
Next fix $j = 1$ or $2$.         %\noindent DErivatives: $j = 1$ or $2$.\\
If $i=1$ or $2$, with the same argument as in~(\ref{cuentita_integral})
\begin{IEEEeqnarray}{rCl}
  h_j\|\partial_{\xi_j} u_{s,i}\|_{L^1} & \lesssim &
    \textit{h}\,\sqrt{|P|}\,\|R^{1-\nu}\theta^{1-\mu}\partial_{\xi_j} u_{s,i}\|_{L^2}.
\end{IEEEeqnarray}
For the derivatives of $u_{s,3}$ we write
\begin{IEEEeqnarray*}{rCl}
  h_j\|\partial_{\xi_j}u_{s,3}\|_{L^1} &\leqslant&
    h_j \|R^{\nu-1}\|_{L^2}\|R^{1-\nu}\partial_{\xi_j}u_{s,3}\|_{L^2}\\[7pt]
  &\leqslant& h_j \|r^{\mu-1}\|_{L^2}\|R^{1-\nu}\partial_{\xi_j}u_{s,3}\|_{L^2}\\[7pt]
  &\lesssim& \textit{h}\,\sqrt{|P|}\,\|R^{1-\nu}\partial_{\xi_j}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
Now the case of the derivative along the direction of the singular edge 
$\partial_{\xi_3}(\cdot)$. Remember in this case it is 
$h_3\sim\textit{h}\,d(P,\bv)^{1-\nu}$. If we take first and second components,
\begin{IEEEeqnarray*}{rCl}
  h_3\|\partial_{\xi_3}u_{s,i}\|_{L^1}& = & h_3\|\partial_{\xi_i}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}\|R^{1-\nu}\partial_{\xi_i}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}|P|^{\nicefrac12}\|R^{1-\nu}\partial_{\xi_i}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
Third component:
\begin{IEEEeqnarray*}{rCl}
  h_3\|\partial_{\xi_3}u_{s,3}\|_{L^1}& \sim & \textit{h}\|d(P,\bv)^{1-\nu}
    \partial_{\xi_3}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}\|R^{1-\nu}\partial_{\xi_3}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}|P|^{\nicefrac12}\|R^{1-\nu}\partial_{\xi_3}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
For the divergence term,
\begin{IEEEeqnarray*}{rCl}
  h_P\|\dv(u_{s,1},u_{s,1},0)\|_{L1}&\leqslant&h_P\|\dv\bu_s\|_{L1}
    +h_P\|\partial_{\xi_3}u_{s,3}\|_{L1}\\[7pt]
    &\lesssim&h_P\|\dv\bu_s\|_{L1} + h_3\|\partial_{\xi_3}u_{s,3}\|_{L1}\mbox{;}
\end{IEEEeqnarray*}
the estimate for $h_P\|\dv\bu_s\|_{L1}$ follows as in~(\ref{aux_label66}), 
and the estimate for $h_3\|\partial_{\xi_3}u_{s,3}\|_{L1}$ should be
\begin{IEEEeqnarray*}{rCl}
  h_3\|\partial_{\xi_3}u_{s,3}\|_{L1} & \lesssim &
  \textit{h} |P|^{\nicefrac12}\|R^{1-\nu}\partial_{\xi_3}u_{s,3}\|_{L2} \\
  &\lesssim& \textit{h} |P|^{\nicefrac12}\|u_{s,3}\|_{V_{\beta,0}}.
\end{IEEEeqnarray*}
\end{enumerate}
Collecting all the estimates in items $2$ and $3$ above, using~(\ref{normaL2L1})
we bound the first and second term in~(\ref{distancia_cero_arista}), 
belonging to the case with zero distance
to the edge, in the $L^2$ norm.

\subsection{Bound for the Singular Part in a Tetrahedral Macro--Element
with Singular Vertex and no Singular Edge}
\noindent{\color{Orange}\#\#\#\#\#\#\# ponemos este?}
{\color{blue}\# continue here; anotar para seguir 
en el remark del caso de macroel. que me marcó ariel que faltar'ia 
(ver mi cuaderno)}
