\section{main global interpolation error theorem}
Now, to estimate the error, we start with inequality~(\ref{aux_label47}) of
Theorem~\ref{aux_label48} and work with each term in the right--hand side
in the non--convex case.

As in the meshing algorithm we proposed, the pyramids turned out to be isotropic,
we may use Proposition~\ref{propErrorInterpolacionPiramidesTetraedros} as the
local interpolation estimate.
Nevertheless, starting with the anisotropic Finite Element stability estimates
we proved in Theorem~\ref{aux_label53}  and in Theorem~\ref{aux_label54}   


 At the end of this proof we include weighted

The following is the main interpolation error theorem.
\begin{theorem}\label{interpolation_theorem} Let $\Omega$ and $f$ be the data and $(\bu,p)$ be the 
solution
of Problem~\ref{weakMixedContinuous}. Let  $\br_0$ be the operator~(\ref{global_interpolator}), then
  \begin{IEEEeqnarray*}{rCl}
    \|\bu-\rZerou\|_{0,\Omega} &\leqslant& C \textit{h}\|f\|_{0,\Omega}\\[5pt]
    \|p-P_{\scriptscriptstyle \Th}p\|_{0,\Omega} &\leqslant& 
    \mbox{>}C \textit{h}\|f\|_{0,\Omega}\mbox{ o bien }C \textit{h}\|p\|_{1,\Omega}\mbox{?}
  \end{IEEEeqnarray*}
\end{theorem}

\begin{lemma}
  The oerator~(\ref{global_interpolator}) is well defined because *** ver cuaderno
\end{lemma}

\begin{proof}[Proof of Theorem~\ref{interpolation_theorem}]
by Lemma~\ref{well_defined_dofs}, the field $\rZerou = r_0u_s + r_0u_r$ is well defined.

{\color{BrickRed}The case when there is no weight with respect to $R$ is also available by simply putting 
$R\equiv 1.$
The case when there is no weight with respect to $\theta$ is also available by simply putting 
$\theta\equiv 1.$

Additionally, if $\be$ is not singular, the condition turns $\delta > -\infty$
and if $\bv$ is not singular, the condition turns $\beta > -\infty.$}
\end{proof} 
**bound for the scalar variable: para todos igual, 
lo pongo una sola vez.
%%======================================================================================= 
% Recall that $\|\bw\|^2_{\mathbb{V}} = \|\bw\|^2_{0,\Omega} + \|\dv\,\bw\|^2_{0,\Omega}$ 
% and that, 
% First, for the divergence term,
% Primero usar el lemma de taylor promediado aplicado al caso sin derivar. Despu'es:
% If we apply this after the commutative diagram property~(\ref{div_commutativity})
% \begin{IEEEeqnarray*}{rCl}
% \|\dv(\bu - \rZerou)\|^2_{0,\Omega} & = &
%   \|\dv\,\bu - \dv\,\rZerou\|^2_{0,\Omega}\\
%     & = &\|\dv\,\bu - \boldsymbol{P}_{\mathcal{T}_h}\dv\,\bu\|^2_{0,\Omega}\\
%   &\leqslant&\textit{h}^2\,\|\dv\,\bu\|^2_{0,\Omega}\\
%   &=&\textit{h}^2\,\|f\|^2_{0,\Omega}.|
% \end{IEEEeqnarray*}
%%======================================================================================= 
In any macro--element, in order to bound the regular part,

Given an element $E$, let $\boldsymbol{h}=(h_{1},h_{2},h_{3})'=(h_{E,1},h_{E,2},h_{E,3})'$.
\begin{IEEEeqnarray*}{rCl}
  \|\bu_r - \br_0\bu_r\|_{L^2(\Omega)}^2 & = &
  \sum_{E\in\Th}
  \|\bu_r - \br_0\bu_r\|_{L^2(E)}^2\\
  &=&\sum_{E\in\Th}\left( \sum_{|\alpha| = 1} 
  \boldsymbol{h}^\alpha \|D^\alpha\bu_r\|_{L^2(E)} + 
  h_E\|\dv\bu_r\|_{L^2(E)}
  \right)^2\\
  &\leqslant&\sum_{E\in\Th}\left[\sum_{|\alpha| = 1}
  \boldsymbol{h}^{2\alpha} + h_E^{2} \right]
  \left[\sum_{|\alpha| = 1}\|D^\alpha\bu_r\|_{L^2(E)}^2 + 
  \|\dv\bu_r\|_{L^2(E)}^2\right].
\end{IEEEeqnarray*}
\noindent{\color{Orange}\#\#\#\#\#\#\# aca hay que poner la interpolacion en piramides
aparte tambien.} 
Now $\boldsymbol{h}\leqslant C\,\textit{h}$ and $h_E \leqslant C\,h_3 \sim \textit{h}$ for all the elements of the
mesh, so the last expression is bounded above by
\begin{IEEEeqnarray*}{rCl}
  C^2\sum_{E\in\Th}4\,\textit{h}^{2}
  \left[\sum_{|\alpha| = 1}\|D^\alpha\bu_r\|_{L^2(E)}^2 + 
  \|\text{div}\bu_r\|_{L^2(E)}^2\right]
  &=&C\,\textit{h}^{2}
  \left[\sum_{|\alpha| = 1}\|D^\alpha\bu_r\|_{L^2(\Omega)}^2 + 
  \|\text{div}\bu_r\|_{L^2(\Omega)}^2\right].
\end{IEEEeqnarray*}
Then, finally
\begin{IEEEeqnarray*}{rCl}
  \|\bu_r - \br_0\bu_r\|_{L^2(\Omega)}&\leqslant&
  C\,\textit{h}\,|\bu_r|_{1,\Omega}\\
  \mbox{by~(\ref{aux_label11})}&\leqslant&.C\,\textit{h}\,\|f\|_{0,\Omega}
\end{IEEEeqnarray*}
{\color{red} C\'omo pasamos a la norma de $f$?}

Now the bound for the error of the interpolation of the singular part,
which will be performed in each type of macro--element.

Now it is the time to make a remark of crucial importance. If we take the
solution $(\bu, p)$ of Problem~\ref{mixedContinuous},
the singular part of the vectorial variable, $\bu_s$, considered
in~(\ref{splitting}) has a well defined $H(div, \Omega)$--conforming interpolate.
This is implied by the next result, since the normal traces on faces
of the elements in $W^{1,1}(\Lambda_\ell)$ are well defined.
\begin{lemma}\label{well_defined_dofs}
If $\beta,\delta\in[0,1)$ and $\beta + \delta\leqslant 1$ then 
\[
  V^{1,2}_{\beta,\delta}(\Lambda_\ell) \subset W^{1,1}(\Lambda_\ell)
\]
for all macroelement $\Lambda_{\ell}$.
\end{lemma}
\begin{proof}
Every function ${\bv}\in V^{1,2}_{\beta,\delta}(\Lambda_\ell)$ has a finite
$L^1(\Lambda_\ell)$ norm. On the other hand,
\[
  R^{-\beta}\theta^{-\delta}\leqslant\left(\max_{\bx
  \in\Lambda_\ell}R(\bx)^\delta\right)
  r^{-\beta-\delta}
  \leqslant C r^{-\beta-\delta}\in L^2(\Lambda_\ell)
\]
which implies $\partial^\alpha{\bv}\in L^1(\Lambda_\ell)$ for all
$\bv\in V^{1,2}_{\beta,\delta}(\Lambda_\ell)$.
\end{proof}
\subsection{prismatic macro--element, bound singular part} % (fold)
\label{sub:bound_singular_part_prismatic_macroelement}
Let $\Lambda_\ell$ be a prismatic element of $\mathcal{T}_{\textit{h}_0}$.
Let $\be$ be the singular edge of $\Lambda_\ell$ and let 
$\bxi = (\xi_1,\xi_2,\xi_3)$ be it's local coordinates satisfying the hypotheses
of Theorem~\ref{thm_regularity}. In this case we need to
distinguish between the elements $E$ with $d(E,\be) > 0$ and
$d(E,\be) = 0$.
\begin{IEEEeqnarray}{rCl}
  \label{aux_label2}
  \| \bu_s - \br_0\bu _s\|_{L^2(\Lambda_\ell)}^2 &\leqslant&
  \sum_{d(E,\be) = 0} \left(\| \bu_s\|_{L^2(E)} + 
  \|\br_E\bu_s\|_{L^2(E)}\right)^2\\
  \nonumber
  & &\:+\sum_{d(E,\be) > 0} \left( \sum_{|\alpha| = 1} 
  \boldsymbol{h}^\alpha \|D^\alpha\bu_s\|_{L^2(E)} + 
  h_E\|\text{div}\bu_s\|_{L^2(E)}
  \right)^2.\\
  \label{aux_label}&&
\end{IEEEeqnarray}
The objective of the following paragraphs and items is to bound each one of the
terms involved in the right hand side of~(\ref{aux_label2}) and~(\ref{aux_label})
by a constant times
$\textit{h}$ times the norm of $f$, to sum everything up afterwards.
\paragraph{Elements with $d(E,\be) > 0$ (cfr.~(\ref{aux_label})).} % (fold)
\label{par:elements_with_d_pos}
\begin{enumerate}
\item {Bound for $\|\partial_{\xi_1}\bu_s\|_{L^2(E)}$, $\alpha = (1,0,1).$} % (fold)
\label{subp:bound_for_100} Pick any weight $w(\bx)\geqslant h_1$.
\begin{IEEEeqnarray*}{rCl}
  h_1\|\partial_{\xi_1}\bu_s\|_{L^2(E)}& = & 
    \sum_{i=1,2} \|h_1\partial_{\xi_1}u_{s,i}\|_{L^2(E)} +
      h_1\|\partial_{\xi_1}u_{s,3}\|_{L^2(E)}\\
  & \leqslant & \sum_{i=1,2} \|w(\bx)\partial_{\xi_1}u_{s,i}\|_{L^2(E)} +
      h_1\|u_{s,3}\|_{V_0^{1,2}(E)}.
\end{IEEEeqnarray*}
Now it turns out that if we could choose $w(\bx) = \textit{h}\,r(\bx)^\delta \geqslant h_1$
for some $\delta$, then
we would have
\begin{IEEEeqnarray*}{rCl}
  h_1\|\partial_{\xi_1}\bu_s\|_{L^2(E)}
  &\leqslant&\textit{h} \sum_{i=1,2} \|u_{s,i}\|_{V_\delta^{1,2}(E)} +
      \textit{h}\|u_{s,3}\|_{V_0^{1,2}(E)}\\
  \yesnumber\label{aux_label1}
  &\leqslant&C\,\textit{h}\|f\|_{L^2(\Lambda_\ell)}.
\end{IEEEeqnarray*}
Let's look for $\delta$. We have $r(\bx)\geqslant d(E,\be)$ so, according to the
grading~(\ref{label_grading}) , in the 
case $0< d(E,\be) <1$, it holds
\begin{IEEEeqnarray*}{rClCl}
  \textit{h}\,r(\bx)^{1-\mu}&\geqslant&\textit{h}\,d(E,\be)^{1-\mu}&\sim& h_1.
\end{IEEEeqnarray*}
In the 
case $d(E,\be) \sim 1$
\begin{IEEEeqnarray*}{rClCl}
  \textit{h}\,r(\bx)^{1-\mu}&\gtrsim&\textit{h}&\sim& h_1.
\end{IEEEeqnarray*}
In both cases we have to take $\delta \sim 1-\mu > 1 - \frac{\pi}{\omega_\ell}$
to get the estimate~(\ref{aux_label1}).
The bound for the term with
$\alpha = (0,1,0)$ is done similarly.
\item Bound for $\|\partial_{\xi_3}\bu_s\|_{L^2(E)}$. % (fold)
\label{subp:bound_for_001}
If $i = 1$,$2$ or $3$, $\partial_{\xi_3}u_i$ equals $\partial_{\xi_i}u_3$, so
\begin{IEEEeqnarray*}{rCl}
  h_3^2\|\partial_{\xi_3}\bu_s\|^2_{L^2(E)}& = & 
     h_3^2\sum_{i=1,2,3}\|\partial_{\xi_3}u_{s,i}\|^2_{L^2(E)}\\
    &\lesssim&\textit{h}^2\,\| u_3 \|^2_{V_0^{1,2}(\Lambda_\ell)}
    \leqslant\textit{h}^2\,\|f\|^2_{L^2(\Lambda_\ell)}.
\end{IEEEeqnarray*}
\item {Bound for the divergence.} By the grading in this macro--element and
the triangle inequality we have
\label{subp:bound_for_the_div}
\begin{IEEEeqnarray*}{rCl}
  h_K\,\| \dvg\bu_s \|_{L^2(E)} & \lesssim &
  {h_3}\,\|\dvg\bu_s\|_{L^2(\Lambda_\ell)}\sim
  \textit{h}\,\|\dvg\bu_s\|_{L^2(\Lambda_\ell)}\\[7pt]
  &\leqslant&\textit{h}\,(\|f\|_{L^2(\Lambda_\ell)}+
  \|\dvg\bu_r\|_{L^2(\Lambda_\ell)})\lesssim\textit{h}\,\|f\|_{L^2(\Lambda_\ell)}.
\end{IEEEeqnarray*}
\end{enumerate}
\paragraph{Elements with $d(E,\be) = 0$ \mbox{(cfr.~(\ref{aux_label2}))}.}
Take $\delta \sim 1-\mu$ in this paragraph again.
\begin{enumerate}
  \item Bound for $\| \bu_s\|_{L^2(E)}$. % (fold)
\begin{IEEEeqnarray*}{rCl}
  \|\bu_s\|^2_{L^2(E)}& = & \sum_{i=1,2}\|{u_{s,i}}\|^2_{L^2(E)} + 
    \|{u_{s,3}}\|^2_{L^2(E)}\\
  &=&\sum_{i=1,2}\|r(\bx)^{1-\delta} r(\bx)^{\delta-1} {u_{s,i}}\|^2_{L^2(E)}
    + \|r\,r^{-1} {u_{s,3}}\|^2_{L^2(E)}\\
  &\leqslant& \max r(\bx)^{2(1-\delta)}\sum_{i=1,2}\|{u_{s,i}}\|^2_{V_\delta^{1,2}(\Lambda_\ell)}
  + \max_{\bx\in E} r(\bx)^{2}\|{u_{s,3}}\|^2_{V_0^{1,2}(\Lambda_\ell)}\\
  &\lesssim& h_1^{2(1-\delta)}\sum_{i=1,2}\|{u_{s,i}}\|^2_{V_\delta^{1,2}(\Lambda_\ell)}
  + h_1\|{u_{s,3}}\|^2_{V_0^{1,2}(\Lambda_\ell)}\\
  &\sim&  (\textit{h}^{\nicefrac{2}{\mu}})^\mu\sum_{i=1,2}\|{u_{s,i}}\|^2_{V_\delta^{1,2}(\Lambda_\ell)}
  + (\textit{h}^{\nicefrac{1}{\mu}})^2\|{u_{s,3}}\|^2_{V_0^{1,2}(\Lambda_\ell)}\\
  (\mbox{$\mu \leqslant 1$})&\leqslant& C\,\left\{\textit{h}^2\sum_{i=1,2}\|{u_{s,i}}\|^2_{V_\delta^{1,2}(\Lambda_\ell)}
    + \textit{h}^2\|{u_{s,3}}\|^2_{V_0^{1,2}(\Lambda_\ell)}\right\} \\
  &\leqslant& C\,\textit{h}^2\,\|f\|^2_{L^2(\Lambda_\ell)}.
\end{IEEEeqnarray*}
\item {Bound for $\| \br_E \bu_s \|_{L^2(E)^3}$.} % (fold)
First, if $\phi$ is a scalar polynomial defined on a physical element $E$, then
\begin{IEEEeqnarray}{rCl}\label{normaL2L1}
  \| \phi \|_{L^{2}(E)} & \leqslant & C\,|E|^{-1/2}\,\| \phi \|_{L^{1}(E)}.
\end{IEEEeqnarray}
Now we estimate the $L^1$ norms, starting with the stability estimate in 
the rescaled element $\tilde{E}$ of Figure~(\ref{rescaled_prism}).
As in our mesh we are considering right prisms and local coordinates
in $\Lambda_\ell$ such that $\xi_3$ is the direction containing the singular
edge $\be_\ell$, there is a matrix $M_E$ of the form 
\begin{equation}\label{matrix_A}
  M_E=
    \left(\begin{array}{ccc}a_{11}&a_{12}&0\\a_{21}&a_{22}&0\\0&0&1\end{array}\right)
\end{equation}
for which an affine transform $F_E$ with matrix $M_E$ maps $\tilde{E}$ onto $E$.
The infinity
norm of $\left(\begin{array}{cc}a_{11}&a_{12}\\a_{21}&a_{22}\end{array}\right)$
is bounded by a quantity $c_E$ depending only on the maximun angle of the projection
of $E$ onto the $(\xi_1,\xi_2)$ plane and the infinity norm of its inverse
is bounded by one.
So changing variables and pulling
back to $\tilde E$ we get 
\begin{IEEEeqnarray*}{rCl}
  \| (\br_E\bu_s)_1 \|_{L^{1}(E)}  & = & \int_E |(\br_E\bu_s)_1|\,d\bx\\
        & = & \int_{\tilde{E}} |(M_E\,\tilde{\br}_{\tilde E}\tilde{\bu}_s)_1|\,d\tilde{\bx}\\
        & \leqslant & c_E \left[\|\tilde{u}_{s,1}\|_{L^1(\tilde{E})} + \|\tilde{u}_{s,2}\|_{L^1(\tilde{E})}\right.\\
   &    & +\;h_1 \left( \| \partial_{1} \tilde{u}_{s,1} \|_{L^{1}(\tilde{E})} +
        \| \partial_{1} \tilde{u}_{s,2} \|_{L^{1}(\tilde{E})}\right)\\
   &    & +\;h_2 \left( \| \partial_{2} \tilde{u}_{s,1} \|_{L^{1}(\tilde{E})} +
        \| \partial_{2} \tilde{u}_{s,2} \|_{L^{1}(\tilde{E})}\right)\\
\yesnumber\label{aux_label3}
   &    & +\;\left.h_3 \left( \| \partial_{3} \tilde{u}_{s,1} \|_{L^{1}(\tilde{E})} +
        \| \partial_{3} \tilde{u}_{s,2} \|_{L^{1}(\tilde{E})}\right) + 
          2 h_1\|\dv(\tilde{u}_{s,1},\tilde{u}_{s,2},0)\|_{L^{1}(\tilde{E})}\right].
\end{IEEEeqnarray*}
Now the work comes to rewrite and bound each term in~(\ref{aux_label3}).
Recalling the properties~(\ref{transfDiv}) and~(\ref{derivadaPiola}) about the derivatives
with coordinate changes,
\begin{IEEEeqnarray*}{rCl}
  \|\tilde{u}_{s,1}\|_{L^1(\tilde{E})} & = &
  \frac{1}{|\det(M_E)|} \int_{E} \left|\tilde{u}_{s,1}(F_E^{-1}(\bx))\right|\,d\bx\\
    & =   &         \int_{E} |(M_E^{-1})_{\text{row}_1}\bu_s(\bx)|\,d\bx\\
    & \leqslant & \|M_E^{-1}\|_\infty\left(\|u_{s,1}\|_{L^1(E)} + \|u_{s,2}\|_{L^1(E)}\right)\\
    & \leqslant & \left(\|u_{s,1}\|_{L^1(E)} + \|u_{s,2}\|_{L^1(E)}\right)
\end{IEEEeqnarray*}
and by the same reasons
\begin{IEEEeqnarray*}{rCl}
  \|\tilde{u}_{s,2}\|_{L^1(\tilde{E})} & \leqslant & \left(\|u_{s,1}\|_{L^1(E)} + \|u_{s,2}\|_{L^1(E)}\right).
\end{IEEEeqnarray*}
For the first derivatives, let $k,l = 1$ or $2$. 
\begin{IEEEeqnarray*}{rCl}
  \|\partial_{\tilde{x}_l} \tilde{u}_{s,k}\|_{L^1(\tilde{E})} 
  & = & \frac{1}{|\det(M_E)|} \int_{E} \left|\det(M_E)\,(M_E^{-1})_{\text{row}_k}\,
  D\bu_s(\bx)\,(M_E)_{\text{col}_l}\right|\,d\bx\\
  %& \leqslant & \|M_E^{-1}_{\text{row}_k}\|_\infty\|A_{\text{col}_l}\|_\infty\sum_{i,j = 1,2} \|\partial_{\xi_j}u_{s,i}\|_{L^{1}(E)}\\
  & \leqslant & \|\partial_{\xi_j}\bu_{s}\|_{L^{1}(E)^3}
\end{IEEEeqnarray*}
and, similarly, if $k=1,2$
\begin{IEEEeqnarray*}{rCl}
  \|\partial_{\tilde{x}_3} \tilde{u}_{s,k}\|_{L^1(\tilde{E})} & \leqslant &
  \|M_E^{-1}\|_\infty\sum_{i = 1,2} \|\partial_{\xi_3}u_{s,i}\|_{L^{1}(E)}.
\end{IEEEeqnarray*}
To cope with the divergence term, because of the blocks of the matrix $M_E$
we have
\begin{IEEEeqnarray*}{rCl}
  (u_1(F_E\tilde\bx), u_2(F_E\tilde\bx), 0)' & = &
\frac{1}{\det M_E}\,M_E\, (\tilde{u}_1(\tilde{\bx}), \tilde{u}_2(\tilde{\bx}), 0)'\mbox{,}\\
{\dv}({u}_1,{u}_2,0)'&=&\frac{1}{\det M_E} \dv(\tilde{u}_1,\tilde{u}_2,0)'.
\end{IEEEeqnarray*}
Then, changing variables,
\begin{IEEEeqnarray*}{rCl}
  \|\dv(\tilde{u}_{s,1},\tilde{u}_{s,2},0)'\|_{L^{1}(\tilde{E})} &=&
  \|\dv(u_{s,1},u_{s,2},0)'\|_{L^{1}(E)}.
\end{IEEEeqnarray*}
Finally joining everything,
\begin{IEEEeqnarray*}{rCl}
  \| (\br_E \bu_s)_1 \|_{L^{1}(E)} & \leqslant & C \left\{ 
  \|u_{s,1}\|_{L^1(E)} + \|u_{s,2}\|_{L^1(E)}\right.\\
  & &+\;h_1\|\partial_{\xi_1}\bu_{s}\|_{L^{1}(E)^3} +
    h_2\|\partial_{\xi_2}\bu_{s}\|_{L^{1}(E)^3} +
  h_3 \sum_{i = 1,2} \|\partial_{\xi_3}u_{s,i}\|_{L^{1}(E)}\\
  \yesnumber\label{aux_label15}
  & &\left. +\;h_1 \|\dv(u_{s,1}, u_{s,2}, 0)'\|_{L^{1}(E)}\right\}.
\end{IEEEeqnarray*}
{\color{red} PESOS: revisar desde ac\'a por la correcci\'on de la p\'agina anterior.}
Now we enumerate the bound for each term on right of~(\ref{aux_label15}).
\begin{enumerate}
    \item
  for $\|u_{s,i}\|$,
  \begin{IEEEeqnarray*}{rCl}
    \|u_{s,i}\|_{L^1(E)} & = & 
    \| r(\bx)^{1-\delta} r(\bx)^{\delta-1} u_{s,i}\|_{L^1(E)}\\
    &\leqslant& \|r^{1-\delta}\|_{L^2(E)} \|u_{s,i}\|_{V_\delta^{1,2}(E)}\\
    &\leqslant& C\,h_1^{1-\delta}\,|E|^{\nicefrac12}\,\|u_{s,i}\|_{V_\delta^{1,2}(E)}\\
    &\leqslant& C\,\textit{h}\,|E|^{\nicefrac12}\,\|u_{s,i}\|_{V_\delta^{1,2}(E)}
  \end{IEEEeqnarray*}
    \item
  With respect to the derivatives orthogonal to the singular edge, take $i$,$j = 1$,$2$ and,
  by H\"older's inequality,
  \begin{IEEEeqnarray}{rCl}\label{aux_label16}
    h_1\|\partial_{\xi_j}u_{s,i}\|_{L^1(E)} &\leqslant&
    h_1\,\|r^{-\delta}\|_{L^2(E)}\,\|u_{s,i}\|_{V_\delta^{1,2}(E)}.
  \end{IEEEeqnarray}
  Integrating the radial weight $r^{-\delta}$ we get
  \begin{IEEEeqnarray*}{rCl}
    \|r^{-\delta}\|_{L^2(E)} & \leqslant & C\, h_1^{-\delta}\,h_1\,h_3^{\nicefrac12}\\
    & \sim & h_1^{-\delta}(h_1h_2h_3)^{\nicefrac12}\\
    &\leqslant& C\, h_1^{-\delta} |E|^{\nicefrac12},
  \end{IEEEeqnarray*}
  (where we used $h_1 \sim h_2$ and the minimun angle condition to bound the
  area of a triangular face from below with $h_1h_2$). So in~(\ref{aux_label16})
  we have
  \begin{IEEEeqnarray*}{rCl}
    h_1\|\partial_{\xi_j}u_{s,i}\|_{L^1(E)} & \leqslant & C\,h_1^{1-\delta} |E|^{\nicefrac12}
    \|u_{s,i}\|_{V_\delta^{1,2}(E)}\\
    &\sim& (\textit{h}^{1/\mu})^{\mu} |E|^{\nicefrac12}
    \|u_{s,i}\|_{V_\delta^{1,2}(E)}\\
    \label{derivOrtog} \yesnumber &=&|E|^{\nicefrac12}\,\textit{h}\,\|u_{s,i}\|_{V_\delta^{1,2}(E)}.
  \end{IEEEeqnarray*}
    \item
  For the derivatives along the singular edge we use $\bu = \nabla p$ to
  commute the indices of the derivatives and H\"older's inequality. We have
  \begin{IEEEeqnarray*}{rCl}
    h_3\,\| \partial_{\xi_3}u_{s,i} \|_{L^1(E)} &=& h_3\,\| \partial_{\xi_i}u_{s,3} \|_{L^1(E)}\\
    &\leqslant& h_3\,|E|^{\nicefrac12}\,\| \partial_{\xi_i}u_{s,3} \|_{L^2(E)}\\
    \yesnumber\label{alongSingular}&\leqslant& C\,|E|^{\nicefrac12}\,\textit{h}\,\| u_{s,3} \|_{V_0^{1,2}(E)}.
  \end{IEEEeqnarray*}
    \item
  For the divergence we can recall the grading condition $h_1\sim h_2$, observe that
  \begin{IEEEeqnarray*}{rCl}
    h_1 \|\text{div}(u_{s,1}, u_{s,2}, 0)\|_{L^{1}(E)} & \leqslant &
    h_1 \|\partial_{\xi_1} u_{s,1}\|_{L^{1}(E)} + h_1\|\partial_{\xi_2} u_{s,2}\|_{L^{1}(E)}
  \end{IEEEeqnarray*}
  and reuse the estimates~(\ref{derivOrtog}). 
\end{enumerate}
The estimate for 
$\| (\br \bu_s)_2 \|_{L^{2}(E)}$ is the same. The estimate for 
$\| (\br \bu_s)_3 \|_{L^{2}(E)}$ is as follows. By the commutativity of the
local interpolator and the coordinate change in Corollary~\ref{aux_label17} and
the estimate~(\ref{aux_label18}) in the proof Theorem~\ref{thmStabilityKtildeRT} we have
\begin{IEEEeqnarray*}{rCl}
  \| (\br_E\bu_s)_3 \|_{L^{1}(E)}
  & =     &
  \| (\br_{\tilde E}\tilde{\bu}_s)_3 \|_{L^{1}(\tilde{E})}\\
  & \leqslant & C\,\big{\{}\,\|\tilde{u}_{s,3}\|_{L^1(\tilde{E})} +
    \sum_{j=1}^3 h_j\,\|\partial_{\tilde{x}_j}\tilde{u}_{s,3}\|_{L^1(\tilde{E})}\,\big{\}}
\end{IEEEeqnarray*}
{\color{blue}\#\#\#\#\#\#\#\# continue here; chequear con cuadernoen  "(*) Deriv."
y anotar para seguir 
en el remark del caso de macroel. que me marcó ariel que faltar'ia (ver mi cuaderno) }
by~(\ref{matrix_A}) and the considerations made there, the last is bounded by
\begin{IEEEeqnarray*}{rCl}
  C\,(\,\|{u}_{s,3}\|_{L^1({E})} +
    \sum h_j\|\partial_{\xi_j}{u}_{s,3}\|_{L^1({E})}).
\end{IEEEeqnarray*}

Now
\begin{IEEEeqnarray*}{rCl}
  \|u_{s,3}\|_{L^1(E)} &\leqslant& \|r\|_{L^2(E)} \,\|r^{-1}\,u_{s,3}\|_{L^2(E)}\\
              &\leqslant&C\,h_1\,|E|^{\frac{1}{2}}\,\|u_{s,3}\|_{V_0^{1,2}(\Lambda_\ell)}\\
              &\leqslant&C\,\textit{h}\,|E|^{\frac{1}{2}}\,\|u_{s,3}\|_{V_0^{1,2}(\Lambda_\ell)}. 
\end{IEEEeqnarray*}
We have also {\color{red} (al final no va $(h_1 + h_2)$)}
\begin{IEEEeqnarray*}{rCl}
  (h_1 + h_2)\sum_{i=1,2} \|\partial_{{x}_i}{u}_{s,3}\|_{L^1({E})} &\leqslant&
  C\,|E|^{\nicefrac12}\,\textit{h}\,\|u_{s,3}\|_{V_0^{1,2}(\Lambda_\ell)}
\end{IEEEeqnarray*}
and~(\ref{alongSingular})
\begin{IEEEeqnarray*}{rCl}
  h_3\,\|\partial_{\xi_3}u_{s,3}\|_{L^1(E)} &\leqslant& C\,|E|^{\nicefrac12}\,\textit{h}\,\|f\|_{L^2{(\Lambda_\ell)}}.
\end{IEEEeqnarray*}
At last, having the bound for each of the three components, by~(\ref{normaL2L1}), {\color{BrickRed}(redactar mejor)}
\begin{IEEEeqnarray*}{rCl}
  \|\br \bu_s\|_{L^{2}(E)} &\leqslant& C\,\textit{h}\,\|f\|_{L^2(\Lambda_\ell)}.
\end{IEEEeqnarray*}
\end{enumerate}
% paragraph elements_with_d0 (end)
% subsection bound_singular_part_prismatic_macroelement (end)

\subsection{bound singular part tetrahedral macroelement
with vertex and edge singularities} % (fold)
{\color{brown}Table~\ref{element_classification} shows what has to be done for each type of
element. The rest of the needed estimates are contained in the proof of
the former case.
\begin{table}
\centering
\caption{Parte singular.}
\label{element_classification}
  \begin{IEEEeqnarraybox}
  [\IEEEeqnarraystrutmode
   \IEEEeqnarraystrutsizeadd{0pt}{0pt}]{v/c/v/c/v/c/v/c/v}
    \IEEEeqnarrayrulerow\\
    \IEEEeqnarrayseprow[3pt]\\
    &\hfill\raisebox{22pt}[0pt][0pt]{$d(E,\textbf{e})>0$}\hfill
                & & \referencePrismTikz{1.5} 
              & & \referencePyramidTikz{1.5}
                & & \referenceTetrahedronTikz{1.1}&\\
    \IEEEeqnarrayrulerow\\
    \IEEEeqnarrayseprow[3pt]\\
    &\hfill\raisebox{30pt}[0pt][0pt]{$d(E,\textbf{e})=0$}\hfill& &
      \begin{IEEEeqnarraybox}{c}
      \referencePrismTikz{1.5}\\d(E,\textbf{v}) > 0
      \end{IEEEeqnarraybox}
    &&&&
      \begin{IEEEeqnarraybox}{c}
        \referenceTetrahedronTikz{1.1}\d(E,\textbf{v}) = 0
      \end{IEEEeqnarraybox}
    &\\
    \IEEEeqnarrayseprow[3pt]\\
    \IEEEeqnarrayrulerow
  \end{IEEEeqnarraybox}
\end{table}
[color brown end]}

Parte singular:
\begin{IEEEeqnarray*}{rCl}
  \|\bu_s - \pi\bu_s\|^2_{\scriptscriptstyle L^2(\Lambda_\ell)^3}
  &=&\sum_{d(E,\be) = 0}
  \|\bu_s - \pi\bu_s\|^2_{\scriptscriptstyle L^2(E)^3}+
  \sum_{d(E,\be) > 0}
  \|\bu_s - \pi\bu_s\|^2_{\scriptscriptstyle L^2(E)^3}\\[7pt]
\end{IEEEeqnarray*}
Parte con $d(E,\be)>0$. Recordar c\'omo son los nuevos $h_1,h_2,h_3$.
%% (y,z,x)
\begin{center}
\begin{tikzpicture}[rotate=0,scale=1,shape border uses incircle,shape border rotate=-30]
  \node [name=t,shape=trapezium,draw,minimum width=2cm,
      trapezium left angle=120] at (0,0,0) {};
  
  \coordinate (punta) at (0,0,3);

  \coordinate (tl) at (t.top left corner);
  \coordinate (tr) at (t.top right corner);
  \coordinate (bl) at (t.bottom left corner);
  \coordinate (br) at (t.bottom right corner);

  \draw (tl) -- (punta);
  \draw (bl) -- (punta);
  \draw (tr) -- (punta);
  \draw (br) -- (punta);
  
  \coordinate (k1) at ($0.70*(tl) + 0.30*(punta)$);
  \coordinate (k2) at ($0.5*(tl) + 0.5*(tr)$);
  \coordinate (k3) at ($0.4*(tl) + 0.6*(bl)$);

  \node [left=1mm] (eta1) at (k1) {$\boldsymbol{\eta_1}$};
  \node [right=1mm] (eta2) at (k2) {$\boldsymbol{\eta_2}$};
  \node [below=0.5mm,right] (eta3) at (k3) {$\boldsymbol{\eta_3}$};

  \draw [->,thick] (tl) -- (k1);
  \draw [->,thick] (tl) -- (k2);
  \draw [->,thick] (tl) -- (k3);
\end{tikzpicture}
\end{center}
\noindent{\color{BrickRed}\#\#\#\#\#\#\# preguntar a Ariel, porque
tal vez con los virtuales, este p\'arrafo no hace falta\\
$K$ es una pir\'amide
} 
\begin{IEEEeqnarray*}{rCl}
  \|\textbf{u}_s - \pi\textbf{u}_s\|^2_{\ss L^2(E)}&\leqslant&
  h_1^2\|\gancho_{\eta_1}\textbf{u}_s\|^2+
  h_2^2\|\gancho_{\eta_2}\textbf{u}_s\|^2+
  h_3^2\|\gancho_{\eta_3}\textbf{u}_s\|^2+
  h_K^2\|\dvg\textbf{u}_s\|^2\\[7pt]
\end{IEEEeqnarray*}
\begin{IEEEeqnarray*}{rCl}
  h_1\|\gancho_{\eta_1}\textbf{u}_s\|&=&
  h_1\sum_{i=1}^3 \|\gancho_{\eta_1}\textbf{u}_{s,i}\|\\
  &\leqslant&
    \textit{h}\sum_{i=1}^3 \|r^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,i}\|\\
  &\leqslant&
    \textit{h}\left(
     \sum_{i=1}^2 \|R^{1-\mu}\theta^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,i}\|+
     \|R^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
    \textit{h}\left(
     \sum_{i=1}^2 \|R^{1-\nu}\theta^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,i}\|+
     \|R^{1-\nu}\gancho_{\eta_1}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
    \textit{h}\left(
    \sum_{i=1}^2 \|R^{\beta}\theta^{\delta}\gancho_{\eta_1}\textbf{u}_{s,i}\|+
     \|R^{\beta}\gancho_{\eta_1}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
    \textit{h}
    \left(\sum_{i=1}^2 \|\textbf{u}_{s,i}\|_{\scriptscriptstyle \beta,\delta}+
         \|\textbf{u}_{s,3}\|_{\scriptscriptstyle \beta,0}\right).
\end{IEEEeqnarray*}
Now, since $h_2\sim h_1$:
\begin{IEEEeqnarray*}{rCl}
  h_2\|\gancho_{\eta_2}\textbf{u}_s\|&=&
  h_2\sum_{i=1}^3 \|\gancho_{\eta_2}\textbf{u}_{s,i}\|\\
  &\leqslant&
    \textit{h}
    \left(\sum_{i=1}^2 \|\textbf{u}_{s,i}\|_{\scriptscriptstyle \beta,\delta}+
         \|\textbf{u}_{s,3}\|_{\scriptscriptstyle \beta,0}\right).
\end{IEEEeqnarray*}
\begin{IEEEeqnarray*}{rCl}
  h_3\|\gancho_{\eta_3}\textbf{u}_s\|&=&
  h_3\sum_{i=1}^3 \|\gancho_{\eta_3}\textbf{u}_{s,i}\|\\[7pt]
  &=&h_3\left(\sum_{i=1}^2\|\gancho_{\eta_i}\textbf{u}_{s,3}\|+
    \|\gancho_{\eta_3}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&\textit{h}\left(\sum_{i=1}^2\|d(E,v)^{1-\nu}\gancho_{\eta_i}\textbf{u}_{s,3}\|+
    \|d(E,v)^{1-\nu}\gancho_{\eta_3}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
  \textit{h}\left(\sum_{i=1}^2\|R^{\beta}\gancho_{\eta_i}\textbf{u}_{s,3}\|+
    \|R^{\beta}\gancho_{\eta_3}\textbf{u}_{s,3}\|\right)\\[7pt]
  &=&
  \textit{h}\sum_{i=1}^3\|R^{\beta}\gancho_{\eta_i}\textbf{u}_{s,3}\|\\[7pt]
  &\lesssim&
  \textit{h}\|\textbf{u}_{s,3}\|_{\scriptscriptstyle \beta,0}
\end{IEEEeqnarray*}
\begin{IEEEeqnarray*}{rCl}
  h_K\|\dvg\textbf{u}_s\|&\leqslant&
  h_K\|\dvg\textbf{u}_s+\dvg\textbf{u}_r\|+h_K\|\dvg\textbf{u}_r\|\\[7pt]
  &\lesssim&h_K\|f\|\sim \textit{h}\|f\|.
\end{IEEEeqnarray*}
Parte con ${\color{red} d(E,\be)=0}$.
\begin{IEEEeqnarray}{rCl}
  \label{distancia_cero_arista}\sum_{d(E,\be) = 0}
  \|\textbf{u}_s - \pi\textbf{u}_s\|^2_{\scriptscriptstyle L^2(E)^3}
  &\lesssim&
  {\color{green} \|\textbf{u}_s\|^2} + 
    {\color{blue}\|\pi\textbf{u}_s\|^2_{\scriptscriptstyle L^2(Tetra)^3}}\\[5pt]
  &&\,+\sum_{
  \substack{\text{ prisms }K\\
        d(E,\be) = 0}
    }
  {\color{green} \|\textbf{u}_s\|^2} + {\color{olive} \|\pi\textbf{u}_s\|^2_{\scriptscriptstyle L^2(E)^3}}.
\end{IEEEeqnarray}
\\[10pt]
Si $K$ es tanto el tetraedro con el v\'ertice singular como un prisma 
($d(E,\be) = 0$, $d(E,v) > 0$):
\begin{IEEEeqnarray*}{rCl}
  {\color{green} \|\textbf{u}_s\|} &=&
    \sum_{i=1}^2 \|R^\nu\theta^\mu R^{-\nu}\theta^{-\mu}\textbf{u}_{s,i}\|
    + \|R^\nu\theta^{-1}R^{-\nu}\theta\textbf{u}_{s,3}\|\\[7pt]
  &\leqslant&\max_{\bx}R(\bx)^\nu\theta(\bx)^\mu
  \sum_{i=1}^2 \|R^{-\nu}\theta^{-\mu}\textbf{u}_{s,i}\|
    + \max_{\bx}R(\bx)^\nu\theta(\bx)
    \|R^{-\nu}\theta^{-1}\textbf{u}_{s,3}\|.
\end{IEEEeqnarray*}
Pero es $\theta < 1$ y $\mu \leqslant \nu < 1$, entonces
\begin{IEEEeqnarray}{rClClCr}
  \label{cota_pesos}
  R(\bx)^\nu\theta(\bx)&\leqslant&
  R(\bx)^\nu\theta(\bx)^\mu&\leqslant&R(\bx)^\mu\theta(\bx)^\mu&=&
  r(\bx)^\mu.
\end{IEEEeqnarray}
Volvemos y queda
\begin{IEEEeqnarray*}{rCl}
  \|\textbf{u}_s\|&\leqslant&\max_{\bx}r(\bx)^\mu
  \left(
    \sum_{i=1}^2 \|R^{-\nu}\theta^{-\mu}\textbf{u}_{s,i}\|
    + \|R^{-\nu}\theta^{-1}\textbf{u}_{s,3}\|
  \right)\\[7pt]
  &\leqslant&\max\{h_1,h_2\}^\mu
  \left(
    \sum_{i=1}^2 \|R^{-\nu}\theta^{-\mu}\textbf{u}_{s,i}\|
    + \|R^{-\nu}\theta^{-1}\textbf{u}_{s,3}\|
  \right)\\[7pt]
  &\lesssim&\textit{h}
  \left(
    \sum_{i=1}^2 \|\textbf{u}_{s,i}\|_{\beta,\delta}
    + \|\textbf{u}_{s,3}\|_{\beta,0}
  \right) \lesssim \textit{h}\,\|f\|,
\end{IEEEeqnarray*}
con tal de tomar $\beta\sim 1-\nu$ y $\delta\sim 1-\mu$.\\[10pt]
${\color{blue}\|\pi\textbf{u}_s\|^2_{\scriptscriptstyle L^2(Tetra)^3}}$: First
\begin{IEEEeqnarray*}{rCl}
  \|(\pi\textbf{u}_s)_1\|_{\scriptscriptstyle L^2(E)}
    & \leqslant & C|E|^{-1/2} \|(\pi\textbf{u}_s)_1\|_{\scriptscriptstyle L^1(E)}.
\end{IEEEeqnarray*}
Now, by Prop 3.4 de AADL
{\color{Orange}\#\#\#\#\#\#\#\# Remember $\bu_s$ is in $W^{1,1}(\Lambda_\ell)$.}
\begin{IEEEeqnarray*}{rCl}
  \|(\pi\textbf{u}_s)_1\|_{L^1(E)} &=& \ldots\\[7pt]
  & = &\int\limits_{\tilde{E}}|(A\tilde{\pi}\tilde{\textbf{u}}_s)_1|\,d\tilde{x}\\[7pt]
    &\lesssim&\sum_{1\leqslant i\leqslant 3} \left(\|\tilde{u}_{s,i}\|_{L^1(\tilde{E})} + 
      \sum_{1\leqslant j\leqslant 3} h_j\|\partial_j\tilde{u}_{s,i}\|_{L^1(\tilde{E})} + 
      h_i\|\dvg \tilde{\textbf{u}}_s\|_{L^1(\tilde{E})}
    \right) \\[7pt]
    & = & \ldots \text{paso al tetraedro f\'isico} \ldots \\[7pt] % VER BORRADOR INTERPOLACION PIRAMIDE
    & \leqslant & C
    \left({\color{orange} \|\textbf{u}_{s}\|_{L^1(E)^3}} + 
    \sum_{1\leqslant j \leqslant 3} {\color{teal} h_j\|\partial_{\xi_j}\textbf{u}_{s}\|_{L^1(E)}} + 
    {\color{purple} (h_1+h_2+h_3) \|\dvg \textbf{u}_s\|_{L^1(E)}}\right).
\end{IEEEeqnarray*}
PESOS
\begin{IEEEeqnarray*}{rCl}
  {\color{Orange} \|\textbf{u}_{s}\|_{L^1(E)^3}} & = &
  \sum_{i=1,2}\|R^{\nu}\theta^{\mu}R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^1(E)} + 
  \|R^{\nu}\theta R^{-\nu}\theta^{-1}u_{s,3}\|_{L^1(E)} \\[7pt]
\text{H\"older\quad}&\leqslant&
\sum_{i=1,2}\|R^{\nu}\theta^{\mu}\|_{L^2(E)}\|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^2(E)} + 
  \|R^{\nu}\theta\|_{L^2(E)}\|R^{-\nu}\theta^{-1}u_{s,3}\|_{L^2(E)}
 \\[7pt]
&\leqslant&
\max_{\bx}R(\bx)^\nu\theta(\bx)^{\mu}|E|^{\nicefrac12}
\sum_{i=1,2}\|\ldots u_{s,i}\|_{L^2} + 
\max_{\bx}R(\bx)^\nu\theta(\bx)|E|^{\nicefrac12}
\|\ldots u_{s,3}\|_{L^2}\\[7pt]
\text{por~(\ref{cota_pesos})\quad}&\leqslant&
(\textit{h}^{1/\mu})^\mu|E|^{\nicefrac12}
\sum_{i=1,2}\|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^{2}(E)} +
\|\ldots u_{s,3}\|_{L^{2}(E)}\\[7pt]
&\leqslant&\textit{h} |E|^{\nicefrac12}
\|\textbf{u}_s\|_{V_{\beta,\delta}^{1,2}(E)^2\times V_{\beta,0}^{1,2}(E)}.
\end{IEEEeqnarray*}
Take $1\leqslant j,i \leqslant 3$ (HACER APARTE PARA $i=3$; creo que es un poco
diferente, como pas\'o antes):
\begin{IEEEeqnarray*}{rCl}
  {\color{teal} h_j\|\partial_{\xi_j} u_{s,i}\|_{L^1}} & \leqslant &
    h_j\|R^{\nu-1}\theta^{\mu-1}\|_{L^2}\|R^{1-\nu}\theta^{1-\mu}\partial_{\xi_j} u_{s,i}\|_{L^2}
\end{IEEEeqnarray*}
As $0\leqslant1-\nu\leqslant1-\mu<1$ we get 
\[
  R(\bx)^{1-\nu}\geqslant R(\bx)^{1-\mu}
\]
and
\[
  R(\bx)^{\nu-1}\theta(\bx)^{\mu-1}\leqslant
  R(\bx)^{\mu-1}\theta(\bx)^{\mu-1} = r(\bx)^{\mu-1},
\]
\[
  \|R^{\nu-1}\theta^{\mu-1}\|_{L^2} \leqslant \|r^{\mu-1}\|_{L^2}.
\]
Now ({\color{red} $C$ es el pedazo de cilindro})\\
{est\'a bien as\'i?}
\[
  \|r^{\mu-1}\|_{L^2} = \sqrt{\frac{\pi}{4\mu}}\sqrt{h_3}\,h_1^{\mu}\sim \sqrt{h_3}\,\textit{h}.
\]
Then
\begin{IEEEeqnarray*}{rCl}
  h_j\|r^{\mu-1}\|_{L^2} & \lesssim & \sqrt{h_1h_2h_3}\textit{h}\\[7pt]
    & \sim & \sqrt{|E|}\,\textit{h}
\end{IEEEeqnarray*}
and then
\begin{IEEEeqnarray}{rCl}\label{cuentita_integral}
  h_j\|\partial_{\xi_j} u_{s,i}\|_{L^1} & \lesssim &
    \textit{h}\,\sqrt{|E|}\,\|R^{1-\nu}\theta^{1-\mu}\partial_{\xi_j} u_{s,i}\|_{L^2}.
\end{IEEEeqnarray}
Divergence:
\begin{IEEEeqnarray*}{rClCr}
  {\color{purple} (h_1+h_2+h_3) \|\dvg \textbf{u}_s\|_{L^1}} & \leqslant &
    (2\textit{h}^{1/\mu} + \textit{h}^{1/\nu}) \|\dvg \textbf{u}_s\|_{L^1} \\[7pt]
    & \leqslant & 3 \textit{h}\,\sqrt{|E|}\,\|\dvg \textbf{u}_s\|_{L^2} \\[7pt]
    & \leqslant & 3 \textit{h}\,\sqrt{|E|}\,\left(\|f\|_{L^2} + \|\dvg \textbf{u}_r\|_{L^2}\right) \\[7pt]
    & \lesssim  & \textit{h}\,\sqrt{|E|}\,\|f\|_{L^2}. \\[7pt]
\end{IEEEeqnarray*}
Now prisms, the last term on the right of~(\ref{distancia_cero_arista}).
By stability estimation
\begin{IEEEeqnarray*}{rCl}
  {\color{olive} \|\pi\textbf{u}_s\|_{\scriptscriptstyle L^1(E)^3}} & \leqslant & 
    \|A\|_\infty \|\tilde{\pi}\tilde{\textbf{u}}_s\|_{L^1{\tilde{E}}} \\ [7pt]
  &\lesssim& \left\| \tilde{\textbf{u}}_s \right\|_{L^1(\tilde{E})^3}
    + \sum_{j=1}^3 h_j \left\| \partial_{\tilde{x}_j}\tilde{\textbf{u}}_s \right\|_{L^1(\tilde{E})^3}
    + h_{\tilde{E}}\left\|\Div(\tilde{u}_1, \tilde{u}_2, 0) \,\right\|_{L^1(\tilde{E})}\\[7pt]
  &\lesssim& \left\| \textbf{u}_s \right\|_{L^1(E)^3}
    + \sum_{j=1}^3 h_j \left\| \partial_{\xi_j}\textbf{u}_s \right\|_{L^1(E)^3}
    + h_{E}\left\|\Div(u_1, u_2, 0) \,\right\|_{L^1(E)},    
\end{IEEEeqnarray*}
by the same argument as in Theorem 5.1 in primas.pdf.\\
\noindent Weights: again for $i=1$ or $2$
\begin{IEEEeqnarray*}{rCl}
  \|u_{s,i}\| & \leqslant & \|R^{\nu}\theta^{\mu}\| \|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^2} \\[7pt]
  & \leqslant & \textit{h}\,|E|^{\nicefrac12} \|R^{-\nu}\theta^{-\mu}u_{s,i}\|_{L^2}.
\end{IEEEeqnarray*}
\begin{IEEEeqnarray*}{rCl}
  \|u_{s,3}\| & \leqslant & \|R^{\nu}\theta\| \|R^{-\nu}\theta^{-1}u_{s,3}\|_{L^2} \\[7pt]
  & \leqslant & \textit{h}\,|E|^{\nicefrac12} \|R^{-\nu}\theta^{-1}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
\noindent DErivatives: $j = 1$ or $2$.\\
If $i=1$ or $2$. With the same argument as in~(\ref{cuentita_integral})
\begin{IEEEeqnarray}{rCl}
  h_j\|\partial_{\xi_j} u_{s,i}\|_{L^1} & \lesssim &
    \textit{h}\,\sqrt{|E|}\,\|R^{1-\nu}\theta^{1-\mu}\partial_{\xi_j} u_{s,i}\|_{L^2}.
\end{IEEEeqnarray}
For $\partial_{\xi_j}u_{s,3}$:
\begin{IEEEeqnarray*}{rCl}
  h_j\|\partial_{\xi_j}u_{s,3}\|_{L^1} &\leqslant&
    h_j \|R^{\nu-1}\|_{L^2}\|R^{1-\nu}\partial_{\xi_j}u_{s,3}\|_{L^2}\\[7pt]
  &\leqslant& h_j \|r^{\mu-1}\|_{L^2}\|R^{1-\nu}\partial_{\xi_j}u_{s,3}\|_{L^2}\\[7pt]
  &\lesssim& \textit{h}\,\sqrt{|E|}\,\|R^{1-\nu}\partial_{\xi_j}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
For $\partial_{\xi_3}$ ($h_3\sim\textit{h}\,d(E,\textbf{v})^{1-\nu}$):\\
First and second components:
\begin{IEEEeqnarray*}{rCl}
  h_3\|\partial_{\xi_3}u_{s,i}\|_{L^1}& = & h_3\|\partial_{\xi_i}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}\|R^{1-\nu}\partial_{\xi_i}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}|E|^{\nicefrac12}\|R^{1-\nu}\partial_{\xi_i}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
Third component:
\begin{IEEEeqnarray*}{rCl}
  h_3\|\partial_{\xi_3}u_{s,3}\|_{L^1}& \sim & \textit{h}\|d(E,\textbf{v})^{1-\nu}
    \partial_{\xi_3}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}\|R^{1-\nu}\partial_{\xi_3}u_{s,3}\|_{L^1}\\[7pt]
  & \leqslant & C\textit{h}|E|^{\nicefrac12}\|R^{1-\nu}\partial_{\xi_3}u_{s,3}\|_{L^2}.
\end{IEEEeqnarray*}
Divergence:
\begin{IEEEeqnarray*}{rCl}
  h_K\|\dvg (u_{s,1},u_{s,1},0)\|_{L1}&\leqslant&h_K\|\dvg \textbf{u}_s\|_{L1}
    +h_K\|\partial_{\xi_3}u_{s,3}\|_{L1}\\[7pt]
    &\lesssim&h_K\|\dvg \textbf{u}_s\|_{L1} + h_3\|\partial_{\xi_3}u_{s,3}\|_{L1},
\end{IEEEeqnarray*}
and, as was done for these two terms, we have
\begin{IEEEeqnarray*}{rCl}
  h_K\|\dvg (u_{s,1},u_{s,1},0)\|_{L1}&\lesssim&\textit{h} |E|^{\nicefrac12}\|f\|_{L2} +
  \textit{h} |E|^{\nicefrac12}\|R^{1-\nu}\partial_{\xi_3}u_{s,3}\|_{L2}. 
\end{IEEEeqnarray*}


\subsection{bound singular part tetrahedral macroelement with
singular vertex and no singular edge.}

*****************************************************

Now we establish the bound for the error in the statement of the Theorem.
For every $\bw\in W(\Th)$:
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bu_h\|_{L^2(\Omega)^3} &\leqslant& C\{\|\bu-I(\bu)\|_{L^2(\Omega)^3} + \|\bu-\bw\|_{L^2(\Omega)^3}\}.
\end{IEEEeqnarray*}
For each $\bw$ we decompose the norm with the macro--elements as follows
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bw\|^2_{0,\Omega} &=& \sum_1^{N_{\textit{h}_0}} \|\bu-\bw\|^2_{0,\Lambda_\ell}\\
    &=& \sum_1^{N_{\textit{h}_0}} \left\{
      \sum_{pri} \|\bu-\bw\|^2_{0,E_\ell} +
      \sum_{tet} \|\bu-\bw\|^2_{0,E_\ell} +
      \sum_{pyr} \|\bu-\bw\|^2_{0,E_\ell}
    \right\} 
\end{IEEEeqnarray*}
For each macro--element $\Lambda_\ell$, for each pyramid $E_\ell\in\Lambda_\ell$,
\begin{IEEEeqnarray*}{rCl}
  \|\bu_s - \pi\textbf{u}_s\|^2_{\ss L^2(E)}&\leqslant&
  h_1^2\|\gancho_{\eta_1}\textbf{u}_s\|^2+
  h_2^2\|\gancho_{\eta_2}\textbf{u}_s\|^2+
  h_3^2\|\gancho_{\eta_3}\textbf{u}_s\|^2+
  h_K^2\|\dvg\textbf{u}_s\|^2\\[7pt]
\end{IEEEeqnarray*}
\begin{IEEEeqnarray*}{rCl}
  h_1\|\gancho_{\eta_1}\textbf{u}_s\|&=&
  h_1\sum_{i=1}^3 \|\gancho_{\eta_1}\textbf{u}_{s,i}\|\\
  &\leqslant&
    \textit{h}\sum_{i=1}^3 \|r^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,i}\|\\
  &\leqslant&
    \textit{h}\left(
     \sum_{i=1}^2 \|R^{1-\mu}\theta^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,i}\|+
     \|R^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
    \textit{h}\left(
     \sum_{i=1}^2 \|R^{1-\nu}\theta^{1-\mu}\gancho_{\eta_1}\textbf{u}_{s,i}\|+
     \|R^{1-\nu}\gancho_{\eta_1}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
    \textit{h}\left(
    \sum_{i=1}^2 \|R^{\beta}\theta^{\delta}\gancho_{\eta_1}\textbf{u}_{s,i}\|+
     \|R^{\beta}\gancho_{\eta_1}\textbf{u}_{s,3}\|\right)\\[7pt]
  &\leqslant&
    \textit{h}
    \left(\sum_{i=1}^2 \|\textbf{u}_{s,i}\|_{\scriptscriptstyle \beta,\delta}+
         \|\textbf{u}_{s,3}\|_{\scriptscriptstyle \beta,0}\right).
\end{IEEEeqnarray*}
then, we able to do, for $\bw_{\bu}$ defined as in Defiition~\ref{aux_label51}, 
(remember pyramids do not touch singularities)
\begin{IEEEeqnarray*}{rCl}
  \|\bu-\bw_{\bu}\|^2_{0,\Omega}
    &=& \sum_{\ell=1}^{N_{\textit{h}_0}} \left\{
      \sum_{pri} \|\bu-I\bu\|^2_{0,E_\ell} +
      \sum_{tet} \|\bu-I\bu\|^2_{0,E_\ell} +
      \sum_{pyr} \|\bu-P_{0,E_{\ell}}\|^2_{0,E_\ell}
    \right\}\\[5pt]
    &\leqslant& \sum_{\ell=1}^{N_{\textit{h}_0}} \left\{
      \sum_{pri} \textit{h}^2 \|f\|^2_{0,E_\ell} +
      \sum_{tet} \textit{h}^2 \|f\|^2_{0,E_\ell} +
      \sum_{pyr} h^2_{E_\ell}|\bu|^2_{1,E_\ell}
    \right\}\\[5pt]
    &\leqslant& \textit{h}^2 \sum_{\ell=1}^{N_{\textit{h}_0}} \left\{
      \sum_{pri}  \|f\|^2_{0,E_\ell} +
      \sum_{tet}  \|f\|^2_{0,E_\ell} +
      \sum_{pyr} |\bu|^2_{1,E_\ell} {\color{red}\mbox{$\leftarrow$ esta parte? $\|f\|?$}}
    \right\}\\[5pt]
    \IEEEeqnarraymulticol{3}{c}{{\color{red} \mbox{Tomar las distancias
        a la arista y al vertice para el termino piramidal:}}}\\
    &\leqslant& \textit{h}^2 \sum_{\ell=1}^{N_{\textit{h}_0}} \|f\|^2_{0,\Lambda_\ell} \,=\,
      \textit{h}^2\,\|f\|^2_{0,\Omega}.
\end{IEEEeqnarray*}
