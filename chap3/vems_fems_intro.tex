\begin{chapter}[vems--fems]{vems--fems--intro}
It is our intention to propose a Virtual Elements Method (VEM) scheme
as a generalization of $H(\text{div})$--conforming Finite Elements
in meshes consisting of polyhedra of arbitrary kind.
We deal with tetrahedra, triangular prisms and pyramids and, in the presence of
the latter, our VEM scheme is put in the framework of non-polynomial Finite Elements.\\[5pt]
Let be given an open domain $\Omega\subseteq\mathbb{R}^3$ with Lipschitz--continuous boundary
consisting of planar faces and define $V:=H(\mbox{div},\Omega)$ and $Q:=L^2(\Omega)$.
Let us consider the following continuous problem.\\[5pt]
With 
\begin{IEEEeqnarray*}{rClCrCl}
	a(\bv,\bw) & = & \forma{v}{w} &\quad\mbox{and}\quad& b(\bv,q) & = & \formb{v}{q}
\end{IEEEeqnarray*}
find $\bu\in V$ and $p\in Q$ such that for every $\bv\in V$ and every $q\in Q$
\begin{equation}\label{mixedContinuous}
  \makebox[0pt]{
    \begin{minipage}{\linewidth}
  	  \begin{IEEEeqnarray*}{rCl}
  		a(\bu,\bv) + b(\bv,p) & = & 0\\[5pt]
  				   - b(\bu,q) & = & (f,q).
  	  \end{IEEEeqnarray*}
    \end{minipage}}
  \tag{MC}
\end{equation}
We start with a polihedral triangulation $\Th$ of $\Omega$ to define the 
virtual spaces $V_h$ and $Q_h$ as discretizations of $V$ and $Q$ respectively.\\[5pt]
For $E\in\Th$ the local space will be
\begin{eqnarray*}
V_h(E)&=&\Big\{\bv\in H(\mbox{div},E)\cap H(\textbf{curl},E)\,:\,\\
&&\qquad \bv\cdot\bn|_f\in \mathcal P_0(f) \,\,\mbox{for all face $f$ of }E, \\
&& \qquad\dv\bv\in \mathcal P_0(E) \mbox{ and } 
\curl\bv = 0 \Big\}
\end{eqnarray*}
and the  global space $V_h$ will consist of functions defined piecewise with the former
local spaces:
\begin{IEEEeqnarray*}{ccrCl}
V_h&=&V_h(\Th)&:=&\Big\{\bv\in H(\dv,\Omega): \bv|_E\in V_h(E), \mbox{for all element }
E\in\Th\Big\}
\end{IEEEeqnarray*}
The condition in the definitions of these spaces suffice to construct an interpolation
operator, which is a key object both in Finite Elements as in Virtual Elements.
Let us take the degrees of freedom
\begin{IEEEeqnarray}{rCl}\label{dofs}
\int\limits_f \bv\cdot\bn\,d\gamma & \qquad\mbox{ for all face $f$ of } & \Th.
\end{IEEEeqnarray}
With \emph{faces of $\Th$} we mean the family of all faces forming the boundary
consistently in the case of neighbour elements.
\begin{lemma} Given a polyhedron $E\in\Th$, the degrees of freedom~(\ref{dofs}) corresponding to the faces of $E$ are unisolvent in $V_h(E)$.
\end{lemma}
\begin{proof} \emph{Existence.} Let $n_{f,E}$ the number of faces of $E$ and
take real numbers $\{\alpha_i\}_{i=1}^{n_{f,E}}$. Let $g$ the  piecewise constant
function on $\partial E$ satisfying, for all $i$, %face $f$ of $E$
\[
  \int\limits_{f_i} g = \alpha_i
\]
and let $d$ be the constant function in $E$ such that
\[
 \int\limits_E d\,d\textbf{x} = \sum \alpha_i.
\]
Then we consider the auxiliary problem of seeking a solution of
\begin{IEEEeqnarray}{rClrCl}
  \label{aux_prob}
  \Delta \phi & = & d \quad \mbox{in $E$,} \qquad & 
  \frac{\partial \phi}{\partial \bn}& = &g \quad \mbox{on }\partial E.
\end{IEEEeqnarray}
{\color{red}By definition we obtain the compatibility condition}
\begin{IEEEeqnarray*}{rCl}
  \int\limits_E d\,d\textbf{x}& = & \int\limits_{\partial E} g\,d\gamma    
\end{IEEEeqnarray*}
so the solution $\phi$ to the problem~(\ref{aux_prob}) exists. Now
we take $\bu:=\nabla \phi$ and  it holds immediately $\dv\bu$ is constant in $E$,
$\bu\cdot\bn$ is constant on each face of $\partial E$ and $\curl\bu = 0$. So
$\bu$ lies in $V_h(E)$ and also for all $1\leqslant i\leqslant n_{f,E}$ $\int_{f_i} \bu\cdot\bn\,d\gamma = \alpha_i$.\\[4pt]
\emph{Uniqueness.} Suppose that $\bv\in V_h(E)$ has vanishing
degrees of freedom. Condition $\curl\bv=0$ implies
$\bv=\nabla\phi$ for certain $\phi$. Now, since $\dv\bv$ is constant on $E$, the
relations 
\begin{IEEEeqnarray*}{rCl}
   0 & = & \int\limits_{\partial P}\bv\cdot\bn\,d\gamma 
\end{IEEEeqnarray*} %& = & \int\limits_P\dv\bv\,d\textbf{x}
imply $\dv\bv=0$ by Green Theorem. Then, the potential $\phi$ satisfies
\begin{IEEEeqnarray*}{rClrCl}
  \Delta \phi & = & 0 \quad \mbox{in $E$,} \qquad & 
  \frac{\partial \phi}{\partial \bn}& = &0 \quad \mbox{on }\partial E
\end{IEEEeqnarray*}
{\color{red} which means it is a constant}, and it follows $\bv=0$.
\end{proof}
\subsection{Definition of the $H(\text{div})$-conforming element on prisms. 
Generalization of the Raviart-Thomas Finite Element} % (fold)
\label{sub:definition_of_the_h_div_element_on_prisms}

Notaci\'on:{\color{red} Controlar si est\'a bien usada la notaci\'on de prod. tensorial cuando
es un vector de dos coords. por un escalar, y Controlar si es el mismo $h(x,y,z)$ en las coords. 1 y 2 (el 
que es un homog\'eneo en $x,y$ por uno en $z$.)}
\begin{IEEEeqnarray*}{rCl}
	D_k & = & P_{k-1}^2(x,y) \oplus \tilde{P}_{k-1}(x,y) \textbf{x},\\
	\textbf{x} & = & (x,y).
\end{IEEEeqnarray*}
\begin{defi}\label{defi_h_div_conforme} Definimos aqu\'{\i} un elemento 
$H(\text{div})$--conforme. 
\begin{enumerate}
	\item $\hat{K}$ es el prisma de referencia.
	\item El espacio $P_{\hat{K}}$ de polinomios es
		\begin{IEEEeqnarray*}{rCl}
		 	P_{\hat{K}} & = & \{ \boldsymbol{v} = (v_1,v_2,v_3):\,(v_1,v_2)\in D_k\otimes P_{k-1}(z),\\ 
						& 	& v_3\in P_{k-1}(x,y)\otimes P_k(z) \}.
		 \end{IEEEeqnarray*} 
	\item Los grados de libertad son:
\begin{IEEEeqnarray}{lll}
	\label{momentos1hdiv} \int\limits_{f} (\boldsymbol{v}\cdot\boldsymbol{\nu})q\,d\gamma 
		& q \in P_{k-1}(x,y)\textrm{,} & \textrm{ para las dos caras horizontales; } \\
	\label{momentos2hdiv} \int\limits_{f} (\boldsymbol{v}\cdot\boldsymbol{\nu})q\,d\gamma 
		& q \in Q_{k-1, k-1, k-1}\textrm{,} & \textrm{ para las tres caras verticales; } \\
	\label{momentos3hdiv} \int\limits_{\hat{K}} (v_1q_1 + v_2q_2)\,d\textbf{x} 
		& \IEEEeqnarraymulticol{2}{c}{q_1\textrm{, } q_2 \in P_{k-2}(x,y) \otimes P_{k-1}(z);}\\
	\label{momentos4hdiv} \int\limits_{\hat{K}} v_3q_3\,d\textbf{x} 
		& \IEEEeqnarraymulticol{2}{c}{ q_3\in P_{k-1}(x,y) \otimes P_{k-2}(z).} 
\end{IEEEeqnarray}
\end{enumerate}
\end{defi}
---------------------------------------------------------
\input{./chap3/hdiv_basis_low_order}\\
---------------------------------------------------------

\subsection{Definition of the $H(\text{div})$-conforming element on tetrahedra. 
Generalization of the Raviart-Thomas Finite Element} % (fold)
\label{sub:definition_of_the_h_div_element_on_tetrahedra}

{\color{red} TODO: completar esto }
\begin{IEEEeqnarray*}{rCl}
	P_{\hat{K}} & = & P_k^3(\hat{K}) + P_{k-1}(\hat{K})\,\textbf{x}. \\[5pt]
\end{IEEEeqnarray*}

% subsection definition_of_the_h_div_conforming_element_on_tetrahedra_generalization_of_the_raviart_thomas_finite_element (end)
\end{chapter}