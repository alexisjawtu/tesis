\begin{chapter}[vems--fems]{vems--fems--intro}
It is our intention to propose a Virtual Elements Method (VEM) scheme
as a generalization of $H(\text{div})$--conforming Finite Elements
in meshes consisting of polyhedra of arbitrary kind.
We deal with tetrahedra, triangular prisms and pyramids and, in the presence of
the latter, our VEM scheme is put in the framework of non-polynomial Finite Elements.\\[5pt]
Let be given an open domain $\Omega\subseteq\mathbb{R}^3$ with Lipschitz--continuous boundary
consisting of planar faces and define $V:=H(\mbox{div},\Omega)$ and $Q:=L^2(\Omega)$.
Let us consider the following continuous problem.\\[5pt]
With 
\begin{IEEEeqnarray*}{rClCrCl}
	a(\bv,\bw) & = & \forma{v}{w} &\quad\mbox{and}\quad& b(\bv,q) & = & \formb{v}{q}
\end{IEEEeqnarray*}
find $\bu\in V$ and $p\in Q$ such that for every $\bv\in V$ and every $q\in Q$
\begin{equation}\label{mixedContinuous}
  \makebox[0pt]{
    \begin{minipage}{\linewidth}
  	  \begin{IEEEeqnarray*}{rCl}
  		a(\bu,\bv) + b(\bv,p) & = & 0\\[5pt]
  				   - b(\bu,q) & = & (f,q) 
  	  \end{IEEEeqnarray*}
    \end{minipage}}
  \tag{MC}
\end{equation}

------------------------ continue here

--$E\in\mathcal T_h$\\ 
--local space
\begin{eqnarray*}
V_h(E)&=&\Big\{\bv\in H(\mbox{div},E)\cap H(\textbf{curl},E)\,:\,\\
&&\qquad \bv\cdot\bn|_f\in \mathcal P_0(f) \,\,\mbox{for all face $f$ of }E, \\
&& \qquad\mbox{div\,}\bv\in \mathcal P_0(E) \mbox{ and } 
\mbox{{\bf curl}\,}\bv = 0 \Big\}.
\end{eqnarray*}
$-->$ global space
\begin{eqnarray*}
V_h&=&\Big\{\bv\in H(\dv,\Omega): \bv|_E\in V_h(E), \mbox{for all element }
E\in\mathcal T_h\Big\}
\end{eqnarray*}
degrees of freedom
\begin{IEEEeqnarray*}{rCl}	
\int\limits_f \bv\cdot\bn\,d\gamma & \qquad\mbox{ for all face $f$ of } & \mathcal T_h.
\end{IEEEeqnarray*}

TODO: pdf Highlighting tool for debian??


--------------------------------------------------------------------------------
\subsection{Definition of the $H(\text{div})$-conforming element on prisms. 
Generalization of the Raviart-Thomas Finite Element} % (fold)
\label{sub:definition_of_the_h_div_element_on_prisms}

Notaci\'on:{\color{red} Controlar si est\'a bien usada la notaci\'on de prod. tensorial cuando
es un vector de dos coords. por un escalar, y Controlar si es el mismo $h(x,y,z)$ en las coords. 1 y 2 (el 
que es un homog\'eneo en $x,y$ por uno en $z$.)}
\begin{IEEEeqnarray*}{rCl}
	D_k & = & P_{k-1}^2(x,y) \oplus \tilde{P}_{k-1}(x,y) \textbf{x},\\
	\textbf{x} & = & (x,y).
\end{IEEEeqnarray*}
\begin{defi}\label{defi_h_div_conforme} Definimos aqu\'{\i} un elemento 
$H(\text{div})$--conforme. 
\begin{enumerate}
	\item $\hat{K}$ es el prisma de referencia.
	\item El espacio $P_{\hat{K}}$ de polinomios es
		\begin{IEEEeqnarray*}{rCl}
		 	P_{\hat{K}} & = & \{ \boldsymbol{v} = (v_1,v_2,v_3):\,(v_1,v_2)\in D_k\otimes P_{k-1}(z),\\ 
						& 	& v_3\in P_{k-1}(x,y)\otimes P_k(z) \}.
		 \end{IEEEeqnarray*} 
	\item Los grados de libertad son:
\begin{IEEEeqnarray}{lll}
	\label{momentos1hdiv} \int\limits_{f} (\boldsymbol{v}\cdot\boldsymbol{\nu})q\,d\gamma 
		& q \in P_{k-1}(x,y)\textrm{,} & \textrm{ para las dos caras horizontales; } \\
	\label{momentos2hdiv} \int\limits_{f} (\boldsymbol{v}\cdot\boldsymbol{\nu})q\,d\gamma 
		& q \in Q_{k-1, k-1, k-1}\textrm{,} & \textrm{ para las tres caras verticales; } \\
	\label{momentos3hdiv} \int\limits_{\hat{K}} (v_1q_1 + v_2q_2)\,d\textbf{x} 
		& \IEEEeqnarraymulticol{2}{c}{q_1\textrm{, } q_2 \in P_{k-2}(x,y) \otimes P_{k-1}(z);}\\
	\label{momentos4hdiv} \int\limits_{\hat{K}} v_3q_3\,d\textbf{x} 
		& \IEEEeqnarraymulticol{2}{c}{ q_3\in P_{k-1}(x,y) \otimes P_{k-2}(z).} 
\end{IEEEeqnarray}
\end{enumerate}
\end{defi}
---------------------------------------------------------
\input{./chap3/hdiv_basis_low_order}\\
---------------------------------------------------------

\subsection{Definition of the $H(\text{div})$-conforming element on tetrahedra. 
Generalization of the Raviart-Thomas Finite Element} % (fold)
\label{sub:definition_of_the_h_div_element_on_tetrahedra}

{\color{red} TODO: completar esto }
\begin{IEEEeqnarray*}{rCl}
	P_{\hat{K}} & = & P_k^3(\hat{K}) + P_{k-1}(\hat{K})\,\textbf{x}. \\[5pt]
\end{IEEEeqnarray*}

% subsection definition_of_the_h_div_conforming_element_on_tetrahedra_generalization_of_the_raviart_thomas_finite_element (end)
\end{chapter}