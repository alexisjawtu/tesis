\section{Regularity of the solution for a model Elliptic Problem}
\label{sec:regularity}
\macroRegularity
%\macroPrismRegularity
\noindent We are concerned in solving 
the following problem.
\begin{problem}\label{mixedContinuous}
Suppose we have a simply connected Lipschitz polyhedron
$\Omega\subseteq\mathbb{R}^3$ which is not convex. Given $f\in L^2(\Omega)$
we look for a $\bu\in H(\dv,\Omega)$ such that 
\begin{IEEEeqnarray*}{rCl}
  \boldsymbol{u}              & = & \nabla p \\
  -\text{div\,}\boldsymbol{u} & = & f \\
   p|_{\partial\Omega}
  & = & 0.
\end{IEEEeqnarray*}
\mbox{\color{Orange}la cond de borde VA?\quad COMO LO PONGO? \quad (ver apunte de FEM2012 talvez)}
\end{problem}
\begin{problem}[Weak formulation.]\label{weakMixedContinuous}
Suppose we have a simply connected Lipschitz polyhedron
$\Omega\subseteq\mathbb{R}^3$ which is not convex. Given $f\in L^2(\Omega)$,
find       $(\bu, p)  \in  H(\dv, \Omega) \times L^2(\Omega)$ 
    such that for all   $(\bv, q)  \in  H(\dv, \Omega) \times L^2(\Omega)$
  \begin{IEEEeqnarray*}{rCl}
    \int_{\Omega} \bu\cdot\bv\,d\bx + 
    \int_{\Omega} p\,\dv\bv\,d\bx                     & = & 0\\
     -\int_{\Omega} q\dv\bu\,d\bx     & = & 
    \int_{\Omega} f\,q\,d\bx.    
  \end{IEEEeqnarray*}
\end{problem}
Due to the polyhedron not being convex there will be ingoing
vertices and edges whose interior angles are obtuse. In the following
we are going to recall how to formalize the singularities in a polyhedron
and how to classify the regularity of the solution of problem~(\ref{mixedContinuous}).\\

Recall the description in page 522 of~\cite{apelNicaise} for the following 
definition. 
\begin{defi}
Suppose that a vertex
$\bv\in\partial\Omega$ is the origin of our Cartesian system of coordinates. Let $C_{\bv}$ be the infinite
polyhedral cone of $\mathbb{R}^3$ which coincides with $\Omega$ in a neighbourhood of 
$\bv$. Set $G_{\bv} = C_{\bv}\cap S^2(\bv)$, the intersection of $C_{\bv}$ with
the unit sphere centered at $\bv$. The vertex singular exponent related to $\bv$
is defined by $\lambda_{\bv} := -\nicefrac12 + \sqrt{\lambda_{\bv,1} + \nicefrac14}$
where 
$\lambda_{\bv,n} > 0$, $n\in\mathbb{N}$, are the eigenvalues, in increasing order, of a positive
Laplace--Beltrami operator $\Delta'$ on $G_{\bv}$ with Dirichlet boundary
conditions. For any edge of $\partial\Omega$ the edge
singular exponent is 
$\pi/\omega_{\be}$ where $\omega_{\be}$ is the interior angle between
the faces sharing  $\be$.
We say that
  \begin{enumerate}
    \item $\be$ is singular if $\lambda_{\be} < 1.$ 
    \item $\bv$ is singular if $\lambda_{\bv} < \dfrac12$
  \end{enumerate}
\end{defi}
The motivation of calling \textsl{singular} an edge or a vertex is that
the solutions of elliptic problems in non--convex domains have singularities
at those vertices or approaching those edges.

To talk about the regularity of a solution in a \emph{non--convex} domain
we will make use of the following weighted Sobolev spaces.
\begin{defi} Suppose $\Omega$ is a non--convex polihedron where $\Lambda \subseteq \Omega$ is
a subdomain such that 
$\bar{\Lambda}$ contains at most one singular vertex $\bv$ or at most one singular
edge $\be$ of $\Omega$.
In case it contained both, the edge is incident to the vertex. Fix a local system
of coordinates in $\Lambda$ with origin at $\bv$ (in case we had a singular
edge and no singular vertex, the origin is at one end of the edge).
$R(\bx)$ will be the distance from $\bx$ to $\bv$,
$r(\bx)$ will be the distance from $\bx$ to $\be$ and $\theta(\bx)$ will be
the \textsl{angular distance} $\theta(\bx)=\frac{r(\bx)}{R(\bx)}$. With these weights,
given two 
positive parameters $\beta$ and $\delta$ we define the norm
\begin{IEEEeqnarray}{rCl}\label{weighted_norm}
  \|v\|^{1,2}_{\beta,\delta} & := & \left\{\sum_{|\alpha|\leqslant 1}
  \|R^{\beta-1+|\alpha|}\theta^{\delta-1+|\alpha|}\,\partial^\alpha v\|_{L^2(\Lambda)}^2\right\}^{1/2}.
\end{IEEEeqnarray}
%\left\{v\in \mathcal D'(\Lambda):
%      R^{\beta-1+|\alpha|}\theta^{\delta-1+|\alpha|}\partial^\alpha v\in L^2(\Lambda),
%      \alpha\in \mathbb N_0^3, |\alpha|\leqslant 1
%\right\}
And the symbol $V_{\beta,\delta}^{1,2}(\Lambda)$ will
denote the space
\begin{IEEEeqnarray}{rCl}\label{weighted_sobolev}
  V_{\beta,\delta}^{1,2}(\Lambda) & = &
  \left\{ v \in \mathcal D'(\Lambda): \|v\|^{1,2}_{\beta,\delta} < \infty\right\}.  
\end{IEEEeqnarray}
\end{defi}
\begin{remark}
If in the last definition we had $\beta = \delta$, which will hold true in the
case of just an edge singularity, then we would write 
$V_{\delta, \delta}^{1,2}(\Lambda)  = V_{\delta}^{1,2}(\Lambda)$
and, consistently, 
\begin{IEEEeqnarray*}{rCl}
\|v\|_{\delta}^{1,2} & := & \left\{\sum_{|\alpha|\leqslant 1}
\|r^{\delta-1+|\alpha|}\partial^\alpha v\|_{L^2(\Lambda)}^2\right\}^{1/2}.
\end{IEEEeqnarray*}
\end{remark}
%========
%First we introduce the space $V^{1,2}_{\beta,\delta}(\Lambda)$ for a macroelement $\Lambda$ as
%where $R(\bx)$ is the distance of $\bx$ to the vertices of $\Lambda$, $r(\bx)$ is the distance from $\bx$ to the edges of $\Lambda$ and finally $\theta(\bx)$ is the angular distance $\theta(\bx)=\frac{r(\bx)}{R(\bx)}$.
%========
Let $\Omega=\cup_{\ell=1}^N \Lambda_\ell$ be 
a decomposition of $\Omega$ in
{\bf prismatic} or {\bf tetrahedral} macro--elements having, each one of them,
at most a singular edge $\lambda_{\be}^{(\ell)}$ and a singular vertex
$\lambda_{\bv}^{(\ell)}$. This corresponds to the fact
that the sequence of meshes we will introduce 
at the end of this thesis has a first coarse term consisting only of prisms
and tetrahedra.
We have the following regularity result, for which we refer again
to~\cite{apelNicaise}.
\begin{theorem}\label{thm_regularity}
The solutions $\bu$ and $p$ of problem \eqref{weakMixedContinuous} satisfy
\[
  p\in H^1(\Omega)
\] 
and for each $\ell$
\[
  \bu=\bu_r + \bu_s
\]
with $\bu_r\in H^1(\Omega)$ and
\[
  \bu_s\cdot \xi_i\in V^{1,2}_{\beta_{\ell},\delta_{\ell}}(\Lambda_\ell), \quad i=1,2, \qquad
  \bu_s\cdot\xi_3\in V^{1,2}_{\beta_{\ell},0}(\Lambda_\ell)
\]
where $\xi_i$, $i=1,2,3$, are the directions of three edges of $\Lambda_\ell$ 
concurrent to $\bv$ with $\xi_3$ being the direction of the
singular edge, and $\beta_{\ell},\delta_{\ell}\geqslant 0$
satisfying $\beta_{\ell}>\frac12-\lambda_{\bv}^{(\ell)}$ and
$\delta_{\ell}>1-\lambda_{\be}^{(\ell)}$.
Furthermore, the following estimates hold:
%provided
%\begin{IEEEeqnarray*}{rCl}
%  {\color{violet} \delta_{\ell}} & > & 1 - \frac{\pi}{\omega_{\textbf{e}}}\text{,}\\
%  {\color{violet} \beta_{\ell}} & > & \frac{1}{2} - \lambda_{\textbf{v}}.
%\end{IEEEeqnarray*}
\begin{IEEEeqnarray}{rCl}
  \label{aux_label11}
  \| \bu_r \|_{H^1(\Omega)} & \leqslant & c\,\|f\|_{L^2(\Omega)}\\[5pt]
  \| \bu_s\cdot\xi_i \|_{V_{\beta_{\ell},\delta_{\ell}}^{1,2}(\Lambda_\ell)} & \leqslant & c\,\| f \|_{L^2(\Omega)}\\[5pt]
  \| \bu_s\cdot\xi_3 \|_{V_{\beta_{\ell},0}^{1,2}(\Lambda_\ell)}      & \leqslant & c\,\| f \|_{L^2(\Omega)}
\end{IEEEeqnarray}
\end{theorem}
\begin{remark}\label{sobreBetaYDelta}
Note that it is always possible to take $0<\beta_{\ell}=\delta_{\ell}<1$ in the previous Theorem
and note the dependence of $\beta$ and $\delta$ on the macro--element, which
we made explicit by putting the subindex $\ell$, meaning the result is ahout
local regularity.
\end{remark}