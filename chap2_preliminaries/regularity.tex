\section{Regularity of the solution for a model Elliptic Problem}
\label{sec:regularity}
\macroRegularity   %%  macroelements drawing 
%\macroPrismRegularity
\noindent We are concerned in solving 
the following problem.
\begin{problem}\label{mixedContinuous}
Suppose we have a simply connected Lipschitz polyhedron
$\Omega\subseteq\mathbb{R}^3$. Given $f\in L^2(\Omega)$
we look for $\bu\in H(\Div,\Omega)$ and $p\in L^2(\Omega)$ such that 
\begin{IEEEeqnarray*}{rCl}
  \boldsymbol{u}              & = & \nabla p \\
  -\text{div\,}\boldsymbol{u} & = & f \\
   p|_{\partial\Omega}
  & = & 0.
\end{IEEEeqnarray*}
\end{problem}
\begin{problem}[Weak formulation.]\label{weakMixedContinuous}
Suppose we have a simply connected Lipschitz polyhedron
$\Omega\subseteq\mathbb{R}^3$. Given $f\in L^2(\Omega)$,
find       $(\bu, p)  \in  H(\Div, \Omega) \times L^2(\Omega)$ 
    such that for all   $(\bv, q)  \in  H(\Div, \Omega) \times L^2(\Omega)$
  \begin{IEEEeqnarray*}{rCl}
    \int_{\Omega} \bu\cdot\bv\,d\bx + 
    \int_{\Omega} p\,\dv\bv\,d\bx                     & = & 0\\
     -\int_{\Omega} q\,\dv\bu\,d\bx     & = & 
    \int_{\Omega} fq\,d\bx.    
  \end{IEEEeqnarray*}
\end{problem}
In the case in which the polyhedron is not convex there will be re--entrant
vertices and edges whose interior angles are obtuse. In the following
we are going to recall how to formalize the singularities in a polyhedron
and how to classify the regularity of the solution of Problem~\ref{mixedContinuous}.\\[5pt]
Recall the descriptions in pages 1119 of~\cite{alw} and 522 of~\cite{apelNicaise} for the following 
definitions. 
\begin{defi}
Suppose that a vertex
$S\in\partial\Omega$ is the origin of our Cartesian system of coordinates. Let $C_{S}$ be the infinite
polyhedral cone of $\mathbb{R}^3$ which coincides with $\Omega$ in a neighbourhood of 
$S$. Set $G_{S} = C_{S}\cap S^2(S)$, the intersection of $C_{S}$ with
the unit sphere centered at $S$. The vertex singular exponent related to $S$
is defined by $\lambda_{\bv,S} := -\nicefrac12 + \sqrt{\lambda_{\bv,1} + \nicefrac14}$
where 
$\lambda_{\bv,n} > 0$, $n\in\mathbb{N}$, are the eigenvalues, in increasing order, of a positive
Laplace--Beltrami operator $\Delta'$ on $G_{\bv}$ with Dirichlet boundary
conditions. For any edge $A_{S,j}$, $1\leqslant j\leqslant J_S$
of $\partial\Omega$ incident to a vertex $S$, the edge
singular exponent is 
$\lambda_{\be,S,j} := \pi/\omega_{S,j}$ where $\omega_{S,j}$ is the interior angle between
the faces sharing  $A_{S,j}$.
We say that
  \begin{enumerate}
    \item $A_{S,j}$ is singular if $\lambda_{\be,S,j} < 1.$ 
    \item $S$ is singular if $\lambda_{\bv,S} < \dfrac12$.
  \end{enumerate}
\end{defi}
The reason why we call \textsl{singular} an edge or a vertex is that
the solutions of elliptic problems in non--convex domains have singularities
at those vertices or approaching those edges.
\begin{defi}\label{auxlabel423}
Let $\Omega=\cup_{\ell=1}^N \Lambda_\ell$ be 
a decomposition of $\Omega$ in
{\bf prismatic} or {\bf tetrahedral} macro--elements having, each one of them,
at most a singular edge  %${\be}_{\ell}$ 
and a singular vertex. %${\bv}_{\ell}$. 
For any $\ell = 1,\dots,L$, we set $\lambda_{\bv}^{(\ell)} = \lambda_{\bv,S}$
if $\Lambda_\ell$ contains a singular vertex $S$ of $\Omega$,
otherwise we take
$\lambda_{\bv}^{(\ell)} = \infty$, and
$\lambda_{\be}^{(\ell)} = \lambda_{\be,S,j}$ if $\Lambda_{\ell}$
contains one singular edge $A_{S,j}$ of $\Omega$, otherwise
we take $\lambda_{\be}^{(\ell)} = \infty$.

In each macro--element $\Lambda_\ell$ let $\bxi^{(\ell)} = (\xi_1^{(\ell)},\xi_2^{(\ell)},\xi_3^{(\ell)})$
be a cartesian coordinate system such that the singular vertex, if existing, is located
at the origin, and the singular edge, if existing, is contained in the $\xi_3^{(\ell)}$ axis
(we will drop the $\ell$'s when they are not needed). In the case $\Lambda_\ell$ contains both
singularities, the edge whithin $\xi_3^{(\ell)}$ is incident to the vertex; 
in case we had a singular edge and no singular vertex, the origin is at one end of the edge.\\[5pt]
Let
\begin{IEEEeqnarray*}{rCl}  
R^{(\ell)}(\bxi) &=& \left((\xi_1^{(\ell)})^{2}+
                  (\xi_2^{(\ell)})^{2}+
                  (\xi_3^{(\ell)})^{2}\right)^{\nicefrac12} \\[4pt]
r^{(\ell)}(\bxi) &=& \left((\xi_1^{(\ell)})^{2}+
                  (\xi_2^{(\ell)})^{2}\right)^{\nicefrac12} \\[4pt]
\theta^{(\ell)}(\bxi)&=&\frac{r(\bxi)}{R(\bxi)}
\end{IEEEeqnarray*}
be the distance to the origin, the \emph{radial} distance to the $\xi_3^{(\ell)}$--axis and
the \textsl{angular distance} from the $\xi_3^{(\ell)}$--axis, respectively.
\end{defi}
The macro--element decomposition corresponds to the fact
that the sequence of meshes we will introduce 
at the end of this thesis has a first coarse term consisting only of prisms
and tetrahedra.\\[5pt]
To talk about the regularity of a solution in these \emph{non--convex} domains
we will make use of the following weighted Sobolev spaces.
\begin{defi} \label{auxlabel428}Suppose $\Omega$ is a non--convex polihedral domain
where $\Lambda \subseteq \Omega$ is
a subdomain such that 
$\bar{\Lambda}$ contains at most one singular vertex $S$ or at most one singular
edge $A_{S,j}$ of $\Omega$.
 Given two 
positive parameters $\beta$ and $\delta$ we define the norm
\begin{IEEEeqnarray}{rCl}\label{weighted_norm}
  \|v\|^{1,2}_{\beta,\delta} & := & \left\{\sum_{|\balpha|\leqslant 1}
  \|R^{\beta-1+|\balpha|}\theta^{\delta-1+|\balpha|}\,{D}^{\balpha} v\|_{L^2(\Lambda)}^2\right\}^{1/2}.
\end{IEEEeqnarray}
%\left\{v\in \mathcal D'(\Lambda):
%      R^{\beta-1+|\balpha|}\theta^{\delta-1+|\balpha|}\partial^{\balpha} v\in L^2(\Lambda),
%      \balpha\in \mathbb N_0^3, |\balpha|\leqslant 1
%\right\}
The symbol $V_{\beta,\delta}^{1,2}(\Lambda)$ will
denote the space
\begin{IEEEeqnarray}{rCl}\label{weighted_sobolev}
  V_{\beta,\delta}^{1,2}(\Lambda) & = &
  \left\{ v \in \mathcal D'(\Lambda): \|v\|^{1,2}_{\beta,\delta} < \infty\right\}.  
\end{IEEEeqnarray}
\end{defi}
\begin{remark}
If in the last definitions we had $\beta = \delta$, which will hold true in the
case of just an edge singularity, then we would write 
$V_{\delta, \delta}^{1,2}(\Lambda)  = V_{\delta}^{1,2}(\Lambda)$
and, consistently, 
\begin{IEEEeqnarray*}{rCl}
\|v\|_{\delta}^{1,2} & := & \left\{\sum_{|\balpha|\leqslant 1}
\|r^{\delta-1+|\balpha|}{D}^{\balpha} v\|_{L^2(\Lambda)}^2\right\}^{1/2}.
\end{IEEEeqnarray*}
\end{remark}
%========
%First we introduce the space $V^{1,2}_{\beta,\delta}(\Lambda)$ for a macroelement $\Lambda$ as
%where $R(\bx)$ is the distance of $\bx$ to the vertices of $\Lambda$, $r(\bx)$ is the distance from $\bx$ to the edges of $\Lambda$ and finally $\theta(\bx)$ is the angular distance $\theta(\bx)=\frac{r(\bx)}{R(\bx)}$.
%========
We have the following regularity result, for which we refer again
to~\cite{apelNicaise}.
\begin{theorem}\label{thm_regularity}
The solutions $\bu$ and $p$ of Problem~\ref{weakMixedContinuous} satisfy
\[
  p\in H^1(\Omega)
\] 
and for each $\ell$
\begin{IEEEeqnarray}{rCl} \label{splitting}
  \bu& = &\bu_r + \bu_s
\end{IEEEeqnarray}
with $\bu_r\in H^1(\Omega)$ and, for any $\beta_{\ell}>\frac12-\lambda_{\bv}^{(\ell)}$,
$\delta_{\ell}>1-\lambda_{\be}^{(\ell)}$,
\[
  \bu_s\cdot \xi_i\in V^{1,2}_{\beta_{\ell},\delta_{\ell}}(\Lambda_\ell), \quad i=1,2, \qquad
  \bu_s\cdot\xi_3\in V^{1,2}_{\beta_{\ell},0}(\Lambda_\ell)
\] %where $\{{\s\xi_i\,|\,i=1,2,3}\}$ are the directions of three edges of $\Lambda_\ell$ %concurrent to $\bv_\ell$ and $\xi_3$ is the direction of the %singular edge $\be_\ell$.
Furthermore, the following estimates hold:
%provided
%\begin{IEEEeqnarray*}{rCl}
%  {\color{violet} \delta_{\ell}} & > & 1 - \frac{\pi}{\omega_{\textbf{e}}}\text{,}\\
%  {\color{violet} \beta_{\ell}} & > & \frac{1}{2} - \lambda_{\textbf{v}}.
%\end{IEEEeqnarray*}
\begin{IEEEeqnarray}{rCl}
  \label{aux_label11}
  \| \bu_r \|_{H^1(\Omega)} & \leqslant & C\,\|f\|_{L^2(\Omega)}\\[5pt]
  \| \bu_s\cdot\xi_i \|_{V_{\beta_{\ell},\delta_{\ell}}^{1,2}(\Lambda_\ell)} & \leqslant & C\,\| f \|_{L^2(\Omega)}\\[5pt]
  \| \bu_s\cdot\xi_3 \|_{V_{\beta_{\ell},0}^{1,2}(\Lambda_\ell)}      & \leqslant & C\,\| f \|_{L^2(\Omega)}.
\end{IEEEeqnarray}
\end{theorem}
\begin{remark}\label{sobreBetaYDelta}
Note that it is always possible to take $0<\beta_{\ell}=\delta_{\ell}<1$ in the previous Theorem
and note the dependence of $\beta$ and $\delta$ on the macro--element, which
we made explicit by putting the subindex $\ell$, meaning the result is about
local regularity.
\end{remark}
\begin{defi} For a subdomain $\Lambda$ the vectorial weighted space we are 
using will be denoted 
  \begin{IEEEeqnarray*}{rCl}
    \pazocal{V}_{\beta,\delta}(\Lambda) &=& 
    V_{\beta,\delta}^{1,2}(\Lambda)^2\times V_{\beta,0}^{1,2}(\Lambda)\\
    \pazocal{V}_{\delta}(\Lambda) &=& 
    V_{\delta}^{1,2}(\Lambda)^2\times V_{0}^{1,2}(\Lambda)
  \end{IEEEeqnarray*}
  with the usual product norm.
\end{defi}