\section{Preliminaries} % (fold)
\label{sec:preliminaries}
\subsection{Definitions and Notations} % (fold)
\label{sub:definitions_notations}
For the first definition we refer the reader to~\cite{ciarlet}. 
\begin{defi}
A Finite Element in $\mathbb{R}^n$ is defined by the following triple $(E, P_E, \Sigma) $:
\begin{enumerate}
  \item 
$E$ is an open non empty polytope of $\mathbb{R}^n$ with Lipschitz--continuous 
boundary.
  \item
$P_E$ is a finite--dimensional space of real--valued scalar or vectorial 
functions defined over $E$.
  \item
$\Sigma$ is a finite set of linearly independent linear functionals acting 
on a functional space containing $P_E$. The elements of $\Sigma$ are often
referred to as  \emph{degrees of freedom} or \emph{moments} of the Finite
Element.
\end{enumerate}
\end{defi}
\begin{defi} 
Given  a Finite Element $E$ set
\begin{IEEEeqnarray*}{rCl}
  h_E & = & \mbox{ diameter of the element } E.\\
  \rho_E & = & \mbox{ supremum of the diameters of the spheres contained in } E.
\end{IEEEeqnarray*}
Consider a family of meshes $\{\pazocal{T}_n\}_{n\in\mathbb{N}}$ such that 
$\max_{E\in\pazocal{T}_{n}} h_E$
tends to zero as $n$ tends to infinity.
\begin{itemize}
	\item [i)] The family of meshes is isotropic if 
	there is a positive constant $\sigma$ such that
	for each $n$ and each $E\in\pazocal{T}_n$ 
	\[
		h_E \leqslant \sigma\rho_E.
	\]
	\item [ii)] The family of meshes is anisotropic if it is not
	isotropic.
\end{itemize}
\end{defi}
\begin{defi}
  If $V(E)$ denotes a functional space over an element $E$ from a 
  mesh $\pazocal{T}_n$ for a domain $\Omega$, the symbol $V(\pazocal{T}_n)$
  denotes the space of functions in $\Omega$ whose restrictions to each 
  $E\in\pazocal{T}_n$ belongs to $V(E)$.
\end{defi}
\subsection{Polynomials} % (fold)
\label{sub:polynomials}
The finite elements involved in this Thesis are built with piecewise
polynomial functions or rational functions (that is, quotients of polynomials).
As we will see, the virtual elements also involve functions of these
two kinds amongst others.
For that reason we state some handy notations here.
\begin{defi}
\begin{IEEEeqnarray*}{rCl}
          P_k & = & \{\,\mbox{polynomials of degree less than or equal to k}\,\}.\\[5pt]
  \tilde{P}_k & = & \{\,\mbox{homogeneous polynomials of degree k}\,\}.\\[5pt]
\end{IEEEeqnarray*}
In the case of a line segment $\be$ or a subdomain $f$ of a plane (typically
an edge or a face of a polyhedron) we will write interchangeably
\begin{IEEEeqnarray*}{rCcCl}
	P_k (\be) & = & P_k(t) & = & \{\,\mbox{polynomials of maximum degree k in arc length on $\be$}\,\}\mbox{,}\\[5pt]
	P_k (f) & = & P_k(t_1,t_2) & = & \{\,\mbox{polynomials of maximum degree k in ${\xi_1}$, ${\xi_2}$ on f}\,\}\mbox{,}
\end{IEEEeqnarray*}
where we have used an orthogonal coordinate system $(\xi_1,\xi_2)$ in the plane
containing $f$ and the variable $\xi$ along the edge $\be$.
Moreover, we will make the identifications
\begin{IEEEeqnarray*}{rClCrCl}
	P_k(\be)  & = & \{p|_{\be}\,:\,p\in P_k\} &\quad\mbox{ and }\quad&P_k(f)
			& = & \{p|_f\,:\,p\in P_k\}.
\end{IEEEeqnarray*}
\end{defi}
\noindent The tensor product of polynomials. % (fold)
\begin{defi} \label{tensor_product} Given two polynomials 
\begin{IEEEeqnarray*}{rClcrCl}
	p(x)&=&\sum_i a_ix^i&\quad\mbox{ and }\quad&q(y)&=&\sum_j b_jy^j
\end{IEEEeqnarray*}
the tensor product of $p$ and $q$ is the following
polynomial of \emph{separate variables}
\begin{IEEEeqnarray}{rCl}
	p\otimes q (x,y)&=&\sum_{i,j}a_ib_jx^iy^j.
\end{IEEEeqnarray}
If $\mathbb{Q}_1$ and $\mathbb{Q}_2$ are two polynomial spaces
\begin{IEEEeqnarray}{rCl}
	\mathbb{Q}_1\otimes \mathbb{Q}_2 & = &\{p\otimes q\,|\,p\in\mathbb{Q}_1, q\in\mathbb{Q}_2\}.
\end{IEEEeqnarray}
\end{defi}
\begin{remark}\label{tensor_prod_dim} An observation that we will use several times is that,
from the definition, $\dim \pazocal{P}\otimes \pazocal{Q} = \dim \pazocal{P} \dim \pazocal{Q}$.
\end{remark}
% subsubsection tensor_product (end)
% subsection polynomials (end)
\subsection{Functional Spaces and Trace Spaces} % (fold)
\label{sub:functional_spaces_trace_spaces}
Let $\bx$, $\by$, \dots\, denote points in $\mathbb{R}^n$
and let $d\bx$, $d\by$, \dots denote Lebesgue measure. If $\Omega$
is a measurable set, $1\leqslant p\leqslant\infty$ and $f$ is a 
real or complex valued measurable function, we say $f\in L^p(\Omega)$
if
\begin{IEEEeqnarray*}{rCcCl}
    \|f\|_{L^p(\Omega)}\,=\,\|f\|_{0,p,\Omega}& := &\left\{\int_\Omega |f(\bx)|^p\,d\bx\right\}^{\nicefrac1p} 
    & < & \infty
\end{IEEEeqnarray*}
with the usual modification when $p=\infty$.

Let $\mathbb{Z}_{\geqslant 0}$ denote the set of nonnegative integers. A
\emph{multi--index} $\balpha$ is an $n$--tuple of nonnegative integers:
$\balpha = (\alpha_1,\ldots,\alpha_n)$, $\alpha_i\in\mathbb{Z}_{\geqslant 0}$,
${\s1\leqslant i\leqslant n}$. With multi--indices we will establish the following
notations:
\begin{IEEEeqnarray*}{rCl}
  |\balpha|&=&\sum_i\alpha_i\mbox{,}\\[5pt]
  \balpha&\leqslant&\boldsymbol{\beta}\mbox{\quad iff\quad} \alpha_i\leqslant\beta_i
  \mbox{,\quad}
  {\s 1\leqslant i\leqslant n}\mbox{,}\\[5pt]
  \balpha+\boldsymbol{\beta}&=&(\alpha_1+\beta_1,\ldots,\alpha_n+\beta_n)\mbox{,}\\[5pt]
  \balpha-\boldsymbol{\beta}&=&(\max\{\alpha_1-\beta_1,0\},\ldots,\max\{\alpha_n-\beta_n,0\})\mbox{,}\\[5pt]
  \balpha!&=&\Pi_{i=1}^n \alpha_i!\mbox{,}\\[5pt]
  \bx^{\balpha}&=&\Pi_{i=1}^n x_i^{\alpha_i}\mbox{\quad and}\\[5pt]
  {\s\partial}^{\balpha}\,=\,\left(\frac{{\s\partial}}{{\s\partial}\bx}\right)^{\balpha}&=&\frac{{\s\partial}^{|\balpha|}}{{\s\partial} x_1^{\alpha_1}
  \ldots{\s\partial} x_n^{\alpha_n}}\\[5pt]
  &=&\Pi_{i=1}^n \left(\frac{{\s\partial}}{{\s\partial} x_i}\right)^{\alpha_i}.
\end{IEEEeqnarray*}
If $|\alpha| = 0$, $\partial^{\alpha}f=f$.\\

Let $\Omega$ be an open set with Lipschitz boundary, let $\pazocal{C}^\infty(\Omega)$ denote
the space of infinitely differentiable functions in $\Omega$.                            %For $f\in\pazocal{C}^\infty(\Omega)$
Let $\mathcal{D}(\Omega)$ denote the vectorial subspace of $\pazocal{C}^\infty(\Omega)$
functions that have compact support in $\Omega$, called the \emph{space of test functions}
with the usual topology (cfr.~\cite{rudin}, page 136) 
for which we say a sequence $\phi_n\to 0$ in the topology of $\mathcal{D}(\Omega)$
if and only if there is a compact $K\subseteq\Omega$ which contains the support
of every $\phi_n$, and $\partial^{\alpha}\phi_n\to 0$ uniformly on $K$, as $n\to\infty$,
for every multi--index $\balpha$. The dual $\mathcal{D}'(\Omega)$ of $\mathcal{D}(\Omega)$
is called the space of \emph{distributions} on $\Omega$. If $\phi\in\mathcal{D}'(\Omega)$
and $\alpha$ is a multi--index, $\partial^{\alpha}\phi$ is called a distributional
or weak derivative of $\phi$, where $\partial^{\alpha}\phi$ is defined by
\begin{IEEEeqnarray*}{rCl}
  (\partial^{\alpha}\phi)(f) & = & (-1)^{|\alpha|}\phi(\partial^{\alpha}f)\mbox{,\qquad}
    f\in\mathcal{D}(\Omega).
\end{IEEEeqnarray*}
A distribution $\phi\in\mathcal{D}'(\Omega)$ will be identified with a function
$\psi$ defined on $\Omega$ if for each $f\in \mathcal{D}(\Omega)$, $\psi f\in L^1(\Omega)$
and $\phi(f) = \int_\Omega \psi f\,d\bx$. In this case we shall let
$\phi$ denote the identified function, $\psi$, as well. 

If $m\in\mathbb{Z}_{\geqslant 0}$ and if for each multi--index $\alpha$
with $|\alpha|\leqslant m$, $\partial^{\alpha}\phi$ is  given by a function such that
\begin{IEEEeqnarray*}{rCcccCl}
  \|\phi\|_{W^{m,p}(\Omega)} & = & 
  \|\phi\|_{m,p,\Omega} & := & 
  \left\{\sum_{|\alpha|\leqslant m}\|{\s\partial}^\alpha\phi\|^p_{L^{p}(\Omega)}\right\}^{\nicefrac1p} 
  & < & \infty\mbox{,}
\end{IEEEeqnarray*}
then we will say $\phi\in W^{m,p}(\Omega)$. For $\phi\in W^{m,p}(\Omega)$ let
\begin{IEEEeqnarray*}{rCcCl}
  |\phi|_{W^{m,p}(\Omega)} & = & |\phi|_{m,p,\Omega} 
    & := & \left\{\sum_{|\alpha|=m}\|\partial\phi\|_{L^{p}(\Omega)}\right\}^{\nicefrac1p}.
\end{IEEEeqnarray*}
In the previous notation we will skip the number $2$ for the special case $p=2$ and 
write $\|\phi\|_{W^{m,2}(\Omega)}=\|\phi\|_{m,\Omega}$,
$|\phi|_{W^{m,2}(\Omega)}=|\phi|_{m,\Omega}$.
Sometimes we will write, in the vectorial case, $|\bu|^p = |u_1|^p + |u_2|^p + |u_3|^p$.\\

In the definitions of the following two functional spaces, the differential
operators must be understood in the distributional sense.
\begin{defi} As in page 26 of~\cite{giraultRaviart} we make the present definition. Let 
$\Omega\subseteq\mathbb{R}^3$ be a lipschitz domain.
  \begin{IEEEeqnarray*}{rCl}
    H(\Div, \Omega) & := & \{\bu\in L^2(\Omega)^3\,:\,\dv \bu \in L^2(\Omega)\}\mbox{,}\\[5pt]
    \|\bu\|_{H(\Div, \Omega)} & := & \left(\|\bu\|^2_{L^2(\Omega)^3}+
      \|\dv \bu\|^2_{L^2(\Omega)}\right)^{\nicefrac12}.
  \end{IEEEeqnarray*}
\end{defi}
\begin{defi} As in page 32 of~\cite{giraultRaviart} we make the present definition. Let 
$\Omega\subseteq\mathbb{R}^3$ be a lipschitz domain.
  \begin{IEEEeqnarray*}{rCl}
    H(\bcurl,\Omega) & := & \{\bu\in L^2(\Omega)^3\,:\,\curl \bu \in L^2(\Omega)^3\}\mbox{,} \\[5pt]
    \|\bu\|_{H(\bcurl,\Omega)} & := & \left(\|\bu\|^2_{L^2(\Omega)^3}+
      \|\curl\bu\|^2_{L^2(\Omega)^3}\right)^{\nicefrac12}.
  \end{IEEEeqnarray*}
\end{defi}
\begin{defi} As in page 4 of~\cite{ariel} we make the present definition.
\begin{IEEEeqnarray*}{rCl}
  W^p(\bcurl, \Omega) & = & \{\bu\in W^{1,p}(\Omega)^3\,:\,
  \curl\bu\in W^{1,1}(\Omega)^3\}\mbox{,}\\
  \label{normaWpcurl}\yesnumber \|\bu\|_{_{W^p(\bcurl, \Omega)}} & = & 
  \|\bu\|_{_{W^{1,p}(\Omega)}} +
  \| \curl\bu \|_{_{W^{1,1}(\Omega)}}. 
\end{IEEEeqnarray*}
\end{defi}
The concept of a component that is normal to the boundary can be extended
to $H(\Div,\Omega)$ using a density argument. This is what we call \textsl{the
normal trace}. Let $\bnu$ be, in the following, the unit outward normal
to $\partial\Omega$. For a function $\bv\in\pazocal{C}^\infty(\overline{\Omega})^3$
the normal trace $\gamma_{\boldsymbol{\nu}}$ is defined simply by
\begin{IEEEeqnarray}{rCl}\label{normal_trace}
  \gamma_{\boldsymbol{\nu}}(\bv) & := & \bv|_{\partial\Omega}\cdot\boldsymbol{\nu}.
\end{IEEEeqnarray}
The proof of next Theorem can be found in~\cite{monk}, page $53$ and uses merely
the density of $\pazocal{C}^\infty(\overline{\Omega})^3$ in $H(\Div,\Omega)$.
\begin{theorem} The operator $\gamma_{\boldsymbol{\nu}}$ defined in~(\ref{normal_trace})
can be extended by continuity to a continuous linear map $\gamma_{\boldsymbol{\nu}}$ from
$H(\Div,\Omega)$ onto $(H^{\nicefrac12}(\partial\Omega))'.$
\end{theorem}
With regard to trace properties in $H(\bcurl)$, we must verify that
functions in this space have a well--defined tangential trace (cfr.
page 34 of~\cite{giraultRaviart} and page 59 of~\cite{monk}). The next Definition
and proof of the Theorem after it can be found in~\cite{chenDuZou} and gives the
form that the surface degrees of freedom in $H(\bcurl)$--Conforming
Elements will take.

For a smooth vector function $\bv\in\pazocal{C}^\infty(\overline{\Omega})^3$ we define
the two traces
\begin{IEEEeqnarray}{rCl}
\label{aux_label80}\gamma_t(\bv)&=&\bnu\times\bv|_{\partial\Omega}\\
\gamma_T(\bv)&=&(\bnu\times\bv|_{\partial\Omega})\times\bnu
\end{IEEEeqnarray}
Theorem $3.29$ in~\cite{monk} states that~(\ref{aux_label80}) can be extended
by continuity to a continuous linear map from $H(\bcurl,\Omega)$ into 
$(H^{\nicefrac12}(\partial\Omega)')^3$
\begin{defi}
  \begin{IEEEeqnarray}{rCl}
  \nonumber
    Y(\partial\Omega) &=& \left\{ \boldsymbol{f}\in 
    (H^{\nicefrac12}(\partial\Omega)')^3\,:\,\mbox{ there exists }\bu\in 
    H(\bcurl,\Omega) \right.\\
    &&\quad\left.\mbox{with } \gamma_t(\bu) = \boldsymbol{f}\right\}\mbox{,}
  \end{IEEEeqnarray}
  \begin{IEEEeqnarray*}{rCl}
    \|\boldsymbol{f}\|_{Y(\partial\Omega)} &=& 
    \inf_{\bu\in H(\bcurl,\Omega), \gamma_t(\bu) = \boldsymbol{f}}
    \|\bu\|_{H(\bcurl,\Omega)}.
  \end{IEEEeqnarray*}
\end{defi}
So we can consider the epimorphism $\gamma_t\,:\,H(\bcurl,\Omega)\rightarrow
Y(\partial\Omega)$ with which we have the following Theorem (cfr. Theorem 3.31
in~\cite{monk}).
\begin{theorem} The map 
$\gamma_T\,:\,H(\bcurl,\Omega)\rightarrow
Y(\partial\Omega)'$ is well--defined. For any $\bv$, $\bphi$ in $H(\bcurl,\Omega)$
\begin{IEEEeqnarray}{rCl}\label{aux_label5}
   \int_\Omega \curl\bv\cdot\bphi\,d\bx 
    - \int_\Omega \bv\cdot\curl\bphi\,d\bx & = & 
    \langle\gamma_t(\bv), \gamma_T(\bphi)\rangle_{\partial\Omega}
 \end{IEEEeqnarray}
($\langle\cdot,\cdot\rangle$ denotes a duality pairing).
\end{theorem}
%%=============================================================================
% {\color{blue}\#\#\#\#\#\#\#\# es el de pag. 51 Adams?.}
% {\color{blue}\#\#\#\#\#\#\#\# tal vez mejor el Teorema 3.26 de monk, pag.55?.}
% {\color{blue}\#\#\#\#\#\#\#\# poner un esbozo de la prueba, mirar chap 3 adams
%  si queda tiempo.}
%%=============================================================================
\begin{defi}
  We shall say that a domain $\Omega$ has the \textsl{segment property}
  if for every $x$ in the boundary of $\Omega$ there exists an open set
  $U_x$ and a nonzero vector $y_x$ such that $x\in U_x$ and if 
  $z\in\overline{\Omega}\cap U_x$, then $z+ty_x \in \Omega$ for $0<t<1$.
\end{defi}
A domain having this property must have $(n-1)$--dimensional boundary
and cannot simultaneously lie on both sides of any given part of its
boundary.  Since the polyhedra we will consider to build finite elements are
  convex and obviously satisfy the segment property,
  with techniques that can be learned from Chapter $3$
  in the book~\cite{adams} we can prove the following Proposition for our 
  elements.
\begin{proposition}\label{density_wpcurl}
  The space $\pazocal{C}^\infty(\bar{E})^3$ is dense in
  $W^p(\bcurl,{E})$ with its norm defined in~(\ref{normaWpcurl}).
\end{proposition}

With elementary applications of integration by parts for distributional
derivatives we get the following two Lemata.
\begin{lemma} Let two disjoint Lipschitz domains $\Omega_1$ and $\Omega_2$
be given  in $\mathbb{R}^3$, such that $\overline{\Omega_1}\cap\overline{\Omega_2}$ is an
$2$--dimensional surface $f$ of positive measure. Take
$\Omega = \Omega_1\cup \Omega_2\cup f$. Let $\bu_1 \in H(\Div,\Omega_1)$ 
and $\bu_2 \in H(\Div,\Omega_2)$. Consider 
\begin{IEEEeqnarray*}{rCl}
  \bu & = &
    \begin{cases}
      \bu_1, &\text{ on }\Omega_1\\
      \bu_2, &\text{ on }\Omega_2     
    \end{cases}.
\end{IEEEeqnarray*}
Then $\bu$ is in $H(\Div,\Omega)$ if and only if
the normal traces of $\boldsymbol{u}_1$ and $\boldsymbol{u}_2$ coincide on $f$.
\end{lemma}
\begin{lemma} Let two disjoint Lipschitz domains $\Omega_1$ and $\Omega_2$
be given  in $\mathbb{R}^3$, such that $\overline{\Omega_1}\cap\overline{\Omega_2}$ is an
$2$--dimensional surface $f$ of positive measure. Take
$\Omega = \Omega_1\cup \Omega_2\cup f$. Let $\bu_1 \in H(\bcurl,\Omega_1)$ 
and $\bu_2 \in H(\bcurl,\Omega_2)$. Consider 
\begin{IEEEeqnarray*}{rCl}
	\bu & = &
	  \begin{cases}
	  	\bu_1, &\text{ on }\Omega_1\\
	  	\bu_2, &\text{ on }\Omega_2	  	
	  \end{cases}.
\end{IEEEeqnarray*}
Then $\bu$ is in $H(\bcurl,\Omega)$ if and only if
the tangential traces $\gamma_T(\cdot)$
of $\bu_1$ and $\bu_2$, as defined in~(\ref{aux_label5}), coincide on $f$.
\end{lemma}
%=================
%\begin{proof}
%	{\color{red} TODO}
%\end{proof}
%=================
% subsection functional_spaces_trace_spaces (end)

\begin{defi}\label{defi_of_ref_prism}
  Let $\hat T$ be the triangle $\{ 0 < x + y < 1 \}$. 
  The reference prism is the interior of 
  $\hat T\times\{ 0 < z < 1 \}$ (cfr. Figure~\ref{reference_prism}).
\end{defi}
\begin{defi}\label{defi_of_ref_pyr}
The reference pyramid $\hat E$ is the polyhedron 
$\{\bx\in\mathbb{R}^3\,:\,0< x_3< 1,
0<  x_1<  1-x_3, 0<  x_2<  1-x_3\}$
with vertices at $(0,0,0)'$,
$(1,0,0)'$, $(0,1,0)'$, $(1,1,0)'$ and $(0,0,1)'$ (cfr. Figure~\ref{refpyr}).
\end{defi}
\begin{defi}\label{def_of_ref_elems}
The reference tetrahedron is (cfr. Figure~\ref{reftetr})
$\{\bx\in\mathbb{R}^3\,:\,x_1 > 0, x_2 > 0, x_3 > 0, x_1+x_2+x_3 < 1\}$.
\end{defi}

\begin{figure}
	\centering
  \subfloat[Pyramid]
  {
    \label{refpyr}
    \referencePyramidTikz{1.5}
  }
  \hspace{1cm}
  \subfloat[Prism]
  {
    \label{reference_prism}
    \referencePrismTikz{1.5}
  }\\
  \subfloat[Tetrahedron]
  {
    \label{reftetr}
    \referenceTetrahedronTikz{1.5}
  }
  \hspace{1cm}
  \subfloat[Triangle]
  {
    \label{reference_triangle}
    \referenceTriangleTikz{1.3}
  }
	\caption{Reference Elements}
\end{figure}
