\chapter{Preliminaries}
\label{chap_prelim}
\section{Preliminaries} % (fold)
\label{sec:preliminaries}
\subsection{Definitions, notations} % (fold)
\label{sub:definitions_notations}
\begin{defi}
A Finite Element in $\mathbb{R}^n$ is defined by the following triple $(K, P_K, \Sigma) $:
\vspace{5pt}
\noindent
$E$ is an open non empty domain of $\mathbb{R}^n$ with Lipschitz--continuous 
boundary.\\[5pt]
\noindent
$P_K$ is a finite--dimensional space of real--valued functions defined over $K$.\\[5pt]
\noindent
$\Sigma$ is a finite set of linearly independent linear functionals acting 
on a functional space containing $P_K$. The elements of $\Sigma$ are often
referred to as  \emph{degrees of freedom} or \emph{moments} of the Finite
Element.
\end{defi}
\noindent As we are going to deal with vectorial Finite Elements and
Virtual Elements, we are going to need to use the following notational convention.
\begin{defi} If\hspace{7pt}$V$ denotes a functional space of vectorial
fields in $\mathbb{R}^n$, whether finite dimensional
or not, $(V)_i$ denotes the space of scalar functions in $i-$th
coordinate projection
of $V$, for $1\leqslant i\leqslant n$.
\end{defi}

\begin{defi} a family of meshes is regular if 
\end{defi}

\begin{defi} a family of meshes is anisotropic if 
\end{defi}

\begin{defi} a family of meshes is graded if 
\end{defi}

\subsection{Polynomials} % (fold)
\label{sub:polynomials}
The finite elements involved in this Thesis are built with piecewise
polynomial functions or rational functions (that is, quotients of polynomials).
For that reason we state some handy notations here.
\begin{defi}
\begin{IEEEeqnarray*}{rCl}
          P_k & = & \{\,\mbox{polynomials of degree less than or equal to k}\,\}\\[5pt]
  \tilde{P}_k & = & \{\,\mbox{homogeneous polynomials of degree k}\,\}\\[5pt]
\end{IEEEeqnarray*}
In the case of a line segment \emph{e} or a subdomain \emph{f} of a plane (typically
an edge or a face of a polyhedron) we will write
\begin{IEEEeqnarray*}{rCl}
	P_k (e) & = & \{\,\mbox{polynomials of maximum degree k in arc length on e}\,\}\\[5pt]
	P_k (f) & = & \{\,\mbox{polynomials of maximum degree k in $\xi_1$,$\xi_2$ on f}\,\}
\end{IEEEeqnarray*}
where we have used an orthogonal coordinate system $(\xi_1,\xi_2)$ in the plane
containing $f$.\\[5pt]
Moreover, we will make the identifications
\begin{IEEEeqnarray*}{rClCrCl}
	P_k(e)  & = & \{p|_e\,:\,p\in P_k\} &\quad\mbox{ and }\quad&P_k(f)
			& = & \{p|_f\,:\,p\in P_k\}.
\end{IEEEeqnarray*}
\end{defi}
\noindent The tensor product of polynomials. % (fold)
\begin{defi} \label{tensor_product} Given two polynomials 
\begin{IEEEeqnarray*}{rClcrCl}
	p(x)&=&\sum a_ix^i&\qquad&q(y)&=&\sum b_jy^j
\end{IEEEeqnarray*}
the tensor product of $p$ and $q$ is the following
polynomial of \emph{separate variables}
\begin{IEEEeqnarray}{rCl}
	p\otimes q (x,y)&=&\sum_{i,j}a_ib_jx^iy^j.
\end{IEEEeqnarray}
If $\mathcal{P}$ and $\mathcal{Q}$ are two polynomial spaces
\begin{IEEEeqnarray}{rCl}
	\mathcal{P}\otimes \mathcal{Q} & = &\{p\otimes q\,|\,p\in\mathcal{P}, q\in\mathcal{Q}\}.
\end{IEEEeqnarray}
\end{defi}
\noindent In particular we will use the notation.
\begin{notation}
  $Q_{k,k,k} = P_k(\hat{x}_1)\otimes P_k(\hat{x}_2)\otimes P_k(\hat{x}_3)$.
\end{notation}
\begin{remark}\label{tensor_prod_dim} an observation that we will use several times is that,
from the definition, $\dim \mathcal{P}\otimes \mathcal{Q} = \dim \mathcal{P} \dim \mathcal{Q}$.
\end{remark}
% subsubsection tensor_product (end)
% subsection polynomials (end)
\subsection{Functional Spaces. Trace Spaces.} % (fold)
\label{sub:functional_spaces_trace_spaces}
\begin{defi}
\begin{IEEEeqnarray*}{rCl}
	W^p(\emph{\textbf{curl}}, E) &=& \{ \emph{\textbf{u}}\in W^{1,p}(E)^3\,:\,\emph{
	\curl}\emph{\textbf{u}}\in W^{1,1}(E)^3\}\\
	\label{normaWpcurl}\yesnumber \|\emph{\textbf{u}}\|_{_{W^p(\emph{\textbf{curl}}, E)}} &=& 
	\|\emph{\textbf{u}}\|_{_{W^{1,p}(E)}} +
	\| \emph{\curl}\emph{\textbf{u}} \|_{_{W^{1,1}(E)}}. 
\end{IEEEeqnarray*}
\end{defi}
To talk  about the regularity of a solution in a \emph{non--convex} domain
we will make use of the following weighted Sobolev space.
\begin{defi} Suppose $\Omega$ non--convex, $\Lambda \subseteq \Omega$ such that 
$\Lambda closure$ contains one singular vertex $\bv$ and one singular edge $\be$. Given two
positive parameters $\beta$ and $\delta$, the symbol $V_{\beta,\delta}^{1,2}(\Lambda)$
denotes the space
\begin{IEEEeqnarray}{rCl}\label{weighted_sobolev}
	V_{\beta,\delta}^{1,2}(\Lambda) & = &
	  \left\{v\in \mathcal D'(\Lambda):
	    R^{\beta-1+|\alpha|}\theta^{\delta-1+|\alpha|}D^\alpha v\in L^2(\Lambda),
	    \alpha\in \mathbb N_0^3, |\alpha|\leqslant 1
	  \right\}
\end{IEEEeqnarray}
where $R({\bf x})$ is the distance of ${\bf x}$ to the vertices
of $\Lambda$,
$r({\bf x})$ is the distance from ${\bf x}$ to the edges
of $\Lambda$ and
finally $\theta({\bf x})$ is the angular distance
$\theta({\bf x})=\frac{r({\bf x})}{R({\bf x})}$.
\end{defi}
\begin{lemma} Let two disjoint Lipschitz domains $\Omega_1$ and $\Omega_2$
be given  in $\mathbb{R}^n$, such that $\overline{\Omega_1}\cap\overline{\Omega_2}$ is an
$(n-1)$--dimensional surface $f$ of positive measure. Take
$\Omega = \Omega_1\cup \Omega_2\cup f$. Let $\bu_1 \in H(\text{div},\Omega_1)$ 
and $\bu_2 \in H(\text{div},\Omega_2)$. Consider 
\begin{IEEEeqnarray*}{rCl}
	\bu & = &
	  \begin{cases}
	  	\bu_1, &\text{ on }\Omega_1\\
	  	\bu_2, &\text{ on }\Omega_2	  	
	  \end{cases}.
\end{IEEEeqnarray*}
Then $\bu$ is in $H(\text{div},\Omega)$ if and only if
the normal traces of $\boldsymbol{u}_1$ and $\boldsymbol{u}_2$ coincide on $f$.
\end{lemma}
\begin{proof}
	{\color{red} TODO}
\end{proof}
% subsection functional_spaces_trace_spaces (end)
\subsection{Transformations} % (fold)

\{*** traido de seccion $\tilde{E}$
y usamos todo lo que estudiamos en la Secci√≥n~\ref{sub:transformaciones_entre_prismas}
para transformar $\hat{E} $ en $\tilde{E} $ v\'ia


y para transformar campos, rotores y el interpolador. Por ejemplo, usaremos que 
\begin{IEEEeqnarray*}{rCl}
    \hat{\pi}_i & = & h_i\tilde{\pi}_i \\
    (\textbf{curl}\,\hat{\textbf{u}})_3 & = & h_1h_2(\textbf{curl}\,\tilde{\textbf{u}})_3.
\end{IEEEeqnarray*}


\}

\label{sub:transformations}
\begin{equation}\label{push-forward}
	{\color{red} \ldots \mbox{push-forward} \ldots}
\end{equation}
% subsection transformations (end)
\referencePrismTikz
\begin{defi} We say that the unisolvent Finite Element $(E, P_E, \Sigma)$ is
$H(\text{div})$--conforming if every time we take two
\emph{push-forward} elements $(E_1, P_{E_1}, \Sigma_1)$
and $(E_2, P_{E_2}, \Sigma_2)$ according
to~(\ref{sub:transformations}), and denote $\pi_1$, $\pi_2$
the interpolation operators determined by the degrees
of freedom $\Sigma_1$ and $\Sigma_2$, the field defined as
\begin{IEEEeqnarray*}{rCl}
	\bw & = &
	  \begin{cases}
	  	\pi_1(\bu|_{\Omega_1}), &\text{ on }\Omega_1\\
	  	\pi_2(\bu|_{\Omega_2}), &\text{ on }\Omega_2	  	
	  \end{cases}
\end{IEEEeqnarray*}
results in $H(\text{div},\Omega_1\cup\Omega_2)$.
\end{defi}
% section preliminares (end)
	
