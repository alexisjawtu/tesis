\chapter{Preliminaries}
\label{chap_prelim}
\section{Preliminaries} % (fold)
\label{sec:preliminaries}
\subsection{Definitions, notations} % (fold)
\label{sub:definitions_notations}
\begin{defi}
A Finite Element in $\mathbb{R}^n$ is defined by the following triple $(E, P_E, \Sigma) $:
\vspace{5pt}
\noindent
$E$ is an open non empty domain of $\mathbb{R}^n$ with Lipschitz--continuous 
boundary.\\[5pt]
\noindent
$P_E$ is a finite--dimensional space of real--valued functions defined over $E$.\\[5pt]
\noindent
$\Sigma$ is a finite set of linearly independent linear functionals acting 
on a functional space containing $P_E$. The elements of $\Sigma$ are often
referred to as  \emph{degrees of freedom} or \emph{moments} of the Finite
Element.
\end{defi}
\noindent As we are going to deal with vectorial Finite Elements and
Virtual Elements, we are going to need to use the following notational convention.
\begin{defi} If\hspace{7pt}$V$ denotes a functional space of vectorial
fields in $\mathbb{R}^n$, whether finite dimensional
or not, $(V)_i$ denotes the space of scalar functions in $i-$th
coordinate projection
of $V$, for $1\leqslant i\leqslant n$.
\end{defi}
\begin{defi} 
Given  a Finite Elements $E$ set
\begin{IEEEeqnarray*}{rCl}
  h_E & = & \mbox{ diameter of the element } E.\\
  \rho_E & = & \mbox{ supremum of the diameters of the spheres inscribed in } E.
\end{IEEEeqnarray*}
Consider a family of meshes $\{\mathcal{T}_n\}_{n\in\mathbb{N}}$ such that 
there is a sequence of elements $E_{n_k}\in\mathcal{T}_{n_k}$ for which
	$h_{E_{n_k}}$ tends to zero as $k$ tends to infinity.
\begin{itemize}
	\item [i)] The family of meshes is isotropic if 
	there is a positive constant $\sigma$ such that
	for each $n$ and each $E\in\mathcal{T}_n$ 
	\[
		h_E \leqslant \sigma\rho_E.
	\]
	\item [ii)] The family of meshes is anisotropic if it is not
	isotropic.
\end{itemize}
\end{defi}

\subsection{Polynomials} % (fold)
\label{sub:polynomials}
The finite elements involved in this Thesis are built with piecewise
polynomial functions or rational functions (that is, quotients of polynomials).
As we will see, the virtual elements also involve functions of these
two kinds.
For that reason we state some handy notations here.
\begin{defi}
\begin{IEEEeqnarray*}{rCl}
          P_k & = & \{\,\mbox{polynomials of degree less than or equal to k}\,\}\\[5pt]
  \tilde{P}_k & = & \{\,\mbox{homogeneous polynomials of degree k}\,\}\\[5pt]
\end{IEEEeqnarray*}
In the case of a line segment \emph{e} or a subdomain \emph{f} of a plane (typically
an edge or a face of a polyhedron) we will write
\begin{IEEEeqnarray*}{rCl}
	P_k (e) & = & \{\,\mbox{polynomials of maximum degree k in arc length on e}\,\}\\[5pt]
	P_k (f) & = & \{\,\mbox{polynomials of maximum degree k in $\xi_1$,$\xi_2$ on f}\,\}
\end{IEEEeqnarray*}
where we have used an orthogonal coordinate system $(\xi_1,\xi_2)$ in the plane
containing $f$.\\[5pt]
Moreover, we will make the identifications
\begin{IEEEeqnarray*}{rClCrCl}
	P_k(e)  & = & \{p|_e\,:\,p\in P_k\} &\quad\mbox{ and }\quad&P_k(f)
			& = & \{p|_f\,:\,p\in P_k\}.
\end{IEEEeqnarray*}
\end{defi}
\noindent The tensor product of polynomials. % (fold)
\begin{defi} \label{tensor_product} Given two polynomials 
\begin{IEEEeqnarray*}{rClcrCl}
	p(x)&=&\sum a_ix^i&\quad\mbox{ and }\quad&q(y)&=&\sum b_jy^j
\end{IEEEeqnarray*}
the tensor product of $p$ and $q$ is the following
polynomial of \emph{separate variables}
\begin{IEEEeqnarray}{rCl}
	p\otimes q (x,y)&=&\sum_{i,j}a_ib_jx^iy^j.
\end{IEEEeqnarray}
If $\mathcal{P}$ and $\mathcal{Q}$ are two polynomial spaces
\begin{IEEEeqnarray}{rCl}
	\mathcal{P}\otimes \mathcal{Q} & = &\{p\otimes q\,|\,p\in\mathcal{P}, q\in\mathcal{Q}\}.
\end{IEEEeqnarray}
\end{defi}
\noindent In particular we will use the notation.
\begin{notation}
  $Q_{k,k,k} = P_k(\hat{x}_1)\otimes P_k(\hat{x}_2)\otimes P_k(\hat{x}_3)$.
\end{notation}
\begin{remark}\label{tensor_prod_dim} an observation that we will use several times is that,
from the definition, $\dim \mathcal{P}\otimes \mathcal{Q} = \dim \mathcal{P} \dim \mathcal{Q}$.
\end{remark}
% subsubsection tensor_product (end)
% subsection polynomials (end)
\subsection{Functional Spaces. Trace Spaces.} % (fold)
\label{sub:functional_spaces_trace_spaces}
Let $\bx$, $\by$, \dots denote points in $\mathbb{R}^n$
and let $d\bx$, $d\by$, \dots denote Lebesgue measure. If $\Omega$
is a measurable set, $1\leqslant p\leqslant\infty$ and $f$ is a 
real or complex valued measurable function, we say $f\in L^p(\Omega)$
if
\begin{IEEEeqnarray*}{rCcCl}
    \|f\|_{L^p(\Omega)}\,=\,|f|_{0,\Omega}& := &(\int_\Omega |f(\bx)|^p\,d\bx)^{\nicefrac1p} 
    & < & \infty
\end{IEEEeqnarray*}
with the usual modification when $p=\infty$.

Let $\mathbb{Z}_{\geqslant 0}$ denote the set of nonnegative integers. A
\emph{multi--index} $\alpha$ is an $n$--tuple of nonnegative integers:
$\alpha = (\alpha_1,\ldots,\alpha_n)$, $\alpha_i\in\mathbb{Z}_{\geqslant 0}$,
$i=1,\ldots,n$. With multi--indices we will establish the following
notations:
\begin{IEEEeqnarray*}{rCl}
    |\alpha|&=&\sum_i\alpha_i\mbox{,}\\[5pt]
    \alpha&\leqslant&|\beta|\mbox{ iff } \alpha_i\leqslant\beta_i\mbox{,\,}
    i=1,\ldots,n\mbox{,}\\[5pt]
    \alpha+\beta&=&(\alpha_1+\beta_1,\ldots,\alpha_n+\beta_n)\mbox{,}\\[5pt]
    \alpha-\beta&=&(\max\{\alpha_1-\beta_1,0\},\ldots,\max\{\alpha_n-\beta_n,0\})\mbox{,}\\[5pt]
    \alpha!&=&\Pi_{i=1}^n \alpha_i!\mbox{,}\\[5pt]
    \bx^\alpha&=&\Pi_{i=1}^n x_i^{\alpha_i}\mbox{\,and}\\[5pt]
    (\frac{\partial}{\partial\bx})^\alpha&=&\frac{\partial^{|\alpha|}}{\partial x_1^{\alpha_1}
    \ldots\partial x_n^{\alpha_n}}\\[5pt]
    &=&\Pi_{i=1}^n (\frac{\partial}{\partial x_i})^{\alpha_i}.
\end{IEEEeqnarray*}
Given a function $f$
\begin{IEEEeqnarray*}{rCcCl}
    \partial^{\alpha}f&=&f^{(\alpha)}&=&(\frac{\partial}{\partial\bx})^{\alpha}f.
\end{IEEEeqnarray*}
If $|\alpha| = 0$, $\partial^{\alpha}f=f$.

When $\Omega$ is an open set, let $\mathcal{C}^\infty(\Omega)$ denote
the space of infinitely differentiable functions in $\Omega$.
For $f\in\mathcal{C}^\infty(\Omega)$
Let $\mathcal{D}(\Omega)$ denote the vectorial subspace of $\mathcal{C}^\infty(\Omega)$
functions that have compact support in $\Omega$, called the \emph{space of test functions}
with the usual topology~(\cite{rudin}, page 136) 
for which we say a sequence $\phi_n\to 0$ in the topology of $\mathcal{D}(\Omega)$
if and only if there is a compact $K\subseteq\Omega$ which contains the support
of every $\phi_n$, and $\partial^{\alpha}\phi_n\to 0$ uniformly on $K$, as $n\to\infty$,
for every multi--index $\alpha$. The dual $\mathcal{D}'(\Omega)$ of $\mathcal{D}(\Omega)$
is called the space of \emph{distributions} on $\Omega$. If $\phi\in\mathcal{D}'(\Omega)$
and $\alpha$ is a multi--index, $\partial^{\alpha}\phi$ is called a distributional
or weak derivative of $\phi$, where $\partial^{\alpha}\phi$ is defined by
\begin{IEEEeqnarray*}{rCl}
  (\partial^{\alpha}\phi)(f) & = & (-1)^{|\alpha|}\phi(\partial^{\alpha}f)\mbox{,\qquad}
    f\in\mathcal{D}(\Omega).
\end{IEEEeqnarray*}
A distribution $\phi\in\mathcal{D}'(\Omega)$ will be identified with a function
$\psi$ defined on $\Omega$ if for each $f\in \mathcal{D}(\Omega)$, $\psi f\in L^1(\Omega)$
and $\phi(f) = \int_\Omega \psi f\,d\bx$. In this case we shall let
$\phi$ denote the identified function, $\psi$, as well. 

If $m\in\mathbb{Z}_{\geqslant 0}$ and if for each multi--index $\alpha$
with $|\alpha|\leqslant m$, $\partial^{\alpha}\phi$ si  given by a function such that
\begin{IEEEeqnarray*}{rCcccCl}
  \|\phi\|_{W^{m,p}(\Omega)} & = & 
  \|\phi\|_{m,p,\Omega} & := & \sum_{|\alpha|\leqslant m}\|\phi\|_{W^{m,p}(\Omega)} 
  & < & \infty\mbox{,}
\end{IEEEeqnarray*}
then $\phi\in W^{m,p}(\Omega)$. For $\phi\in W^{m,p}(\Omega)$ let
\begin{IEEEeqnarray*}{rCcCl}
  |\phi|_{W^{m,p}(\Omega)} & = & |\phi|_{m,p,\Omega} 
    & := & \sum_{|\alpha|=m}\|\phi\|_{W^{m,p}(\Omega)}.
\end{IEEEeqnarray*}
In the previous notation we will skip the number $2$ for the special case $p=2$ and 
write $\|\phi\|_{W^{m,2}(\Omega)}=\|\phi\|_{m,\Omega}$,
$|\phi|_{W^{m,2}(\Omega)}=|\phi|_{m,\Omega}$.
In the definitions of the following two functional spaces, the differential
operators must be understood in the distributional sense.
\begin{defi} As in page 26 of~\cite{giraultRaviart} we make the present definition.
  \begin{IEEEeqnarray*}{rCl}
    H(\dv,\Omega) & := & \{\bu\in L^2(\Omega)^3\,:\,\dv \bu \in L^2(\Omega)\} \\[5pt]
    \|\bu\|_{H(\dv,\Omega)} & := & \left(\|\bu\|^2_{L^2(\Omega)^3}+
      \|\dv \bu\|^2_{L^2(\Omega)}\right)^{\nicefrac12}
  \end{IEEEeqnarray*}
\end{defi}
\begin{defi} As in page 32 of~\cite{giraultRaviart} we make the present definition.
  \begin{IEEEeqnarray*}{rCl}
    H(\bcurl,\Omega) & := & \{\bu\in L^2(\Omega)^3\,:\,\curl \bu \in L^2(\Omega)^3\} \\[5pt]
    \|\bu\|_{H(\bcurl,\Omega)} & := & \left(\|\bu\|^2_{L^2(\Omega)^3}+
      \|\curl\bu\|^2_{L^2(\Omega)^3}\right)^{\nicefrac12}.
  \end{IEEEeqnarray*}
\end{defi}
The concept of a component that is normal to the boundary can be extended
to $H(\dv)$  by continuity using density. This is what we call \textsl{the
normal trace}. For a function $\bv\in\mathcal{C}^\infty(\overline{\Omega})^3$
the normal trace $\gamma_{\boldsymbol{\nu}}$ is defined simply by
\begin{IEEEeqnarray}{rCl}\label{normal_trace}
  \gamma_{\boldsymbol{\nu}}(\bv) & := & \bv|_{\partial\Omega}\cdot\boldsymbol{\nu}.
\end{IEEEeqnarray}
The proof of next Theorem can be found in~\cite{monk}, page $53$ and uses merely
the density of $\mathcal{C}^\infty(\overline{\Omega})^3$ in $H(\dv,\Omega)$.
\begin{theorem} The operator $\gamma_{\boldsymbol{\nu}}$ defined in~(\ref{normal_trace})
can be extended by continuity to a continuous linear map $\gamma_{\boldsymbol{\nu}}$ from
$H(\dv,\Omega)$ onto $(H^{\nicefrac12}(\partial\Omega))'.$
\end{theorem}
With regard to trace properties in $H(\bcurl)$, we must verify that
functions in this space have a well--defined tangential trace (cfr.
page 34 of~\cite{giraultRaviart} and page 59 of~\cite{monk}). The next Definition
and proof of Theorem after can be found in~\cite{chenDuZou} and gives the
form that the surface degrees of freedom in $H(\bcurl)$ will take.
\begin{defi}
  \begin{IEEEeqnarray}{rCl}
  \nonumber
    Y(\partial\Omega) &=& \left\{ \boldsymbol{f}\in 
    (H^{\nicefrac12}(\partial\Omega)')^3\,:\,\mbox{ there exists }\bu\in 
    H(\bcurl,\Omega) \right.\\
    &&\,\left.\mbox{with } \gamma_t(\bu) = \boldsymbol{f}\right\}\mbox{,}
  \end{IEEEeqnarray}
  \begin{IEEEeqnarray*}{rCl}
    \|\boldsymbol{f}\|_{Y(\partial\Omega)} &=& 
    \inf_{\bu\in H(\bcurl,\Omega), \gamma_t(\bu) = \boldsymbol{f}}
    \|\bu\|_{H(\bcurl,\Omega)}.
  \end{IEEEeqnarray*}
\end{defi}
\begin{theorem} The trace mapping $\gamma_t\,:\,H(\bcurl,\Omega)\rightarrow
Y(\partial\Omega)$ is an epimorphism. The map 
$\gamma_T\,:\,H(\bcurl,\Omega)\rightarrow
Y(\partial\Omega)'$ is well--defined. For any $\bv$, $\bphi$ in $H(\bcurl,\Omega)$
\begin{IEEEeqnarray}{rCl}\label{aux_label5}
   \int_\Omega \curl\bv\cdot\bphi\,d\bx 
    - \int_\Omega \bv\cdot\curl\bphi\,d\bx & = & 
    \langle\gamma_t(\bv), \gamma_T(\bphi)\rangle_{\partial\Omega}.
 \end{IEEEeqnarray}     
\end{theorem}



\begin{defi}
\begin{IEEEeqnarray*}{rCl}
	W^p(\curl, E) & = & \{\bu\in W^{1,p}(E)^3\,:\,
	\curl\bu\in W^{1,1}(E)^3\}\\
	\label{normaWpcurl}\yesnumber \|\bu\|_{_{W^p(\curl, E)}} & = & 
	\|\bu\|_{_{W^{1,p}(E)}} +
	\| \curl\bu \|_{_{W^{1,1}(E)}}. 
\end{IEEEeqnarray*}
\end{defi}
%%=============================================================================
%{\color{blue}\#\#\#\#\#\#\#\# es el de pag. 51 Adams?.}
%{\color{blue}\#\#\#\#\#\#\#\# tal vez mejor el Teorema 3.26 de monk, pag.55?.}
%{\color{blue}\#\#\#\#\#\#\#\# poner un esbozo de la prueba, mirar chap 3 adams
%si queda tiempo.}
%%=============================================================================
\begin{defi}
  We shall say that a domain $\Omega$ has the \textsl{segment property}
  if for every $x$ in the boundary of $\Omega$ there exists an open set
  $U_x$ and a nonzero vector $y_x$ such that $x\in U_x$ and if 
  $z\in\overline{\Omega}\cap U_x$, then $z+ty_x \in \Omega$ for $0<t<1$.
\end{defi}
  A domain having this property must have $(n-1)$--dimensional boundary
  and cannot simultaneously lie on both sides of any given part of its
  boundary.

  Since the polyhedra we will consider to build finite elements are
  convex and obviously satisfy the segment property,
  with techniques that can be learned from Chapter $3$
  in the book~\cite{adams} we can prove the following Remark.
\begin{remark}\label{density_wpcurl}
  The space $\mathcal{C}^\infty(\bar{E})^3$ is dense in
  $W^p(\curl,{E})$ with its norm defined in~(\ref{normaWpcurl}).
\end{remark}
To talk  about the regularity of a solution in a \emph{non--convex} domain
we will make use of the following weighted Sobolev space.
\begin{defi} Suppose $\Omega$ non--convex, $\Lambda \subseteq \Omega$ such that 
$\Lambda closure$ contains one singular vertex $\bv$ and one singular edge $\be$. Given two
positive parameters $\beta$ and $\delta$, the symbol $V_{\beta,\delta}^{1,2}(\Lambda)$
denotes the space
\begin{IEEEeqnarray}{rCl}\label{weighted_sobolev}
	V_{\beta,\delta}^{1,2}(\Lambda) & = &
	  \left\{v\in \mathcal D'(\Lambda):
	    R^{\beta-1+|\alpha|}\theta^{\delta-1+|\alpha|}D^\alpha v\in L^2(\Lambda),
	    \alpha\in \mathbb N_0^3, |\alpha|\leqslant 1
	  \right\}
\end{IEEEeqnarray}
where $R({\bf x})$ is the distance of ${\bf x}$ to the vertices
of $\Lambda$,
$r({\bf x})$ is the distance from ${\bf x}$ to the edges
of $\Lambda$ and
finally $\theta({\bf x})$ is the angular distance
$\theta({\bf x})=\frac{r({\bf x})}{R({\bf x})}$.
\end{defi}
With elementary applications of integration by parts for distributional
derivatives we get the following two Lemata.
\begin{lemma} Let two disjoint Lipschitz domains $\Omega_1$ and $\Omega_2$
be given  in $\mathbb{R}^n$, such that $\overline{\Omega_1}\cap\overline{\Omega_2}$ is an
$(n-1)$--dimensional surface $f$ of positive measure. Take
$\Omega = \Omega_1\cup \Omega_2\cup f$. Let $\bu_1 \in H(\text{div},\Omega_1)$ 
and $\bu_2 \in H(\text{div},\Omega_2)$. Consider 
\begin{IEEEeqnarray*}{rCl}
  \bu & = &
    \begin{cases}
      \bu_1, &\text{ on }\Omega_1\\
      \bu_2, &\text{ on }\Omega_2     
    \end{cases}.
\end{IEEEeqnarray*}
Then $\bu$ is in $H(\text{div},\Omega)$ if and only if
the normal traces of $\boldsymbol{u}_1$ and $\boldsymbol{u}_2$ coincide on $f$.
\end{lemma}
\begin{lemma} Let two disjoint Lipschitz domains $\Omega_1$ and $\Omega_2$
be given  in $\mathbb{R}^n$, such that $\overline{\Omega_1}\cap\overline{\Omega_2}$ is an
$(n-1)$--dimensional surface $f$ of positive measure. Take
$\Omega = \Omega_1\cup \Omega_2\cup f$. Let $\bu_1 \in H(\text{div},\Omega_1)$ 
and $\bu_2 \in H(\text{div},\Omega_2)$. Consider 
\begin{IEEEeqnarray*}{rCl}
	\bu & = &
	  \begin{cases}
	  	\bu_1, &\text{ on }\Omega_1\\
	  	\bu_2, &\text{ on }\Omega_2	  	
	  \end{cases}.
\end{IEEEeqnarray*}
Then $\bu$ is in $H(\bcurl,\Omega)$ if and only if
the tangential traces of $\boldsymbol{u}_1$ and $\boldsymbol{u}_2$ coincide on $f$.
\end{lemma}
%=================
%\begin{proof}
%	{\color{red} TODO}
%\end{proof}
%=================
% subsection functional_spaces_trace_spaces (end)

\begin{defi}\label{defi_of_ref_prism}
  Let $\hat T$ be the triangle $\{ 0 < x + y < 1 \}$. 
  The reference prism is the interior of 
  $\hat T\times\{ 0 < z < 1 \}$ (cfr. Figure~\ref{reference_prism}).
\end{defi}
\begin{defi}\label{defi_of_ref_pyr}
The reference pyramid $\hat E$ is the polyhedron 
$\{\bx\in\mathbb{R}^3\,:\,0< x_3< 1,
0<  x_1<  1-x_3, 0<  x_2<  1-x_3\}$
with vertices at $(0,0,0)'$,
$(1,0,0)'$, $(0,1,0)'$, $(1,1,0)'$ and $(0,0,1)'$ (cfr. Figure~\ref{refpyr}).
\end{defi}
\begin{defi}\label{def_of_ref_elems}
The reference Tetrahedron is (cfr. Figure~\ref{reftetr})
$\{\bx\in\mathbb{R}^3\,:\,x_1 > 0, x_2 > 0, x_3 > 0, x_1+x_2+x_3 < 1\}$.
\end{defi}

\begin{figure}
	\centering
  \subfloat[Pyramid]
  {
    \label{refpyr}
    \referencePyramidTikz
  }
  \subfloat[Prism]
  {
    \label{reference_prism}
    \referencePrismTikz
  }\\
  \subfloat[Tetrahedron]
  {
		\label{reftetr}
		\referenceTetrahedronTikz{2}
	}
  \subfloat[Triangle]
  {
    \label{reference_triangle}
    \referenceTriangleTikz
  }
	\caption{Reference Elements}
\end{figure}


\noindent{\color{BrickRed}\#\#\#\#\#\#\# tal vez usar def de conforming
de nedelec 86 pag 58, est'a bastante linda.} 
\begin{defi} Given a fucntional space $\mathbb{W}$ we say that the unisolvent Finite Element
$(E, P_E, \Sigma)$ is
$\mathbb{W}$--conforming if every time we take two
\emph{push-forward} elements $(E_1, P_{E_1}, \Sigma_1)$
and $(E_2, P_{E_2}, \Sigma_2)$ according
to~(\ref{sub:transformations}) sharing a common face,
and denote $\pi_1$, $\pi_2$
the interpolation operators determined by the degrees
of freedom $\Sigma_1$ and $\Sigma_2$, the field defined as
\begin{IEEEeqnarray*}{rCl}
  \bw & = &
    \begin{cases}
      \pi_1(\bu|_{E_1}), &\text{ on }E_1\\
      \pi_2(\bu|_{E_2}), &\text{ on }E_2      
    \end{cases}
\end{IEEEeqnarray*}
results in $\mathbb{W}(E_1\cup E_2)$.
\end{defi}
%==========================================================================
%\begin{defi} We say that the unisolvent Finite Element $(E, P_E, \Sigma)$ is
%$H(\bcurl)$--conforming if every time we take two
%\emph{push-forward} elements $(E_1, P_{E_1}, \Sigma_1)$
%and $(E_2, P_{E_2}, \Sigma_2)$ according
%to~(\ref{sub:transformations}), and denote $\pi_1$, $\pi_2$
%the interpolation operators determined by the degrees
%of freedom $\Sigma_1$ and $\Sigma_2$, the field defined as
%\begin{IEEEeqnarray*}{rCl}
% \bw & = &
%   \begin{cases}
%     \pi_1(\bu|_{\Omega_1}), &\text{ on }\Omega_1\\
%     \pi_2(\bu|_{\Omega_2}), &\text{ on }\Omega_2      
%   \end{cases}
%\end{IEEEeqnarray*}
%results in $H(\bcurl,\Omega_1\cup\Omega_2)$.
%\end{defi}
% section preliminares (end)
%==========================================================================
  
\section{Regularity of the solution for a model Elliptic Problem}

\macroRegularity
%\macroPrismRegularity
\noindent We are concerned in solving 
the following problem.
\begin{problem}\label{mixedContinuous}
Suppose we have a simply connected Lipschitz polyhedron
$\Omega\subseteq\mathbb{R}^3$ which is not convex. Given $f\in L^2(\Omega)$
we look for a $\bu\in H(\dv,\Omega)$ such that 
\begin{IEEEeqnarray*}{rCl}
  \boldsymbol{u}              & = & \nabla p \\
  -\text{div\,}\boldsymbol{u} & = & f \\
   p|_{\partial\Omega}
  & = & 0.
\end{IEEEeqnarray*}
\mbox{la cond de borde VA?\quad COMO LO PONGO? \quad (ver apunte de FEM2012 talvez)}
\end{problem}
\begin{problem}[Weak formulation.]\label{weakMixedContinuous}
Suppose we have a simply connected Lipschitz polyhedron
$\Omega\subseteq\mathbb{R}^3$ which is not convex. Given $f\in L^2(\Omega)$,
find       $(\bu, p)  \in  H(\dv, \Omega) \times L^2(\Omega)$ 
    such that for all   $(\bv, q)  \in  H(\dv, \Omega) \times L^2(\Omega)$
  \begin{IEEEeqnarray*}{rCl}
    \int_{\Omega} \bu\cdot\bv\,d\bx + 
    \int_{\Omega} p\,\dv\bv\,d\bx                     & = & 0\\
     -\int_{\Omega} q\dv\bu\,d\bx     & = & 
    \int_{\Omega} f\,q\,d\bx.    
  \end{IEEEeqnarray*}
\end{problem}
Due to the polyhedron not being convex there will be ingoing
vertices and edges whose interior angles are obtuse. In the following
we are going to recall how to formalize the singularities in a polyhedron
and how to classify the regularity of the solution of problem~(\ref{mixedContinuous})\\[5pt]
\label{sec:regularity}
\begin{defi}
  If $\Omega$ is a non--convex polihedron $\lambda_e$ is ... and $\lambda_v$ is --- 
  $\delta > 1-\lambda_{\be}^{(\ell)} = 1-\pi/\omega_{\be}$
\end{defi}
\noindent Assuming a decomposition of $\Omega=\cup_{\ell=1}^N \Lambda_\ell$ in tetrahedral macroelements having at most a singular edge and a singular vertex, we have the following regularity result.
First we introduce the space $V^{1,2}_{\beta,\delta}(\Lambda)$ for a macroelement $\Lambda$ as
\[
V^{1,2}_{\beta,\delta} = \left\{v\in \mathcal D'(\Lambda): R^{\beta-1+|\alpha|}\theta^{\delta-1+|\alpha|}D^\alpha v\in L^2(\Lambda), \alpha\in \mathbb N^3, |\alpha|\le1\right\}
\]
where $R({\bf x})$ is the distance of ${\bf x}$ to the vertices of $\Lambda$, $r({\bf x})$ is the distance from ${\bf x}$ to the edges of $\Lambda$ and finally $\theta({\bf x})$ is the angular distance $\theta({\bf x})=\frac{r({\bf x})}{R({\bf x})}$.
\[
\|v\|^{1,2}_{\beta,\delta} := \left\{\sum_{|\alpha|\leqslant 1}
\|R^{\beta-1+|\alpha|}\theta^{\delta-1+|\alpha|}D^\alpha v\|_{L^2(\Lambda)}^2\right\}^{1/2}
\]
\[
V^{1,2}_{\beta,\delta} = \left\{v\in \mathcal D'(\Lambda): \|v\|^{1,2}_{\beta,\delta} < \infty\right\}.
\]
If $\beta = \delta$ we will write $V_{\delta,\delta,1,2}(\Lambda_\ell)  = V_{\delta,1,2}(\Lambda)$
and, consistently, 
\[
\|v\|_{\delta,1,2} := \left\{\sum_{|\alpha|\leqslant 1}
\|r^{\delta-1+|\alpha|}\partial^\alpha v\|_{L^2(\Lambda)}^2\right\}^{1/2}.
\]
\begin{theorem}\label{thm_regularity}
The solutions $\bu$ and $p$ of problem \eqref{mixedContinuous} satisfy
\[
p\in H^1(\Omega)
\] 
and for each $\ell$
\[
\bu=\bu_r + \bu_s
\]
with $\bu_r\in H^1(\Omega)$ and
\[
\bu_s\cdot \xi_i\in V^{1,2}_{\beta,\delta}(\Lambda_\ell), \quad i=1,2, \qquad
\bu_s\cdot\xi_3\in V^{1,2}_{\beta,0}(\Lambda_\ell)
\]
where $\xi_i$, $i=1,2,3$, are the directions of three concurrent
edges of $\Lambda_\ell$ with $\xi_3$ being the direction of the
singular edge if it exists in $\Omega_\ell$, and $\beta,\delta\ge0$
satisfying $\beta>\frac12-\lambda_{\bv}^{(\ell)}$ and
$\delta>1-\lambda_{\be}^{(\ell)}$, $v$ and $e$ being the singular
vertex and edge, respectively, if they exist.
\end{theorem}
\begin{IEEEeqnarray*}{rCl}
  \| \bu_r \|_{H^1(\Omega)} & \leqslant & c\,\|f\|_{H^1(\Omega)}\\[5pt]
  \| \bu_s\cdot\xi_i \|_{V_{\beta,\delta}^{1,2}(\Lambda_\ell)} & \leqslant & c\,\| f \|_{L^2(\Lambda_\ell)}\\[5pt]
  \| \bu_s\cdot\xi_3 \|_{V_{\beta,0}^{1,2}(\Lambda_\ell)}      & \leqslant & c\,\| f \|_{L^2(\Lambda_\ell)}
\end{IEEEeqnarray*}
  provided
\begin{IEEEeqnarray*}{rCl}
  {\color{violet} \delta} & > & 1 - \frac{\pi}{\omega_{\textbf{e}}}\text{,}\\
  {\color{violet} \beta} & > & \frac{1}{2} - \lambda_{\textbf{v}}.
\end{IEEEeqnarray*}
\begin{remark}\label{sobreBetaYDelta}
\textcolor{red}{Note that it is always possible in the previous Theorem to take $0<\beta=\delta<1$.} 
\end{remark}

\section{Polynomial Approximation} % (fold)
\label{sec:polynomial_approximation}

\begin{defi}
  Given $f\in\mathcal{C}^{k}(\Omega)$ the $k$--th degree
  Taylor polynomial of $f$ centered at $y\in\Omega$, $T_y^kf$, is defined by
  \begin{IEEEeqnarray}{rCl}\label{taylor}
      (T_y^kf)(x)&=&\sum_{|\alpha|\leqslant k} \frac{f^{(\alpha)}(y)}{\alpha!}(x-y)^{\alpha}.
  \end{IEEEeqnarray}
\end{defi}

\begin{defi} $\Omega$ is star--shaped with respect to $B$ if, for all
$x\in\Omega$, the closed convex hull of $\{x\}\cup\Omega$ is 
a subset of $\Omega$.
\end{defi}

\begin{defi}
Assume that $\Omega$ is star--shaped with respect to a set $B\subseteq\Omega$
of positive measure. Given an integer $k\geqslant 0$ and 
$f\in W^{k+1,p}(\Omega)$ we introduce the averaged Taylor polynomial
of $f$, $\Qb_{k,B}f\in P_k$ defined by
\begin{IEEEeqnarray}{rCl}\label{averagedTaylor}
  (\Qb_{k,B}f)(x) & = & \frac{1}{|B|} \int_B (T_y^kf)(x)\,dy 
\end{IEEEeqnarray}
with $T_y^k$ as in~(\ref{taylor}) but with distributional
derivatives.

Given a field $\bu = (u_1, u_2, u_3)' \in W^{m+1,p} (\Omega)^3$,
the vectorial averaged Taylor polynomial of $\bu$ is defined
componentwise as
\begin{IEEEeqnarray*}{rCl}
  \boldsymbol{\Qb}_{k,B}\,\bu  & = &  
  (\Qb_{k,B}\,u_1 , \Qb_{k,B}\,u_2 , \Qb_{k,B}\,u_3 ).
\end{IEEEeqnarray*}
\end{defi}
\begin{lemma}\label{avg_taylor_commutes}
Let $\beta$ be a multi--index such that  $|\beta| \leqslant k$,
then 
\begin{IEEEeqnarray}{rCl}
  \partial^\beta \Qb_{k,B} f & = & \Qb_{k-|\beta|,B} \partial^\beta f.
\end{IEEEeqnarray}
\end{lemma}
\begin{lemma}
  Let $\Omega\subseteq\mathbb{R}^n$ be an open connected set
  with diameter $d$ which is star--shaped with respect to a 
  set $B\subseteq\Omega$ of positive measure. Given an integer
  $k\geqslant 0$ and $f\in W^{k+1,p}(\Omega)$ there exists a 
  positive $C=C(k,n)$ such that, for $|\beta|\geqslant k+1$,
  \begin{IEEEeqnarray*}{rCl}
      \|\partial^{\beta}(f-\Qb_{k,B}f)\|_{L^p(\Omega)}
        &\leqslant&C\frac{|\Omega|^{\nicefrac1p}}{|B|^{\nicefrac1p}}
          d^{k-|\beta|+1}|f|_{k+1,\Omega}.
  \end{IEEEeqnarray*}
  In particular, if $\Omega$ is convex,
  \begin{IEEEeqnarray*}{rCl}
    \|\partial^{\beta}(f-\Qb_{k,\Omega}f)\|_{L^p(\Omega)}
        &\leqslant&Cd^{k-|\beta|+1}|f|_{k+1,\Omega}.
  \end{IEEEeqnarray*}
\end{lemma} 
\begin{proof} In view of Lemma~\ref{avg_taylor_commutes} we may only prove
the estimate for the case $|\beta| = 0$ and, for $|\beta|>0$, apply it to
$\partial^{\beta}f-\Qb_{k-|\beta|,B}\partial^{\beta}f$.

Consider $|\beta| = 0$ and take $q$ as the H\"older conjugate of $p\geqslant 1$.
By density we may assume $f\in \mathcal{C}^\infty(\Omega)$.
Firt use Taylor's Theorem
\begin{IEEEeqnarray*}{rCl}
  f(\bx)-(T_{\by}^kf)(\bx) & = & {k+1}
    \sum_{|\alpha|=k+1} \frac{(\bx-\by)^\alpha}{\alpha!}
    \int_0^1 \partial^\alpha f(t\by+(1-t)\bx)\,t^k\,dt
\end{IEEEeqnarray*}
which implies
\begin{IEEEeqnarray*}{rCl}
  f(\bx)-\Qb_{k,B}f(\bx) & = & \frac{k+1}{B}
    \sum_{|\alpha|=k+1} \int_B\int_0^1 \frac{(\bx-\by)^\alpha}{\alpha!}
      \partial^\alpha f(t\by+(1-t)\bx)\,t^k\,dtd\by.
\end{IEEEeqnarray*}
By H\"older's inequality twice (once in a finite dimensional version) we have
\begin{IEEEeqnarray*}{rCl}
  \int_{\Omega}|f(\bx)-\Qb_{k,B}f(\bx)|^p\,d\bx&\leqslant& C\frac{d^{p(k+1)}}{|B|^p}
    \sum_{|\alpha|=k+1}\int_{\Omega}
      (\int_B\int_0^1|\partial^\alpha f(t\by+(1-t)\bx)|^p\,dtd\by)
      (\frac{|B|}{qk+1})^{\nicefrac{p}{q}}
    \\[5pt]
&=& \frac{C}{(qk+1)^{\nicefrac{p}{q}}}\frac{d^{p(k+1)}}{|B|}
    \sum_{|\alpha|=k+1} \int_{\Omega}\int_B\int_0^1
      |\partial^\alpha f(t\by+(1-t)\bx)|^p\,dtd\by d\bx.
\end{IEEEeqnarray*}
For any multi--index $\alpha$ we split
\begin{IEEEeqnarray}{rCl}
\label{first_auxiliary}
  \int_{\Omega}\int_B\int_0^1
      |\partial^\alpha f(t\by+(1-t)\bx)|^p\,dtd\by d\bx
   & = & 
 \int_{\Omega}\int_B\int_0^{\nicefrac12}
      |\partial^\alpha f(t\by+(1-t)\bx)|^p\,dtd\by d\bx\\
\label{second_auxiliary}
   &  &\, +  
\int_{\Omega}\int_B\int_{\nicefrac12}^1
      |\partial^\alpha f(t\by+(1-t)\bx)|^p\,dtd\by d\bx.
\end{IEEEeqnarray}
Let $\phi_\alpha$ be the extension by zero of $\partial^\alpha f$ to $\mathbb{R}^n$.
By Fubini's Theorem and change of variables,
\begin{IEEEeqnarray*}{rCl}
  (\ref{first_auxiliary}) &\leqslant& \int_{B}\int_0^{\nicefrac12}\int_{\mathbb{R}^n}
      |\phi_\alpha(\bz)|^p(1-t)^{-n}\,d\bz dt d\by\\
      &\leqslant& 2^{n-1} |B|\|\partial^\alpha f\|^p_{p,\Omega}.
\end{IEEEeqnarray*}
\begin{IEEEeqnarray*}{rCl}
  (\ref{second_auxiliary}) &\leqslant& \int_{\Omega}\int_{\nicefrac12}^1\int_{\mathbb{R}^n}
      |\phi_\alpha(t\by)|^p\,d\by dt d\bx\\
  &=& \int_{\Omega}\int_{\nicefrac12}^1\int_{\mathbb{R}^n}
      |\phi_\alpha(\bz)|^pt^{-n}\,d\bz dt d\bx\\
      &\leqslant& 2^{n-1} |\Omega|\|\partial^\alpha f\|^p_{p,\Omega}.
\end{IEEEeqnarray*}
Summing theese up for any $\alpha$ of order $k+1$ we obtain
\begin{IEEEeqnarray*}{rCl}
  \|f-\Qb_{k,B}f\|_p^p & \leqslant & 
  \frac{C}{(qk+1)^{\nicefrac{p}{q}}}d^{p(k+1)}\frac{|\Omega|}{|B|} |f|^p_{p,k+1,\Omega}.
\end{IEEEeqnarray*}
\end{proof}
{\color{red}\#\#\#\#\#\#\#\# agregar lo de pags 25-26 de articulo ariel.}
% section polynomial_approximation (end)
